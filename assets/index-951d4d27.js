import{r as C0,a as Et,R as Bt}from"./vendor-b1791c80.js";import{L as Tt,T as X1,O as _a,s as C1,P as Nt,S as It,F as Ct,R as Lt,a as kt,b as Vt,c as Ot,E as Ft,C as jt,G as Ht,d as Xt,e as Dt,f as v1}from"./tone-42407d74.js";(function(){const O=document.createElement("link").relList;if(O&&O.supports&&O.supports("modulepreload"))return;for(const a0 of document.querySelectorAll('link[rel="modulepreload"]'))P(a0);new MutationObserver(a0=>{for(const Z of a0)if(Z.type==="childList")for(const Q of Z.addedNodes)Q.tagName==="LINK"&&Q.rel==="modulepreload"&&P(Q)}).observe(document,{childList:!0,subtree:!0});function G(a0){const Z={};return a0.integrity&&(Z.integrity=a0.integrity),a0.referrerPolicy&&(Z.referrerPolicy=a0.referrerPolicy),a0.crossOrigin==="use-credentials"?Z.credentials="include":a0.crossOrigin==="anonymous"?Z.credentials="omit":Z.credentials="same-origin",Z}function P(a0){if(a0.ep)return;a0.ep=!0;const Z=G(a0);fetch(a0.href,Z)}})();var nt={exports:{}},Q1={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gt=C0,qt=Symbol.for("react.element"),$t=Symbol.for("react.fragment"),Yt=Object.prototype.hasOwnProperty,Pt=Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ut={key:!0,ref:!0,__self:!0,__source:!0};function it(y,O,G){var P,a0={},Z=null,Q=null;G!==void 0&&(Z=""+G),O.key!==void 0&&(Z=""+O.key),O.ref!==void 0&&(Q=O.ref);for(P in O)Yt.call(O,P)&&!Ut.hasOwnProperty(P)&&(a0[P]=O[P]);if(y&&y.defaultProps)for(P in O=y.defaultProps,O)a0[P]===void 0&&(a0[P]=O[P]);return{$$typeof:qt,type:y,key:Z,ref:Q,props:a0,_owner:Pt.current}}Q1.Fragment=$t;Q1.jsx=it;Q1.jsxs=it;nt.exports=Q1;var I=nt.exports,Ma={},Va=Et;Ma.createRoot=Va.createRoot,Ma.hydrateRoot=Va.hydrateRoot;var Ra={};function Kt(y){return new Int8Array(y)}function lt(y){return new Int16Array(y)}function _t(y){return new Int32Array(y)}function ot(y){return new Float32Array(y)}function Zt(y){return new Float64Array(y)}function vt(y){if(y.length==1)return ot(y[0]);var O=y[0];y=y.slice(1);for(var G=[],P=0;P<O;P++)G.push(vt(y));return G}function ct(y){if(y.length==1)return _t(y[0]);var O=y[0];y=y.slice(1);for(var G=[],P=0;P<O;P++)G.push(ct(y));return G}function ut(y){if(y.length==1)return lt(y[0]);var O=y[0];y=y.slice(1);for(var G=[],P=0;P<O;P++)G.push(ut(y));return G}function ht(y){if(y.length==1)return new Array(y[0]);var O=y[0];y=y.slice(1);for(var G=[],P=0;P<O;P++)G.push(ht(y));return G}var dt={};dt.fill=function(y,O,G,P){if(arguments.length==2)for(var a0=0;a0<y.length;a0++)y[a0]=arguments[1];else for(var a0=O;a0<G;a0++)y[a0]=P};var F1={};F1.arraycopy=function(y,O,G,P,a0){for(var Z=O+a0;O<Z;)G[P++]=y[O++]};F1.out={};F1.out.println=function(y){console.log(y)};F1.out.printf=function(){console.log.apply(console,arguments)};var W1={};W1.SQRT2=1.4142135623730951;W1.FAST_LOG10=function(y){return Math.log10(y)};W1.FAST_LOG10_X=function(y,O){return Math.log10(y)*O};function i1(y){this.ordinal=y}i1.short_block_allowed=new i1(0);i1.short_block_coupled=new i1(1);i1.short_block_dispensed=new i1(2);i1.short_block_forced=new i1(3);var mt={};mt.MAX_VALUE=34028235e31;function Xe(y){this.ordinal=y}Xe.vbr_off=new Xe(0);Xe.vbr_mt=new Xe(1);Xe.vbr_rh=new Xe(2);Xe.vbr_abr=new Xe(3);Xe.vbr_mtrh=new Xe(4);Xe.vbr_default=Xe.vbr_mtrh;var Qt=function(y){},P0={System:F1,VbrMode:Xe,Float:mt,ShortBlock:i1,Util:W1,Arrays:dt,new_array_n:ht,new_byte:Kt,new_double:Zt,new_float:ot,new_float_n:vt,new_int:_t,new_int_n:ct,new_short:lt,new_short_n:ut,assert:Qt},oa,Oa;function Wt(){if(Oa)return oa;Oa=1;var y=P0,O=y.System;y.VbrMode,y.Float,y.ShortBlock;var G=y.Util,P=y.Arrays;y.new_array_n,y.new_byte,y.new_double;var a0=y.new_float;y.new_float_n,y.new_int,y.new_int_n,y.assert;var Z=ie();function Q(){var U=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*G.SQRT2*.5/2384e-9,.017876148*G.SQRT2*.5/2384e-9,.003134727*G.SQRT2*.5/2384e-9,.002457142*G.SQRT2*.5/2384e-9,971317e-9*G.SQRT2*.5/2384e-9,218868e-9*G.SQRT2*.5/2384e-9,101566e-9*G.SQRT2*.5/2384e-9,13828e-9*G.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],K=12,R=36,j=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],S=j[Z.SHORT_TYPE],H=j[Z.SHORT_TYPE],X=j[Z.SHORT_TYPE],Y=j[Z.SHORT_TYPE],D=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function q(h,b,e){for(var d=10,u=b+238-14-286,x=-15;x<0;x++){var v,r,s;v=U[d+-10],r=h[u+-224]*v,s=h[b+224]*v,v=U[d+-9],r+=h[u+-160]*v,s+=h[b+160]*v,v=U[d+-8],r+=h[u+-96]*v,s+=h[b+96]*v,v=U[d+-7],r+=h[u+-32]*v,s+=h[b+32]*v,v=U[d+-6],r+=h[u+32]*v,s+=h[b+-32]*v,v=U[d+-5],r+=h[u+96]*v,s+=h[b+-96]*v,v=U[d+-4],r+=h[u+160]*v,s+=h[b+-160]*v,v=U[d+-3],r+=h[u+224]*v,s+=h[b+-224]*v,v=U[d+-2],r+=h[b+-256]*v,s-=h[u+256]*v,v=U[d+-1],r+=h[b+-192]*v,s-=h[u+192]*v,v=U[d+0],r+=h[b+-128]*v,s-=h[u+128]*v,v=U[d+1],r+=h[b+-64]*v,s-=h[u+64]*v,v=U[d+2],r+=h[b+0]*v,s-=h[u+0]*v,v=U[d+3],r+=h[b+64]*v,s-=h[u+-64]*v,v=U[d+4],r+=h[b+128]*v,s-=h[u+-128]*v,v=U[d+5],r+=h[b+192]*v,s-=h[u+-192]*v,r*=U[d+6],v=s-r,e[30+x*2]=s+r,e[31+x*2]=U[d+7]*v,d+=18,b--,u++}{var r,s,o,n;s=h[b+-16]*U[d+-10],r=h[b+-32]*U[d+-2],s+=(h[b+-48]-h[b+16])*U[d+-9],r+=h[b+-96]*U[d+-1],s+=(h[b+-80]+h[b+48])*U[d+-8],r+=h[b+-160]*U[d+0],s+=(h[b+-112]-h[b+80])*U[d+-7],r+=h[b+-224]*U[d+1],s+=(h[b+-144]+h[b+112])*U[d+-6],r-=h[b+32]*U[d+2],s+=(h[b+-176]-h[b+144])*U[d+-5],r-=h[b+96]*U[d+3],s+=(h[b+-208]+h[b+176])*U[d+-4],r-=h[b+160]*U[d+4],s+=(h[b+-240]-h[b+208])*U[d+-3],r-=h[b+224],o=r-s,n=r+s,s=e[14],r=e[15]-s,e[31]=n+s,e[30]=o+r,e[15]=o-r,e[14]=n-s}{var a;a=e[28]-e[0],e[0]+=e[28],e[28]=a*U[d+-2*18+7],a=e[29]-e[1],e[1]+=e[29],e[29]=a*U[d+-2*18+7],a=e[26]-e[2],e[2]+=e[26],e[26]=a*U[d+-4*18+7],a=e[27]-e[3],e[3]+=e[27],e[27]=a*U[d+-4*18+7],a=e[24]-e[4],e[4]+=e[24],e[24]=a*U[d+-6*18+7],a=e[25]-e[5],e[5]+=e[25],e[25]=a*U[d+-6*18+7],a=e[22]-e[6],e[6]+=e[22],e[22]=a*G.SQRT2,a=e[23]-e[7],e[7]+=e[23],e[23]=a*G.SQRT2-e[7],e[7]-=e[6],e[22]-=e[7],e[23]-=e[22],a=e[6],e[6]=e[31]-a,e[31]=e[31]+a,a=e[7],e[7]=e[30]-a,e[30]=e[30]+a,a=e[22],e[22]=e[15]-a,e[15]=e[15]+a,a=e[23],e[23]=e[14]-a,e[14]=e[14]+a,a=e[20]-e[8],e[8]+=e[20],e[20]=a*U[d+-10*18+7],a=e[21]-e[9],e[9]+=e[21],e[21]=a*U[d+-10*18+7],a=e[18]-e[10],e[10]+=e[18],e[18]=a*U[d+-12*18+7],a=e[19]-e[11],e[11]+=e[19],e[19]=a*U[d+-12*18+7],a=e[16]-e[12],e[12]+=e[16],e[16]=a*U[d+-14*18+7],a=e[17]-e[13],e[13]+=e[17],e[17]=a*U[d+-14*18+7],a=-e[20]+e[24],e[20]+=e[24],e[24]=a*U[d+-12*18+7],a=-e[21]+e[25],e[21]+=e[25],e[25]=a*U[d+-12*18+7],a=e[4]-e[8],e[4]+=e[8],e[8]=a*U[d+-12*18+7],a=e[5]-e[9],e[5]+=e[9],e[9]=a*U[d+-12*18+7],a=e[0]-e[12],e[0]+=e[12],e[12]=a*U[d+-4*18+7],a=e[1]-e[13],e[1]+=e[13],e[13]=a*U[d+-4*18+7],a=e[16]-e[28],e[16]+=e[28],e[28]=a*U[d+-4*18+7],a=-e[17]+e[29],e[17]+=e[29],e[29]=a*U[d+-4*18+7],a=G.SQRT2*(e[2]-e[10]),e[2]+=e[10],e[10]=a,a=G.SQRT2*(e[3]-e[11]),e[3]+=e[11],e[11]=a,a=G.SQRT2*(-e[18]+e[26]),e[18]+=e[26],e[26]=a-e[18],a=G.SQRT2*(-e[19]+e[27]),e[19]+=e[27],e[27]=a-e[19],a=e[2],e[19]-=e[3],e[3]-=a,e[2]=e[31]-a,e[31]+=a,a=e[3],e[11]-=e[19],e[18]-=a,e[3]=e[30]-a,e[30]+=a,a=e[18],e[27]-=e[11],e[19]-=a,e[18]=e[15]-a,e[15]+=a,a=e[19],e[10]-=a,e[19]=e[14]-a,e[14]+=a,a=e[10],e[11]-=a,e[10]=e[23]-a,e[23]+=a,a=e[11],e[26]-=a,e[11]=e[22]-a,e[22]+=a,a=e[26],e[27]-=a,e[26]=e[7]-a,e[7]+=a,a=e[27],e[27]=e[6]-a,e[6]+=a,a=G.SQRT2*(e[0]-e[4]),e[0]+=e[4],e[4]=a,a=G.SQRT2*(e[1]-e[5]),e[1]+=e[5],e[5]=a,a=G.SQRT2*(e[16]-e[20]),e[16]+=e[20],e[20]=a,a=G.SQRT2*(e[17]-e[21]),e[17]+=e[21],e[21]=a,a=-G.SQRT2*(e[8]-e[12]),e[8]+=e[12],e[12]=a-e[8],a=-G.SQRT2*(e[9]-e[13]),e[9]+=e[13],e[13]=a-e[9],a=-G.SQRT2*(e[25]-e[29]),e[25]+=e[29],e[29]=a-e[25],a=-G.SQRT2*(e[24]+e[28]),e[24]-=e[28],e[28]=a-e[24],a=e[24]-e[16],e[24]=a,a=e[20]-a,e[20]=a,a=e[28]-a,e[28]=a,a=e[25]-e[17],e[25]=a,a=e[21]-a,e[21]=a,a=e[29]-a,e[29]=a,a=e[17]-e[1],e[17]=a,a=e[9]-a,e[9]=a,a=e[25]-a,e[25]=a,a=e[5]-a,e[5]=a,a=e[21]-a,e[21]=a,a=e[13]-a,e[13]=a,a=e[29]-a,e[29]=a,a=e[1]-e[0],e[1]=a,a=e[16]-a,e[16]=a,a=e[17]-a,e[17]=a,a=e[8]-a,e[8]=a,a=e[9]-a,e[9]=a,a=e[24]-a,e[24]=a,a=e[25]-a,e[25]=a,a=e[4]-a,e[4]=a,a=e[5]-a,e[5]=a,a=e[20]-a,e[20]=a,a=e[21]-a,e[21]=a,a=e[12]-a,e[12]=a,a=e[13]-a,e[13]=a,a=e[28]-a,e[28]=a,a=e[29]-a,e[29]=a,a=e[0],e[0]+=e[31],e[31]-=a,a=e[1],e[1]+=e[30],e[30]-=a,a=e[16],e[16]+=e[15],e[15]-=a,a=e[17],e[17]+=e[14],e[14]-=a,a=e[8],e[8]+=e[23],e[23]-=a,a=e[9],e[9]+=e[22],e[22]-=a,a=e[24],e[24]+=e[7],e[7]-=a,a=e[25],e[25]+=e[6],e[6]-=a,a=e[4],e[4]+=e[27],e[27]-=a,a=e[5],e[5]+=e[26],e[26]-=a,a=e[20],e[20]+=e[11],e[11]-=a,a=e[21],e[21]+=e[10],e[10]-=a,a=e[12],e[12]+=e[19],e[19]-=a,a=e[13],e[13]+=e[18],e[18]-=a,a=e[28],e[28]+=e[3],e[3]-=a,a=e[29],e[29]+=e[2],e[2]-=a}}function T(h,b){for(var e=0;e<3;e++){var d,u,x,v,r,s;v=h[b+2*3]*j[Z.SHORT_TYPE][0]-h[b+5*3],d=h[b+0*3]*j[Z.SHORT_TYPE][2]-h[b+3*3],u=v+d,x=v-d,v=h[b+5*3]*j[Z.SHORT_TYPE][0]+h[b+2*3],d=h[b+3*3]*j[Z.SHORT_TYPE][2]+h[b+0*3],r=v+d,s=-v+d,d=(h[b+1*3]*j[Z.SHORT_TYPE][1]-h[b+4*3])*2069978111953089e-26,v=(h[b+4*3]*j[Z.SHORT_TYPE][1]+h[b+1*3])*2069978111953089e-26,h[b+3*0]=u*190752519173728e-25+d,h[b+3*5]=-r*190752519173728e-25+v,x=x*.8660254037844387*1907525191737281e-26,r=r*.5*1907525191737281e-26+v,h[b+3*1]=x-r,h[b+3*2]=x+r,u=u*.5*1907525191737281e-26-d,s=s*.8660254037844387*1907525191737281e-26,h[b+3*3]=u+s,h[b+3*4]=u-s,b++}}function _(h,b,e){var d,u;{var x,v,r,s,o,n,a,c;x=e[17]-e[9],r=e[15]-e[11],s=e[14]-e[12],o=e[0]+e[8],n=e[1]+e[7],a=e[2]+e[6],c=e[3]+e[5],h[b+17]=o+a-c-(n-e[4]),u=(o+a-c)*H[12+7]+(n-e[4]),d=(x-r-s)*H[12+6],h[b+5]=d+u,h[b+6]=d-u,v=(e[16]-e[10])*H[12+6],n=n*H[12+7]+e[4],d=x*H[12+0]+v+r*H[12+1]+s*H[12+2],u=-o*H[12+4]+n-a*H[12+5]+c*H[12+3],h[b+1]=d+u,h[b+2]=d-u,d=x*H[12+1]-v-r*H[12+2]+s*H[12+0],u=-o*H[12+5]+n-a*H[12+3]+c*H[12+4],h[b+9]=d+u,h[b+10]=d-u,d=x*H[12+2]-v+r*H[12+0]-s*H[12+1],u=o*H[12+3]-n+a*H[12+4]-c*H[12+5],h[b+13]=d+u,h[b+14]=d-u}{var i,C,M,E,t,l,B,N;i=e[8]-e[0],M=e[6]-e[2],E=e[5]-e[3],t=e[17]+e[9],l=e[16]+e[10],B=e[15]+e[11],N=e[14]+e[12],h[b+0]=t+B+N+(l+e[13]),d=(t+B+N)*H[12+7]-(l+e[13]),u=(i-M+E)*H[12+6],h[b+11]=d+u,h[b+12]=d-u,C=(e[7]-e[1])*H[12+6],l=e[13]-l*H[12+7],d=t*H[12+3]-l+B*H[12+4]+N*H[12+5],u=i*H[12+2]+C+M*H[12+0]+E*H[12+1],h[b+3]=d+u,h[b+4]=d-u,d=-t*H[12+5]+l-B*H[12+3]-N*H[12+4],u=i*H[12+1]+C-M*H[12+2]-E*H[12+0],h[b+7]=d+u,h[b+8]=d-u,d=-t*H[12+4]+l-B*H[12+5]-N*H[12+3],u=i*H[12+0]-C+M*H[12+1]-E*H[12+2],h[b+15]=d+u,h[b+16]=d-u}}this.mdct_sub48=function(h,b,e){for(var d=b,u=286,x=0;x<h.channels_out;x++){for(var v=0;v<h.mode_gr;v++){for(var r,s=h.l3_side.tt[v][x],o=s.xr,n=0,a=h.sb_sample[x][1-v],c=0,i=0;i<18/2;i++)for(q(d,u,a[c]),q(d,u+32,a[c+1]),c+=2,u+=64,r=1;r<32;r+=2)a[c-1][r]*=-1;for(r=0;r<32;r++,n+=18){var C=s.block_type,M=h.sb_sample[x][v],E=h.sb_sample[x][1-v];if(s.mixed_block_flag!=0&&r<2&&(C=0),h.amp_filter[r]<1e-12)P.fill(o,n+0,n+18,0);else{if(h.amp_filter[r]<1)for(var i=0;i<18;i++)E[i][D[r]]*=h.amp_filter[r];if(C==Z.SHORT_TYPE){for(var i=-K/4;i<0;i++){var t=j[Z.SHORT_TYPE][i+3];o[n+i*3+9]=M[9+i][D[r]]*t-M[8-i][D[r]],o[n+i*3+18]=M[14-i][D[r]]*t+M[15+i][D[r]],o[n+i*3+10]=M[15+i][D[r]]*t-M[14-i][D[r]],o[n+i*3+19]=E[2-i][D[r]]*t+E[3+i][D[r]],o[n+i*3+11]=E[3+i][D[r]]*t-E[2-i][D[r]],o[n+i*3+20]=E[8-i][D[r]]*t+E[9+i][D[r]]}T(o,n)}else{for(var l=a0(18),i=-R/4;i<0;i++){var B,N;B=j[C][i+27]*E[i+9][D[r]]+j[C][i+36]*E[8-i][D[r]],N=j[C][i+9]*M[i+9][D[r]]-j[C][i+18]*M[8-i][D[r]],l[i+9]=B-N*S[3+i+9],l[i+18]=B*S[3+i+9]+N}_(o,n,l)}}if(C!=Z.SHORT_TYPE&&r!=0)for(var i=7;i>=0;--i){var l0,c0;l0=o[n+i]*X[20+i]+o[n+-1-i]*Y[28+i],c0=o[n+i]*Y[28+i]-o[n+-1-i]*X[20+i],o[n+-1-i]=l0,o[n+i]=c0}}}if(d=e,u=286,h.mode_gr==1)for(var o0=0;o0<18;o0++)O.arraycopy(h.sb_sample[x][1][o0],0,h.sb_sample[x][0][o0],0,32)}}}return oa=Q,oa}var va,Fa;function ft(){if(Fa)return va;Fa=1;var y=ie(),O=P0,G=O.System;O.VbrMode,O.Float,O.ShortBlock,O.Util,O.Arrays,O.new_array_n,O.new_byte,O.new_double;var P=O.new_float,a0=O.new_float_n;O.new_int,O.new_int_n,O.assert;function Z(){this.l=P(y.SBMAX_l),this.s=a0([y.SBMAX_s,3]);var Q=this;this.assign=function(U){G.arraycopy(U.l,0,Q.l,0,y.SBMAX_l);for(var K=0;K<y.SBMAX_s;K++)for(var R=0;R<3;R++)Q.s[K][R]=U.s[K][R]}}return va=Z,va}var ca,ja;function zt(){if(ja)return ca;ja=1;var y=ft();function O(){this.thm=new y,this.en=new y}return ca=O,ca}var ua,Ha;function ie(){if(Ha)return ua;Ha=1;var y=P0,O=y.System,G=y.VbrMode;y.Float,y.ShortBlock,y.Util,y.Arrays;var P=y.new_array_n;y.new_byte,y.new_double;var a0=y.new_float,Z=y.new_float_n,Q=y.new_int;y.new_int_n;var U=y.assert;K.ENCDELAY=576,K.POSTDELAY=1152,K.MDCTDELAY=48,K.FFTOFFSET=224+K.MDCTDELAY,K.DECDELAY=528,K.SBLIMIT=32,K.CBANDS=64,K.SBPSY_l=21,K.SBPSY_s=12,K.SBMAX_l=22,K.SBMAX_s=13,K.PSFB21=6,K.PSFB12=6,K.BLKSIZE=1024,K.HBLKSIZE=K.BLKSIZE/2+1,K.BLKSIZE_s=256,K.HBLKSIZE_s=K.BLKSIZE_s/2+1,K.NORM_TYPE=0,K.START_TYPE=1,K.SHORT_TYPE=2,K.STOP_TYPE=3,K.MPG_MD_LR_LR=0,K.MPG_MD_LR_I=1,K.MPG_MD_MS_LR=2,K.MPG_MD_MS_I=3,K.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function K(){var R=Wt(),j=zt(),S=K.FFTOFFSET,H=K.MPG_MD_MS_LR,X=null;this.psy=null;var Y=null,D=null,q=null;this.setModules=function(e,d,u,x){X=e,this.psy=d,Y=d,D=x,q=u};var T=new R;function _(e){var d,u;if(e.ATH.useAdjust==0){e.ATH.adjust=1;return}if(u=e.loudness_sq[0][0],d=e.loudness_sq[1][0],e.channels_out==2?(u+=e.loudness_sq[0][1],d+=e.loudness_sq[1][1]):(u+=u,d+=d),e.mode_gr==2&&(u=Math.max(u,d)),u*=.5,u*=e.ATH.aaSensitivityP,u>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var x=31.98*u+625e-6;e.ATH.adjust>=x?(e.ATH.adjust*=x*.075+.925,e.ATH.adjust<x&&(e.ATH.adjust=x)):e.ATH.adjustLimit>=x?e.ATH.adjust=x:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=x}}function h(e){var d,u;for(U(0<=e.bitrate_index&&e.bitrate_index<16),U(0<=e.mode_ext&&e.mode_ext<4),e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,e.channels_out==2&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),d=0;d<e.mode_gr;++d)for(u=0;u<e.channels_out;++u){var x=e.l3_side.tt[d][u].block_type|0;e.l3_side.tt[d][u].mixed_block_flag!=0&&(x=4),e.bitrate_blockType_Hist[e.bitrate_index][x]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][x]++,e.bitrate_blockType_Hist[15][5]++}}function b(e,d){var u=e.internal_flags,x,v;if(u.lame_encode_frame_init==0){var r,s,o=a0(2014),n=a0(286+1152+576);for(u.lame_encode_frame_init=1,r=0,s=0;r<286+576*(1+u.mode_gr);++r)r<576*u.mode_gr?(o[r]=0,u.channels_out==2&&(n[r]=0)):(o[r]=d[0][s],u.channels_out==2&&(n[r]=d[1][s]),++s);for(v=0;v<u.mode_gr;v++)for(x=0;x<u.channels_out;x++)u.l3_side.tt[v][x].block_type=K.SHORT_TYPE;T.mdct_sub48(u,o,n),U(576>=K.FFTOFFSET),U(u.mf_size>=K.BLKSIZE+e.framesize-K.FFTOFFSET),U(u.mf_size>=512+e.framesize-32)}}this.lame_encode_mp3_frame=function(e,d,u,x,v,r){var s,o=P([2,2]);o[0][0]=new j,o[0][1]=new j,o[1][0]=new j,o[1][1]=new j;var n=P([2,2]);n[0][0]=new j,n[0][1]=new j,n[1][0]=new j,n[1][1]=new j;var a,c=[null,null],i=e.internal_flags,C=Z([2,4]),M=[.5,.5],E=[[0,0],[0,0]],t=[[0,0],[0,0]],l,B,N;if(c[0]=d,c[1]=u,i.lame_encode_frame_init==0&&b(e,c),i.padding=0,(i.slot_lag-=i.frac_SpF)<0&&(i.slot_lag+=e.out_samplerate,i.padding=1),i.psymodel!=0){var l0,c0=[null,null],o0=0,v0=Q(2);for(N=0;N<i.mode_gr;N++){for(B=0;B<i.channels_out;B++)c0[B]=c[B],o0=576+N*576-K.FFTOFFSET;if(e.VBR==G.vbr_mtrh||e.VBR==G.vbr_mt?l0=Y.L3psycho_anal_vbr(e,c0,o0,N,o,n,E[N],t[N],C[N],v0):l0=Y.L3psycho_anal_ns(e,c0,o0,N,o,n,E[N],t[N],C[N],v0),l0!=0)return-4;for(e.mode==MPEGMode.JOINT_STEREO&&(M[N]=C[N][2]+C[N][3],M[N]>0&&(M[N]=C[N][3]/M[N])),B=0;B<i.channels_out;B++){var A0=i.l3_side.tt[N][B];A0.block_type=v0[B],A0.mixed_block_flag=0}}}else for(N=0;N<i.mode_gr;N++)for(B=0;B<i.channels_out;B++)i.l3_side.tt[N][B].block_type=K.NORM_TYPE,i.l3_side.tt[N][B].mixed_block_flag=0,t[N][B]=E[N][B]=700;if(_(i),T.mdct_sub48(i,c[0],c[1]),i.mode_ext=K.MPG_MD_LR_LR,e.force_ms)i.mode_ext=K.MPG_MD_MS_LR;else if(e.mode==MPEGMode.JOINT_STEREO){var d0=0,_0=0;for(N=0;N<i.mode_gr;N++)for(B=0;B<i.channels_out;B++)d0+=t[N][B],_0+=E[N][B];if(d0<=1*_0){var T0=i.l3_side.tt[0],F0=i.l3_side.tt[i.mode_gr-1];T0[0].block_type==T0[1].block_type&&F0[0].block_type==F0[1].block_type&&(i.mode_ext=K.MPG_MD_MS_LR)}}if(i.mode_ext==H?(a=n,l=t):(a=o,l=E),e.analysis&&i.pinfo!=null)for(N=0;N<i.mode_gr;N++)for(B=0;B<i.channels_out;B++)i.pinfo.ms_ratio[N]=i.ms_ratio[N],i.pinfo.ms_ener_ratio[N]=M[N],i.pinfo.blocktype[N][B]=i.l3_side.tt[N][B].block_type,i.pinfo.pe[N][B]=l[N][B],O.arraycopy(i.l3_side.tt[N][B].xr,0,i.pinfo.xr[N][B],0,576),i.mode_ext==H&&(i.pinfo.ers[N][B]=i.pinfo.ers[N][B+2],O.arraycopy(i.pinfo.energy[N][B+2],0,i.pinfo.energy[N][B],0,i.pinfo.energy[N][B].length));if(e.VBR==G.vbr_off||e.VBR==G.vbr_abr){var p0,I0;for(p0=0;p0<18;p0++)i.nsPsy.pefirbuf[p0]=i.nsPsy.pefirbuf[p0+1];for(I0=0,N=0;N<i.mode_gr;N++)for(B=0;B<i.channels_out;B++)I0+=l[N][B];for(i.nsPsy.pefirbuf[18]=I0,I0=i.nsPsy.pefirbuf[9],p0=0;p0<9;p0++)I0+=(i.nsPsy.pefirbuf[p0]+i.nsPsy.pefirbuf[18-p0])*K.fircoef[p0];for(I0=670*5*i.mode_gr*i.channels_out/I0,N=0;N<i.mode_gr;N++)for(B=0;B<i.channels_out;B++)l[N][B]*=I0}if(i.iteration_loop.iteration_loop(e,l,M,a),X.format_bitstream(e),s=X.copy_buffer(i,x,v,r,1),e.bWriteVbrTag&&D.addVbrFrame(e),e.analysis&&i.pinfo!=null){for(B=0;B<i.channels_out;B++){var N0;for(N0=0;N0<S;N0++)i.pinfo.pcmdata[B][N0]=i.pinfo.pcmdata[B][N0+e.framesize];for(N0=S;N0<1600;N0++)i.pinfo.pcmdata[B][N0]=c[B][N0-S]}q.set_frame_pinfo(e,a)}return h(i),s}}return ua=K,ua}var me=P0;me.System;me.VbrMode;me.Float;me.ShortBlock;var Xa=me.Util;me.Arrays;me.new_array_n;me.new_byte;me.new_double;var Da=me.new_float;me.new_float_n;me.new_int;me.new_int_n;me.assert;var J0=ie();function Jt(){var y=Da(J0.BLKSIZE),O=Da(J0.BLKSIZE_s/2),G=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function P(Z,Q,U){var K=0,R,j,S;U<<=1;var H=Q+U;R=4;do{var X,Y,D,q,T,_,h;h=R>>1,q=R,T=R<<1,_=T+q,R=T<<1,j=Q,S=j+h;do{var b,e,d,u;e=Z[j+0]-Z[j+q],b=Z[j+0]+Z[j+q],u=Z[j+T]-Z[j+_],d=Z[j+T]+Z[j+_],Z[j+T]=b-d,Z[j+0]=b+d,Z[j+_]=e-u,Z[j+q]=e+u,e=Z[S+0]-Z[S+q],b=Z[S+0]+Z[S+q],u=Xa.SQRT2*Z[S+_],d=Xa.SQRT2*Z[S+T],Z[S+T]=b-d,Z[S+0]=b+d,Z[S+_]=e-u,Z[S+q]=e+u,S+=R,j+=R}while(j<H);for(Y=G[K+0],X=G[K+1],D=1;D<h;D++){var x,v;x=1-2*X*X,v=2*X*Y,j=Q+D,S=Q+q-D;do{var r,s,o,b,e,n,d,a,u,c;s=v*Z[j+q]-x*Z[S+q],r=x*Z[j+q]+v*Z[S+q],e=Z[j+0]-r,b=Z[j+0]+r,n=Z[S+0]-s,o=Z[S+0]+s,s=v*Z[j+_]-x*Z[S+_],r=x*Z[j+_]+v*Z[S+_],u=Z[j+T]-r,d=Z[j+T]+r,c=Z[S+T]-s,a=Z[S+T]+s,s=X*d-Y*c,r=Y*d+X*c,Z[j+T]=b-r,Z[j+0]=b+r,Z[S+_]=n-s,Z[S+q]=n+s,s=Y*a-X*u,r=X*a+Y*u,Z[S+T]=o-r,Z[S+0]=o+r,Z[j+_]=e-s,Z[j+q]=e+s,S+=R,j+=R}while(j<H);x=Y,Y=x*G[K+0]-X*G[K+1],X=x*G[K+1]+X*G[K+0]}K+=2}while(R<U)}var a0=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(Z,Q,U,K,R){for(var j=0;j<3;j++){var S=J0.BLKSIZE_s/2,H=65535&576/3*(j+1),X=J0.BLKSIZE_s/8-1;do{var Y,D,q,T,_,h=a0[X<<2]&255;Y=O[h]*K[U][R+h+H],_=O[127-h]*K[U][R+h+H+128],D=Y-_,Y=Y+_,q=O[h+64]*K[U][R+h+H+64],_=O[63-h]*K[U][R+h+H+192],T=q-_,q=q+_,S-=4,Q[j][S+0]=Y+q,Q[j][S+2]=Y-q,Q[j][S+1]=D+T,Q[j][S+3]=D-T,Y=O[h+1]*K[U][R+h+H+1],_=O[126-h]*K[U][R+h+H+129],D=Y-_,Y=Y+_,q=O[h+65]*K[U][R+h+H+65],_=O[62-h]*K[U][R+h+H+193],T=q-_,q=q+_,Q[j][S+J0.BLKSIZE_s/2+0]=Y+q,Q[j][S+J0.BLKSIZE_s/2+2]=Y-q,Q[j][S+J0.BLKSIZE_s/2+1]=D+T,Q[j][S+J0.BLKSIZE_s/2+3]=D-T}while(--X>=0);P(Q[j],S,J0.BLKSIZE_s/2)}},this.fft_long=function(Z,Q,U,K,R){var j=J0.BLKSIZE/8-1,S=J0.BLKSIZE/2;do{var H,X,Y,D,q,T=a0[j]&255;H=y[T]*K[U][R+T],q=y[T+512]*K[U][R+T+512],X=H-q,H=H+q,Y=y[T+256]*K[U][R+T+256],q=y[T+768]*K[U][R+T+768],D=Y-q,Y=Y+q,S-=4,Q[S+0]=H+Y,Q[S+2]=H-Y,Q[S+1]=X+D,Q[S+3]=X-D,H=y[T+1]*K[U][R+T+1],q=y[T+513]*K[U][R+T+513],X=H-q,H=H+q,Y=y[T+257]*K[U][R+T+257],q=y[T+769]*K[U][R+T+769],D=Y-q,Y=Y+q,Q[S+J0.BLKSIZE/2+0]=H+Y,Q[S+J0.BLKSIZE/2+2]=H-Y,Q[S+J0.BLKSIZE/2+1]=X+D,Q[S+J0.BLKSIZE/2+3]=X-D}while(--j>=0);P(Q,S,J0.BLKSIZE/2)},this.init_fft=function(Z){for(var Q=0;Q<J0.BLKSIZE;Q++)y[Q]=.42-.5*Math.cos(2*Math.PI*(Q+.5)/J0.BLKSIZE)+.08*Math.cos(4*Math.PI*(Q+.5)/J0.BLKSIZE);for(var Q=0;Q<J0.BLKSIZE_s/2;Q++)O[Q]=.5*(1-Math.cos(2*Math.PI*(Q+.5)/J0.BLKSIZE_s))}}var gt=Jt,fe=P0;fe.System;var p1=fe.VbrMode,Ga=fe.Float,R1=fe.ShortBlock,ue=fe.Util,er=fe.Arrays;fe.new_array_n;fe.new_byte;fe.new_double;var g0=fe.new_float,Ge=fe.new_float_n,c1=fe.new_int;fe.new_int_n;var m0=fe.assert,ar=gt,z=ie();function tr(){var y=new ar,O=2.302585092994046,G=2,P=16,a0=2,Z=16,Q=.34,U=1/(14752*14752)/(z.BLKSIZE/2),K=.01,R=.8,j=.6,S=.3,H=3.5,X=21,Y=.2302585093;function D(m){return m}function q(m,f){for(var p=0,w=0;w<z.BLKSIZE/2;++w)p+=m[w]*f.ATH.eql_w[w];return p*=U,p}function T(m,f,p,w,V,A,L,F,k,g,$){var e0=m.internal_flags;if(k<2)y.fft_long(e0,w[V],k,g,$),y.fft_short(e0,A[L],k,g,$);else if(k==2){for(var u0=z.BLKSIZE-1;u0>=0;--u0){var S0=w[V+0][u0],r0=w[V+1][u0];w[V+0][u0]=(S0+r0)*ue.SQRT2*.5,w[V+1][u0]=(S0-r0)*ue.SQRT2*.5}for(var x0=2;x0>=0;--x0)for(var u0=z.BLKSIZE_s-1;u0>=0;--u0){var S0=A[L+0][x0][u0],r0=A[L+1][x0][u0];A[L+0][x0][u0]=(S0+r0)*ue.SQRT2*.5,A[L+1][x0][u0]=(S0-r0)*ue.SQRT2*.5}}f[0]=w[V+0][0],f[0]*=f[0];for(var u0=z.BLKSIZE/2-1;u0>=0;--u0){var W=w[V+0][z.BLKSIZE/2-u0],f0=w[V+0][z.BLKSIZE/2+u0];f[z.BLKSIZE/2-u0]=(W*W+f0*f0)*.5}for(var x0=2;x0>=0;--x0){p[x0][0]=A[L+0][x0][0],p[x0][0]*=p[x0][0];for(var u0=z.BLKSIZE_s/2-1;u0>=0;--u0){var W=A[L+0][x0][z.BLKSIZE_s/2-u0],f0=A[L+0][x0][z.BLKSIZE_s/2+u0];p[x0][z.BLKSIZE_s/2-u0]=(W*W+f0*f0)*.5}}{for(var E0=0,u0=11;u0<z.HBLKSIZE;u0++)E0+=f[u0];e0.tot_ener[k]=E0}if(m.analysis){for(var u0=0;u0<z.HBLKSIZE;u0++)e0.pinfo.energy[F][k][u0]=e0.pinfo.energy_save[k][u0],e0.pinfo.energy_save[k][u0]=f[u0];e0.pinfo.pe[F][k]=e0.pe[k]}m.athaa_loudapprox==2&&k<2&&(e0.loudness_sq[F][k]=e0.loudness_sq_save[k],e0.loudness_sq_save[k]=q(f,e0))}var _=8,h=23,b=15,e,d,u,x=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function v(){e=Math.pow(10,(_+1)/16),d=Math.pow(10,(h+1)/16),u=Math.pow(10,b/10)}var r=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],s=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],o=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function n(m,f,p,w,V,A){var L;if(f>m)if(f<m*d)L=f/m;else return m+f;else{if(m>=f*d)return m+f;L=m/f}if(m0(m>=0),m0(f>=0),m+=f,w+3<=3+3){if(L>=e)return m;var F=0|ue.FAST_LOG10_X(L,16);return m*s[F]}var F=0|ue.FAST_LOG10_X(L,16);if(A!=0?f=V.ATH.cb_s[p]*V.ATH.adjust:f=V.ATH.cb_l[p]*V.ATH.adjust,m0(f>=0),m<u*f){if(m>f){var k,g;return k=1,F<=13&&(k=o[F]),g=ue.FAST_LOG10_X(m/f,10/15),m*((r[F]-k)*g+k)}return F>13?m:m*o[F]}return m*r[F]}var a=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function c(m,f,p){var w;if(m<0&&(m=0),f<0&&(f=0),m<=0)return f;if(f<=0)return m;if(f>m?w=f/m:w=m/f,-2<=p&&p<=2){if(w>=e)return m+f;var V=0|ue.FAST_LOG10_X(w,16);return(m+f)*a[V]}return w<d?m+f:(m<f&&(m=f),m)}function i(m,f){var p=m.internal_flags;if(p.channels_out>1){for(var w=0;w<z.SBMAX_l;w++){var V=p.thm[0].l[w],A=p.thm[1].l[w];p.thm[0].l[w]+=A*f,p.thm[1].l[w]+=V*f}for(var w=0;w<z.SBMAX_s;w++)for(var L=0;L<3;L++){var V=p.thm[0].s[w][L],A=p.thm[1].s[w][L];p.thm[0].s[w][L]+=A*f,p.thm[1].s[w][L]+=V*f}}}function C(m){for(var f=0;f<z.SBMAX_l;f++)if(!(m.thm[0].l[f]>1.58*m.thm[1].l[f]||m.thm[1].l[f]>1.58*m.thm[0].l[f])){var p=m.mld_l[f]*m.en[3].l[f],w=Math.max(m.thm[2].l[f],Math.min(m.thm[3].l[f],p));p=m.mld_l[f]*m.en[2].l[f];var V=Math.max(m.thm[3].l[f],Math.min(m.thm[2].l[f],p));m.thm[2].l[f]=w,m.thm[3].l[f]=V}for(var f=0;f<z.SBMAX_s;f++)for(var A=0;A<3;A++)if(!(m.thm[0].s[f][A]>1.58*m.thm[1].s[f][A]||m.thm[1].s[f][A]>1.58*m.thm[0].s[f][A])){var p=m.mld_s[f]*m.en[3].s[f][A],w=Math.max(m.thm[2].s[f][A],Math.min(m.thm[3].s[f][A],p));p=m.mld_s[f]*m.en[2].s[f][A];var V=Math.max(m.thm[3].s[f][A],Math.min(m.thm[2].s[f][A],p));m.thm[2].s[f][A]=w,m.thm[3].s[f][A]=V}}function M(m,f,p){var w=f,V=Math.pow(10,p);f*=2,w*=2;for(var A=0;A<z.SBMAX_l;A++){var L,F,k,g;if(g=m.ATH.cb_l[m.bm_l[A]]*V,L=Math.min(Math.max(m.thm[0].l[A],g),Math.max(m.thm[1].l[A],g)),F=Math.max(m.thm[2].l[A],g),k=Math.max(m.thm[3].l[A],g),L*f<F+k){var $=L*w/(F+k);F*=$,k*=$,m0(F+k>0)}m.thm[2].l[A]=Math.min(F,m.thm[2].l[A]),m.thm[3].l[A]=Math.min(k,m.thm[3].l[A])}V*=z.BLKSIZE_s/z.BLKSIZE;for(var A=0;A<z.SBMAX_s;A++)for(var e0=0;e0<3;e0++){var L,F,k,g;if(g=m.ATH.cb_s[m.bm_s[A]]*V,L=Math.min(Math.max(m.thm[0].s[A][e0],g),Math.max(m.thm[1].s[A][e0],g)),F=Math.max(m.thm[2].s[A][e0],g),k=Math.max(m.thm[3].s[A][e0],g),L*f<F+k){var $=L*f/(F+k);F*=$,k*=$,m0(F+k>0)}m.thm[2].s[A][e0]=Math.min(m.thm[2].s[A][e0],F),m.thm[3].s[A][e0]=Math.min(m.thm[3].s[A][e0],k)}}function E(m,f,p,w,V){var A,L,F=0,k=0;for(A=L=0;A<z.SBMAX_s;++L,++A){for(var g=m.bo_s[A],$=m.npart_s,e0=g<$?g:$;L<e0;)m0(f[L]>=0),m0(p[L]>=0),F+=f[L],k+=p[L],L++;if(m.en[w].s[A][V]=F,m.thm[w].s[A][V]=k,L>=$){++A;break}m0(f[L]>=0),m0(p[L]>=0);{var u0=m.PSY.bo_s_weight[A],S0=1-u0;F=u0*f[L],k=u0*p[L],m.en[w].s[A][V]+=F,m.thm[w].s[A][V]+=k,F=S0*f[L],k=S0*p[L]}}for(;A<z.SBMAX_s;++A)m.en[w].s[A][V]=0,m.thm[w].s[A][V]=0}function t(m,f,p,w){var V,A,L=0,F=0;for(V=A=0;V<z.SBMAX_l;++A,++V){for(var k=m.bo_l[V],g=m.npart_l,$=k<g?k:g;A<$;)m0(f[A]>=0),m0(p[A]>=0),L+=f[A],F+=p[A],A++;if(m.en[w].l[V]=L,m.thm[w].l[V]=F,A>=g){++V;break}m0(f[A]>=0),m0(p[A]>=0);{var e0=m.PSY.bo_l_weight[V],u0=1-e0;L=e0*f[A],F=e0*p[A],m.en[w].l[V]+=L,m.thm[w].l[V]+=F,L=u0*f[A],F=u0*p[A]}}for(;V<z.SBMAX_l;++V)m.en[w].l[V]=0,m.thm[w].l[V]=0}function l(m,f,p,w,V,A){var L=m.internal_flags,F,k;for(k=F=0;k<L.npart_s;++k){for(var g=0,$=L.numlines_s[k],e0=0;e0<$;++e0,++F){var u0=f[A][F];g+=u0}p[k]=g}for(m0(k==L.npart_s),m0(F==129),F=k=0;k<L.npart_s;k++){var S0=L.s3ind_s[k][0],r0=L.s3_ss[F++]*p[S0];for(++S0;S0<=L.s3ind_s[k][1];)r0+=L.s3_ss[F]*p[S0],++F,++S0;{var x0=a0*L.nb_s1[V][k];w[k]=Math.min(r0,x0)}if(L.blocktype_old[V&1]==z.SHORT_TYPE){var x0=Z*L.nb_s2[V][k],W=w[k];w[k]=Math.min(x0,W)}L.nb_s2[V][k]=L.nb_s1[V][k],L.nb_s1[V][k]=r0,m0(w[k]>=0)}for(;k<=z.CBANDS;++k)p[k]=0,w[k]=0}function B(m,f,p,w){var V=m.internal_flags;m.short_blocks==R1.short_block_coupled&&!(f[0]!=0&&f[1]!=0)&&(f[0]=f[1]=0);for(var A=0;A<V.channels_out;A++)w[A]=z.NORM_TYPE,m.short_blocks==R1.short_block_dispensed&&(f[A]=1),m.short_blocks==R1.short_block_forced&&(f[A]=0),f[A]!=0?(m0(V.blocktype_old[A]!=z.START_TYPE),V.blocktype_old[A]==z.SHORT_TYPE&&(w[A]=z.STOP_TYPE)):(w[A]=z.SHORT_TYPE,V.blocktype_old[A]==z.NORM_TYPE&&(V.blocktype_old[A]=z.START_TYPE),V.blocktype_old[A]==z.STOP_TYPE&&(V.blocktype_old[A]=z.SHORT_TYPE)),p[A]=V.blocktype_old[A],V.blocktype_old[A]=w[A]}function N(m,f,p){return p>=1?m:p<=0?f:f>0?Math.pow(m/f,p)*f:0}var l0=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function c0(m,f){for(var p=309.07,w=0;w<z.SBMAX_s-1;w++)for(var V=0;V<3;V++){var A=m.thm.s[w][V];if(m0(w<l0.length),A>0){var L=A*f,F=m.en.s[w][V];F>L&&(F>L*1e10?p+=l0[w]*(10*O):(m0(L>0),p+=l0[w]*ue.FAST_LOG10(F/L)))}}return p}var o0=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function v0(m,f){for(var p=281.0575,w=0;w<z.SBMAX_l-1;w++){var V=m.thm.l[w];if(m0(w<o0.length),V>0){var A=V*f,L=m.en.l[w];L>A&&(L>A*1e10?p+=o0[w]*(10*O):(m0(A>0),p+=o0[w]*ue.FAST_LOG10(L/A)))}}return p}function A0(m,f,p,w,V){var A,L;for(A=L=0;A<m.npart_l;++A){var F=0,k=0,g;for(g=0;g<m.numlines_l[A];++g,++L){var $=f[L];m0($>=0),F+=$,k<$&&(k=$)}p[A]=F,w[A]=k,V[A]=F*m.rnumlines_l[A],m0(m.rnumlines_l[A]>=0),m0(F>=0),m0(p[A]>=0),m0(w[A]>=0),m0(V[A]>=0)}}function d0(m,f,p,w){var V=x.length-1,A=0,L=p[A]+p[A+1];if(m0(L>=0),L>0){var F=f[A];F<f[A+1]&&(F=f[A+1]),m0(m.numlines_l[A]+m.numlines_l[A+1]-1>0),L=20*(F*2-L)/(L*(m.numlines_l[A]+m.numlines_l[A+1]-1));var k=0|L;k>V&&(k=V),w[A]=k}else w[A]=0;for(A=1;A<m.npart_l-1;A++)if(L=p[A-1]+p[A]+p[A+1],m0(L>=0),L>0){var F=f[A-1];F<f[A]&&(F=f[A]),F<f[A+1]&&(F=f[A+1]),m0(m.numlines_l[A-1]+m.numlines_l[A]+m.numlines_l[A+1]-1>0),L=20*(F*3-L)/(L*(m.numlines_l[A-1]+m.numlines_l[A]+m.numlines_l[A+1]-1));var k=0|L;k>V&&(k=V),w[A]=k}else w[A]=0;if(m0(A>0),m0(A==m.npart_l-1),L=p[A-1]+p[A],m0(L>=0),L>0){var F=f[A-1];F<f[A]&&(F=f[A]),m0(m.numlines_l[A-1]+m.numlines_l[A]-1>0),L=20*(F*2-L)/(L*(m.numlines_l[A-1]+m.numlines_l[A]-1));var k=0|L;k>V&&(k=V),w[A]=k}else w[A]=0;m0(A==m.npart_l-1)}var _0=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(m,f,p,w,V,A,L,F,k,g){var $=m.internal_flags,e0=Ge([2,z.BLKSIZE]),u0=Ge([2,3,z.BLKSIZE_s]),S0=g0(z.CBANDS+1),r0=g0(z.CBANDS+1),x0=g0(z.CBANDS+2),W=c1(2),f0=c1(2),E0,s0,b0,t0,y0,X0,h0,R0,B0=Ge([2,576]),$0,Ve=c1(z.CBANDS+2),z0=c1(z.CBANDS+2);for(er.fill(z0,0),E0=$.channels_out,m.mode==MPEGMode.JOINT_STEREO&&(E0=4),m.VBR==p1.vbr_off?$0=$.ResvMax==0?0:$.ResvSize/$.ResvMax*.5:m.VBR==p1.vbr_rh||m.VBR==p1.vbr_mtrh||m.VBR==p1.vbr_mt?$0=.6:$0=1,s0=0;s0<$.channels_out;s0++){var G0=f[s0],ve=p+576-350-X+192;for(m0(_0.length==(X-1)/2),t0=0;t0<576;t0++){var Oe,Fe;for(Oe=G0[ve+t0+10],Fe=0,y0=0;y0<(X-1)/2-1;y0+=2)Oe+=_0[y0]*(G0[ve+t0+y0]+G0[ve+t0+X-y0]),Fe+=_0[y0+1]*(G0[ve+t0+y0+1]+G0[ve+t0+X-y0-1]);B0[s0][t0]=Oe+Fe}V[w][s0].en.assign($.en[s0]),V[w][s0].thm.assign($.thm[s0]),E0>2&&(A[w][s0].en.assign($.en[s0+2]),A[w][s0].thm.assign($.thm[s0+2]))}for(s0=0;s0<E0;s0++){var Pe,Ue,ne=g0(12),ze=[0,0,0,0],M1=g0(12),ea=1,Ta,Na=g0(z.CBANDS),Ia=g0(z.CBANDS),Y0=[0,0,0,0],Ca=g0(z.HBLKSIZE),La=Ge([3,z.HBLKSIZE_s]);for(m0($.npart_s<=z.CBANDS),m0($.npart_l<=z.CBANDS),t0=0;t0<3;t0++)ne[t0]=$.nsPsy.last_en_subshort[s0][t0+6],m0($.nsPsy.last_en_subshort[s0][t0+4]>0),M1[t0]=ne[t0]/$.nsPsy.last_en_subshort[s0][t0+4],ze[0]+=ne[t0];if(s0==2)for(t0=0;t0<576;t0++){var aa,ta;aa=B0[0][t0],ta=B0[1][t0],B0[0][t0]=aa+ta,B0[1][t0]=aa-ta}{var ka=B0[s0&1],B1=0;for(t0=0;t0<9;t0++){for(var wt=B1+64,ae=1;B1<wt;B1++)ae<Math.abs(ka[B1])&&(ae=Math.abs(ka[B1]));$.nsPsy.last_en_subshort[s0][t0]=ne[t0+3]=ae,ze[1+t0/3]+=ae,ae>ne[t0+3-2]?(m0(ne[t0+3-2]>0),ae=ae/ne[t0+3-2]):ne[t0+3-2]>ae*10?(m0(ae>0),ae=ne[t0+3-2]/(ae*10)):ae=0,M1[t0+3]=ae}}if(m.analysis){var ra=M1[0];for(t0=1;t0<12;t0++)ra<M1[t0]&&(ra=M1[t0]);$.pinfo.ers[w][s0]=$.pinfo.ers_save[s0],$.pinfo.ers_save[s0]=ra}for(Ta=s0==3?$.nsPsy.attackthre_s:$.nsPsy.attackthre,t0=0;t0<12;t0++)Y0[t0/3]==0&&M1[t0]>Ta&&(Y0[t0/3]=t0%3+1);for(t0=1;t0<4;t0++){var sa;ze[t0-1]>ze[t0]?(m0(ze[t0]>0),sa=ze[t0-1]/ze[t0]):(m0(ze[t0-1]>0),sa=ze[t0]/ze[t0-1]),sa<1.7&&(Y0[t0]=0,t0==1&&(Y0[0]=0))}for(Y0[0]!=0&&$.nsPsy.lastAttacks[s0]!=0&&(Y0[0]=0),($.nsPsy.lastAttacks[s0]==3||Y0[0]+Y0[1]+Y0[2]+Y0[3]!=0)&&(ea=0,Y0[1]!=0&&Y0[0]!=0&&(Y0[1]=0),Y0[2]!=0&&Y0[1]!=0&&(Y0[2]=0),Y0[3]!=0&&Y0[2]!=0&&(Y0[3]=0)),s0<2?f0[s0]=ea:ea==0&&(f0[0]=f0[1]=0),k[s0]=$.tot_ener[s0],Ue=u0,Pe=e0,T(m,Ca,La,Pe,s0&1,Ue,s0&1,w,s0,f,p),A0($,Ca,S0,Na,Ia),d0($,Na,Ia,Ve),R0=0;R0<3;R0++){var na,ce;for(l(m,La,r0,x0,s0,R0),E($,r0,x0,s0,R0),h0=0;h0<z.SBMAX_s;h0++){if(ce=$.thm[s0].s[h0][R0],ce*=R,Y0[R0]>=2||Y0[R0+1]==1){var T1=R0!=0?R0-1:2,ae=N($.thm[s0].s[h0][T1],ce,j*$0);ce=Math.min(ce,ae)}if(Y0[R0]==1){var T1=R0!=0?R0-1:2,ae=N($.thm[s0].s[h0][T1],ce,S*$0);ce=Math.min(ce,ae)}else if(R0!=0&&Y0[R0-1]==3||R0==0&&$.nsPsy.lastAttacks[s0]==3){var T1=R0!=2?R0+1:0,ae=N($.thm[s0].s[h0][T1],ce,S*$0);ce=Math.min(ce,ae)}na=ne[R0*3+3]+ne[R0*3+4]+ne[R0*3+5],ne[R0*3+5]*6<na&&(ce*=.5,ne[R0*3+4]*6<na&&(ce*=.5)),$.thm[s0].s[h0][R0]=ce}}for($.nsPsy.lastAttacks[s0]=Y0[2],X0=0,b0=0;b0<$.npart_l;b0++){for(var _1=$.s3ind[b0][0],ia=S0[_1]*x[Ve[_1]],o1=$.s3_ll[X0++]*ia;++_1<=$.s3ind[b0][1];)ia=S0[_1]*x[Ve[_1]],o1=n(o1,$.s3_ll[X0++]*ia,_1,_1-b0,$,0);o1*=.158489319246111,$.blocktype_old[s0&1]==z.SHORT_TYPE?x0[b0]=o1:x0[b0]=N(Math.min(o1,Math.min(G*$.nb_1[s0][b0],P*$.nb_2[s0][b0])),o1,$0),$.nb_2[s0][b0]=$.nb_1[s0][b0],$.nb_1[s0][b0]=o1}for(;b0<=z.CBANDS;++b0)S0[b0]=0,x0[b0]=0;t($,S0,x0,s0)}if((m.mode==MPEGMode.STEREO||m.mode==MPEGMode.JOINT_STEREO)&&m.interChRatio>0&&i(m,m.interChRatio),m.mode==MPEGMode.JOINT_STEREO){var la;C($),la=m.msfix,Math.abs(la)>0&&M($,la,m.ATHlower*$.ATH.adjust)}for(B(m,f0,g,W),s0=0;s0<E0;s0++){var N1,I1=0,j1,H1;s0>1?(N1=F,I1=-2,j1=z.NORM_TYPE,(g[0]==z.SHORT_TYPE||g[1]==z.SHORT_TYPE)&&(j1=z.SHORT_TYPE),H1=A[w][s0-2]):(N1=L,I1=0,j1=g[s0],H1=V[w][s0]),j1==z.SHORT_TYPE?N1[I1+s0]=c0(H1,$.masking_lower):N1[I1+s0]=v0(H1,$.masking_lower),m.analysis&&($.pinfo.pe[w][s0]=N1[I1+s0])}return 0};function T0(m,f,p,w,V,A,L,F){var k=m.internal_flags;if(w<2)y.fft_long(k,L[F],w,f,p);else if(w==2)for(var g=z.BLKSIZE-1;g>=0;--g){var $=L[F+0][g],e0=L[F+1][g];L[F+0][g]=($+e0)*ue.SQRT2*.5,L[F+1][g]=($-e0)*ue.SQRT2*.5}A[0]=L[F+0][0],A[0]*=A[0];for(var g=z.BLKSIZE/2-1;g>=0;--g){var u0=L[F+0][z.BLKSIZE/2-g],S0=L[F+0][z.BLKSIZE/2+g];A[z.BLKSIZE/2-g]=(u0*u0+S0*S0)*.5}{for(var r0=0,g=11;g<z.HBLKSIZE;g++)r0+=A[g];k.tot_ener[w]=r0}if(m.analysis){for(var g=0;g<z.HBLKSIZE;g++)k.pinfo.energy[V][w][g]=k.pinfo.energy_save[w][g],k.pinfo.energy_save[w][g]=A[g];k.pinfo.pe[V][w]=k.pe[w]}}function F0(m,f,p,w,V,A,L,F){var k=m.internal_flags;if(V==0&&w<2&&y.fft_short(k,L[F],w,f,p),w==2)for(var g=z.BLKSIZE_s-1;g>=0;--g){var $=L[F+0][V][g],e0=L[F+1][V][g];L[F+0][V][g]=($+e0)*ue.SQRT2*.5,L[F+1][V][g]=($-e0)*ue.SQRT2*.5}A[V][0]=L[F+0][V][0],A[V][0]*=A[V][0];for(var g=z.BLKSIZE_s/2-1;g>=0;--g){var u0=L[F+0][V][z.BLKSIZE_s/2-g],S0=L[F+0][V][z.BLKSIZE_s/2+g];A[V][z.BLKSIZE_s/2-g]=(u0*u0+S0*S0)*.5}}function p0(m,f,p,w){var V=m.internal_flags;m.athaa_loudapprox==2&&p<2&&(V.loudness_sq[f][p]=V.loudness_sq_save[p],V.loudness_sq_save[p]=q(w,V))}var I0=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function N0(m,f,p,w,V,A,L,F,k,g){for(var $=Ge([2,576]),e0=m.internal_flags,u0=e0.channels_out,S0=m.mode==MPEGMode.JOINT_STEREO?4:u0,r0=0;r0<u0;r0++){firbuf=f[r0];var x0=p+576-350-X+192;m0(I0.length==(X-1)/2);for(var W=0;W<576;W++){var f0,E0;f0=firbuf[x0+W+10],E0=0;for(var s0=0;s0<(X-1)/2-1;s0+=2)f0+=I0[s0]*(firbuf[x0+W+s0]+firbuf[x0+W+X-s0]),E0+=I0[s0+1]*(firbuf[x0+W+s0+1]+firbuf[x0+W+X-s0-1]);$[r0][W]=f0+E0}V[w][r0].en.assign(e0.en[r0]),V[w][r0].thm.assign(e0.thm[r0]),S0>2&&(A[w][r0].en.assign(e0.en[r0+2]),A[w][r0].thm.assign(e0.thm[r0+2]))}for(var r0=0;r0<S0;r0++){var b0=g0(12),t0=g0(12),y0=[0,0,0,0],X0=$[r0&1],h0=0,R0=r0==3?e0.nsPsy.attackthre_s:e0.nsPsy.attackthre,B0=1;if(r0==2)for(var W=0,s0=576;s0>0;++W,--s0){var $0=$[0][W],Ve=$[1][W];$[0][W]=$0+Ve,$[1][W]=$0-Ve}for(var W=0;W<3;W++)t0[W]=e0.nsPsy.last_en_subshort[r0][W+6],m0(e0.nsPsy.last_en_subshort[r0][W+4]>0),b0[W]=t0[W]/e0.nsPsy.last_en_subshort[r0][W+4],y0[0]+=t0[W];for(var W=0;W<9;W++){for(var z0=h0+64,G0=1;h0<z0;h0++)G0<Math.abs(X0[h0])&&(G0=Math.abs(X0[h0]));e0.nsPsy.last_en_subshort[r0][W]=t0[W+3]=G0,y0[1+W/3]+=G0,G0>t0[W+3-2]?(m0(t0[W+3-2]>0),G0=G0/t0[W+3-2]):t0[W+3-2]>G0*10?(m0(G0>0),G0=t0[W+3-2]/(G0*10)):G0=0,b0[W+3]=G0}for(var W=0;W<3;++W){var ve=t0[W*3+3]+t0[W*3+4]+t0[W*3+5],Oe=1;t0[W*3+5]*6<ve&&(Oe*=.5,t0[W*3+4]*6<ve&&(Oe*=.5)),F[r0][W]=Oe}if(m.analysis){for(var Fe=b0[0],W=1;W<12;W++)Fe<b0[W]&&(Fe=b0[W]);e0.pinfo.ers[w][r0]=e0.pinfo.ers_save[r0],e0.pinfo.ers_save[r0]=Fe}for(var W=0;W<12;W++)k[r0][W/3]==0&&b0[W]>R0&&(k[r0][W/3]=W%3+1);for(var W=1;W<4;W++){var Pe=y0[W-1],Ue=y0[W],ne=Math.max(Pe,Ue);ne<4e4&&Pe<1.7*Ue&&Ue<1.7*Pe&&(W==1&&k[r0][0]<=k[r0][W]&&(k[r0][0]=0),k[r0][W]=0)}k[r0][0]<=e0.nsPsy.lastAttacks[r0]&&(k[r0][0]=0),(e0.nsPsy.lastAttacks[r0]==3||k[r0][0]+k[r0][1]+k[r0][2]+k[r0][3]!=0)&&(B0=0,k[r0][1]!=0&&k[r0][0]!=0&&(k[r0][1]=0),k[r0][2]!=0&&k[r0][1]!=0&&(k[r0][2]=0),k[r0][3]!=0&&k[r0][2]!=0&&(k[r0][3]=0)),r0<2?g[r0]=B0:B0==0&&(g[0]=g[1]=0),L[r0]=e0.tot_ener[r0]}}function D0(m,f,p){if(p==0)for(var w=0;w<m.npart_s;w++)m.nb_s2[f][w]=m.nb_s1[f][w],m.nb_s1[f][w]=0}function W0(m,f){for(var p=0;p<m.npart_l;p++)m.nb_2[f][p]=m.nb_1[f][p],m.nb_1[f][p]=0}function De(m,f,p,w){var V=x.length-1,A=0,L=p[A]+p[A+1];if(m0(L>=0),L>0){var F=f[A];F<f[A+1]&&(F=f[A+1]),m0(m.numlines_s[A]+m.numlines_s[A+1]-1>0),L=20*(F*2-L)/(L*(m.numlines_s[A]+m.numlines_s[A+1]-1));var k=0|L;k>V&&(k=V),w[A]=k}else w[A]=0;for(A=1;A<m.npart_s-1;A++)if(L=p[A-1]+p[A]+p[A+1],m0(A+1<m.npart_s),m0(L>=0),L>0){var F=f[A-1];F<f[A]&&(F=f[A]),F<f[A+1]&&(F=f[A+1]),m0(m.numlines_s[A-1]+m.numlines_s[A]+m.numlines_s[A+1]-1>0),L=20*(F*3-L)/(L*(m.numlines_s[A-1]+m.numlines_s[A]+m.numlines_s[A+1]-1));var k=0|L;k>V&&(k=V),w[A]=k}else w[A]=0;if(m0(A>0),m0(A==m.npart_s-1),L=p[A-1]+p[A],m0(L>=0),L>0){var F=f[A-1];F<f[A]&&(F=f[A]),m0(m.numlines_s[A-1]+m.numlines_s[A]-1>0),L=20*(F*2-L)/(L*(m.numlines_s[A-1]+m.numlines_s[A]-1));var k=0|L;k>V&&(k=V),w[A]=k}else w[A]=0;m0(A==m.npart_s-1)}function le(m,f,p,w,V,A){var L=m.internal_flags,F=new float[z.CBANDS],k=g0(z.CBANDS),g,$,e0,u0=new int[z.CBANDS];for(e0=$=0;e0<L.npart_s;++e0){var S0=0,r0=0,x0=L.numlines_s[e0];for(g=0;g<x0;++g,++$){var W=f[A][$];S0+=W,r0<W&&(r0=W)}p[e0]=S0,m0(S0>=0),F[e0]=r0,m0(x0>0),k[e0]=S0/x0,m0(k[e0]>=0)}for(m0(e0==L.npart_s),m0($==129);e0<z.CBANDS;++e0)F[e0]=0,k[e0]=0;for(De(L,F,k,u0),$=e0=0;e0<L.npart_s;e0++){var f0=L.s3ind_s[e0][0],E0=L.s3ind_s[e0][1],s0,b0,t0,y0,X0;for(s0=u0[f0],b0=1,y0=L.s3_ss[$]*p[f0]*x[u0[f0]],++$,++f0;f0<=E0;)s0+=u0[f0],b0+=1,t0=L.s3_ss[$]*p[f0]*x[u0[f0]],y0=c(y0,t0,f0-e0),++$,++f0;s0=(1+2*s0)/(2*b0),X0=x[s0]*.5,y0*=X0,w[e0]=y0,L.nb_s2[V][e0]=L.nb_s1[V][e0],L.nb_s1[V][e0]=y0,t0=F[e0],t0*=L.minval_s[e0],t0*=X0,w[e0]>t0&&(w[e0]=t0),L.masking_lower>1&&(w[e0]*=L.masking_lower),w[e0]>p[e0]&&(w[e0]=p[e0]),L.masking_lower<1&&(w[e0]*=L.masking_lower),m0(w[e0]>=0)}for(;e0<z.CBANDS;++e0)p[e0]=0,w[e0]=0}function se(m,f,p,w,V){var A=g0(z.CBANDS),L=g0(z.CBANDS),F=c1(z.CBANDS+2),k;A0(m,f,p,A,L),d0(m,A,L,F);var g=0;for(k=0;k<m.npart_l;k++){var $,e0,u0,S0,r0=m.s3ind[k][0],x0=m.s3ind[k][1],W=0,f0=0;for(W=F[r0],f0+=1,e0=m.s3_ll[g]*p[r0]*x[F[r0]],++g,++r0;r0<=x0;)W+=F[r0],f0+=1,$=m.s3_ll[g]*p[r0]*x[F[r0]],S0=c(e0,$,r0-k),e0=S0,++g,++r0;if(W=(1+2*W)/(2*f0),u0=x[W]*.5,e0*=u0,m.blocktype_old[V&1]==z.SHORT_TYPE){var E0=G*m.nb_1[V][k];E0>0?w[k]=Math.min(e0,E0):w[k]=Math.min(e0,p[k]*S)}else{var s0=P*m.nb_2[V][k],b0=G*m.nb_1[V][k],E0;s0<=0&&(s0=e0),b0<=0&&(b0=e0),m.blocktype_old[V&1]==z.NORM_TYPE?E0=Math.min(b0,s0):E0=b0,w[k]=Math.min(e0,E0)}m.nb_2[V][k]=m.nb_1[V][k],m.nb_1[V][k]=e0,$=A[k],$*=m.minval_l[k],$*=u0,w[k]>$&&(w[k]=$),m.masking_lower>1&&(w[k]*=m.masking_lower),w[k]>p[k]&&(w[k]=p[k]),m.masking_lower<1&&(w[k]*=m.masking_lower),m0(w[k]>=0)}for(;k<z.CBANDS;++k)p[k]=0,w[k]=0}function ke(m,f){var p=m.internal_flags;m.short_blocks==R1.short_block_coupled&&!(f[0]!=0&&f[1]!=0)&&(f[0]=f[1]=0);for(var w=0;w<p.channels_out;w++)m.short_blocks==R1.short_block_dispensed&&(f[w]=1),m.short_blocks==R1.short_block_forced&&(f[w]=0)}function a1(m,f,p){for(var w=m.internal_flags,V=0;V<w.channels_out;V++){var A=z.NORM_TYPE;f[V]!=0?(m0(w.blocktype_old[V]!=z.START_TYPE),w.blocktype_old[V]==z.SHORT_TYPE&&(A=z.STOP_TYPE)):(A=z.SHORT_TYPE,w.blocktype_old[V]==z.NORM_TYPE&&(w.blocktype_old[V]=z.START_TYPE),w.blocktype_old[V]==z.STOP_TYPE&&(w.blocktype_old[V]=z.SHORT_TYPE)),p[V]=w.blocktype_old[V],w.blocktype_old[V]=A}}function We(m,f,p,w,V,A,L){for(var F=A*2,k=A>0?Math.pow(10,V):1,g,$,e0=0;e0<L;++e0){var u0=m[2][e0],S0=m[3][e0],r0=f[0][e0],x0=f[1][e0],W=f[2][e0],f0=f[3][e0];if(r0<=1.58*x0&&x0<=1.58*r0){var E0=p[e0]*S0,s0=p[e0]*u0;$=Math.max(W,Math.min(f0,E0)),g=Math.max(f0,Math.min(W,s0))}else $=W,g=f0;if(A>0){var b0,t0,y0=w[e0]*k;if(b0=Math.min(Math.max(r0,y0),Math.max(x0,y0)),W=Math.max($,y0),f0=Math.max(g,y0),t0=W+f0,t0>0&&b0*F<t0){var X0=b0*F/t0;W*=X0,f0*=X0,m0(t0>0)}$=Math.min(W,$),g=Math.min(f0,g)}$>u0&&($=u0),g>S0&&(g=S0),f[2][e0]=$,f[3][e0]=g}}this.L3psycho_anal_vbr=function(m,f,p,w,V,A,L,F,k,g){var $=m.internal_flags,e0,u0,S0=g0(z.HBLKSIZE),r0=Ge([3,z.HBLKSIZE_s]),x0=Ge([2,z.BLKSIZE]),W=Ge([2,3,z.BLKSIZE_s]),f0=Ge([4,z.CBANDS]),E0=Ge([4,z.CBANDS]),s0=Ge([4,3]),b0=.6,t0=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],y0=c1(2),X0=m.mode==MPEGMode.JOINT_STEREO?4:$.channels_out;N0(m,f,p,w,V,A,k,s0,t0,y0),ke(m,y0);{for(var h0=0;h0<X0;h0++){var R0=h0&1;e0=x0,T0(m,f,p,h0,w,S0,e0,R0),p0(m,w,h0,S0),y0[R0]!=0?se($,S0,f0[h0],E0[h0],h0):W0($,h0)}y0[0]+y0[1]==2&&m.mode==MPEGMode.JOINT_STEREO&&We(f0,E0,$.mld_cb_l,$.ATH.cb_l,m.ATHlower*$.ATH.adjust,m.msfix,$.npart_l);for(var h0=0;h0<X0;h0++){var R0=h0&1;y0[R0]!=0&&t($,f0[h0],E0[h0],h0)}}{for(var B0=0;B0<3;B0++){for(var h0=0;h0<X0;++h0){var R0=h0&1;y0[R0]!=0?D0($,h0,B0):(u0=W,F0(m,f,p,h0,B0,r0,u0,R0),le(m,r0,f0[h0],E0[h0],h0,B0))}y0[0]+y0[1]==0&&m.mode==MPEGMode.JOINT_STEREO&&We(f0,E0,$.mld_cb_s,$.ATH.cb_s,m.ATHlower*$.ATH.adjust,m.msfix,$.npart_s);for(var h0=0;h0<X0;++h0){var R0=h0&1;y0[R0]==0&&E($,f0[h0],E0[h0],h0,B0)}}for(var h0=0;h0<X0;h0++){var R0=h0&1;if(y0[R0]==0)for(var $0=0;$0<z.SBMAX_s;$0++){for(var Ve=g0(3),B0=0;B0<3;B0++){var z0=$.thm[h0].s[$0][B0];if(z0*=R,t0[h0][B0]>=2||t0[h0][B0+1]==1){var G0=B0!=0?B0-1:2,ve=N($.thm[h0].s[$0][G0],z0,j*b0);z0=Math.min(z0,ve)}else if(t0[h0][B0]==1){var G0=B0!=0?B0-1:2,ve=N($.thm[h0].s[$0][G0],z0,S*b0);z0=Math.min(z0,ve)}else if(B0!=0&&t0[h0][B0-1]==3||B0==0&&$.nsPsy.lastAttacks[h0]==3){var G0=B0!=2?B0+1:0,ve=N($.thm[h0].s[$0][G0],z0,S*b0);z0=Math.min(z0,ve)}z0*=s0[h0][B0],Ve[B0]=z0}for(var B0=0;B0<3;B0++)$.thm[h0].s[$0][B0]=Ve[B0]}}}for(var h0=0;h0<X0;h0++)$.nsPsy.lastAttacks[h0]=t0[h0][2];a1(m,y0,g);for(var h0=0;h0<X0;h0++){var Oe,Fe,Pe,Ue;h0>1?(Oe=F,Fe=-2,Pe=z.NORM_TYPE,(g[0]==z.SHORT_TYPE||g[1]==z.SHORT_TYPE)&&(Pe=z.SHORT_TYPE),Ue=A[w][h0-2]):(Oe=L,Fe=0,Pe=g[h0],Ue=V[w][h0]),Pe==z.SHORT_TYPE?Oe[Fe+h0]=c0(Ue,$.masking_lower):Oe[Fe+h0]=v0(Ue,$.masking_lower),m.analysis&&($.pinfo.pe[w][h0]=Oe[Fe+h0])}return 0};function re(m,f){var p=m,w;return p>=0?w=-p*27:w=p*f,w<=-72?0:Math.exp(w*Y)}function t1(m){var f=0,p=0;{var w=0,V,A;for(w=0;re(w,m)>1e-20;w-=1);for(V=w,A=0;Math.abs(A-V)>1e-12;)w=(A+V)/2,re(w,m)>0?A=w:V=w;f=V}{var w=0,V,A;for(w=0;re(w,m)>1e-20;w+=1);for(V=0,A=w;Math.abs(A-V)>1e-12;)w=(A+V)/2,re(w,m)>0?V=w:A=w;p=A}{var L=0,F=1e3,k;for(k=0;k<=F;++k){var w=f+k*(p-f)/F,g=re(w,m);L+=g}{var $=(F+1)/(L*(p-f));return $}}}function J(m){var f,p,w,V;return f=m,f>=0?f*=3:f*=1.5,f>=.5&&f<=2.5?(V=f-.5,p=8*(V*V-2*V)):p=0,f+=.474,w=15.811389+7.5*f-17.5*Math.sqrt(1+f*f),w<=-60?0:(f=Math.exp((p+w)*Y),f/=.6609193,f)}function n0(m){return m<0&&(m=0),m=m*.001,13*Math.atan(.76*m)+3.5*Math.atan(m*m/(7.5*7.5))}function M0(m,f,p,w,V,A,L,F,k,g,$,e0){var u0=g0(z.CBANDS+1),S0=F/(e0>15?2*576:2*192),r0=c1(z.HBLKSIZE),x0;F/=k;var W=0,f0=0;for(x0=0;x0<z.CBANDS;x0++){var E0,s0;for(E0=n0(F*W),u0[x0]=F*W,s0=W;n0(F*s0)-E0<Q&&s0<=k/2;s0++);for(m[x0]=s0-W,f0=x0+1;W<s0;)m0(W<z.HBLKSIZE),r0[W++]=x0;if(W>k/2){W=k/2,++x0;break}}m0(x0<z.CBANDS),u0[x0]=F*W;for(var b0=0;b0<e0;b0++){var t0,y0,X0,h0,R0;X0=g[b0],h0=g[b0+1],t0=0|Math.floor(.5+$*(X0-.5)),t0<0&&(t0=0),y0=0|Math.floor(.5+$*(h0-.5)),y0>k/2&&(y0=k/2),p[b0]=(r0[t0]+r0[y0])/2,f[b0]=r0[y0];var B0=S0*h0;L[b0]=(B0-u0[f[b0]])/(u0[f[b0]+1]-u0[f[b0]]),L[b0]<0?L[b0]=0:L[b0]>1&&(L[b0]=1),R0=n0(F*g[b0]*$),R0=Math.min(R0,15.5)/15.5,A[b0]=Math.pow(10,1.25*(1-Math.cos(Math.PI*R0))-2.5)}W=0;for(var $0=0;$0<f0;$0++){var Ve=m[$0],E0,z0;E0=n0(F*W),z0=n0(F*(W+Ve-1)),w[$0]=.5*(E0+z0),E0=n0(F*(W-.5)),z0=n0(F*(W+Ve-.5)),V[$0]=z0-E0,W+=Ve}return f0}function O0(m,f,p,w,V,A){var L=Ge([z.CBANDS,z.CBANDS]),F,k=0;if(A)for(var g=0;g<f;g++)for(F=0;F<f;F++){var $=J(p[g]-p[F])*w[F];L[g][F]=$*V[g]}else for(F=0;F<f;F++)for(var e0=15+Math.min(21/p[F],12),u0=t1(e0),g=0;g<f;g++){var $=u0*re(p[g]-p[F],e0)*w[F];L[g][F]=$*V[g]}for(var g=0;g<f;g++){for(F=0;F<f&&!(L[g][F]>0);F++);for(m[g][0]=F,F=f-1;F>0&&!(L[g][F]>0);F--);m[g][1]=F,k+=m[g][1]-m[g][0]+1}for(var S0=g0(k),r0=0,g=0;g<f;g++)for(F=m[g][0];F<=m[g][1];F++)S0[r0++]=L[g][F];return S0}function j0(m){var f=n0(m);return f=Math.min(f,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*f))-2.5)}this.psymodel_init=function(m){var f=m.internal_flags,p,w=!0,V=13,A=24,L=0,F=0,k=-8.25,g=-4.5,$=g0(z.CBANDS),e0=g0(z.CBANDS),u0=g0(z.CBANDS),S0=m.out_samplerate;switch(m.experimentalZ){default:case 0:w=!0;break;case 1:w=!(m.VBR==p1.vbr_mtrh||m.VBR==p1.vbr_mt);break;case 2:w=!1;break;case 3:V=8,L=-1.75,F=-.0125,k=-8.25,g=-2.25;break}for(f.ms_ener_ratio_old=.25,f.blocktype_old[0]=f.blocktype_old[1]=z.NORM_TYPE,p=0;p<4;++p){for(var W=0;W<z.CBANDS;++W)f.nb_1[p][W]=1e20,f.nb_2[p][W]=1e20,f.nb_s1[p][W]=f.nb_s2[p][W]=1;for(var r0=0;r0<z.SBMAX_l;r0++)f.en[p].l[r0]=1e20,f.thm[p].l[r0]=1e20;for(var W=0;W<3;++W){for(var r0=0;r0<z.SBMAX_s;r0++)f.en[p].s[r0][W]=1e20,f.thm[p].s[r0][W]=1e20;f.nsPsy.lastAttacks[p]=0}for(var W=0;W<9;W++)f.nsPsy.last_en_subshort[p][W]=10}for(f.loudness_sq_save[0]=f.loudness_sq_save[1]=0,f.npart_l=M0(f.numlines_l,f.bo_l,f.bm_l,$,e0,f.mld_l,f.PSY.bo_l_weight,S0,z.BLKSIZE,f.scalefac_band.l,z.BLKSIZE/(2*576),z.SBMAX_l),m0(f.npart_l<z.CBANDS),p=0;p<f.npart_l;p++){var x0=L;$[p]>=V&&(x0=F*($[p]-V)/(A-V)+L*(A-$[p])/(A-V)),u0[p]=Math.pow(10,x0/10),f.numlines_l[p]>0?f.rnumlines_l[p]=1/f.numlines_l[p]:f.rnumlines_l[p]=0}f.s3_ll=O0(f.s3ind,f.npart_l,$,e0,u0,w);var W=0;for(p=0;p<f.npart_l;p++){var f0;f0=Ga.MAX_VALUE;for(var E0=0;E0<f.numlines_l[p];E0++,W++){var s0=S0*W/(1e3*z.BLKSIZE),b0;b0=this.ATHformula(s0*1e3,m)-20,b0=Math.pow(10,.1*b0),b0*=f.numlines_l[p],f0>b0&&(f0=b0)}f.ATH.cb_l[p]=f0,f0=-20+$[p]*20/10,f0>6&&(f0=100),f0<-15&&(f0=-15),f0-=8,f.minval_l[p]=Math.pow(10,f0/10)*f.numlines_l[p]}for(f.npart_s=M0(f.numlines_s,f.bo_s,f.bm_s,$,e0,f.mld_s,f.PSY.bo_s_weight,S0,z.BLKSIZE_s,f.scalefac_band.s,z.BLKSIZE_s/(2*192),z.SBMAX_s),m0(f.npart_s<z.CBANDS),W=0,p=0;p<f.npart_s;p++){var f0,x0=k;$[p]>=V&&(x0=g*($[p]-V)/(A-V)+k*(A-$[p])/(A-V)),u0[p]=Math.pow(10,x0/10),f0=Ga.MAX_VALUE;for(var E0=0;E0<f.numlines_s[p];E0++,W++){var s0=S0*W/(1e3*z.BLKSIZE_s),b0;b0=this.ATHformula(s0*1e3,m)-20,b0=Math.pow(10,.1*b0),b0*=f.numlines_s[p],f0>b0&&(f0=b0)}f.ATH.cb_s[p]=f0,f0=-7+$[p]*7/12,$[p]>12&&(f0*=1+Math.log(1+f0)*3.1),$[p]<12&&(f0*=1+Math.log(1-f0)*2.3),f0<-15&&(f0=-15),f0-=8,f.minval_s[p]=Math.pow(10,f0/10)*f.numlines_s[p]}f.s3_ss=O0(f.s3ind_s,f.npart_s,$,e0,u0,w),v(),y.init_fft(f),f.decay=Math.exp(-1*O/(K*S0/192));{var t0;t0=H,m.exp_nspsytune&2&&(t0=1),Math.abs(m.msfix)>0&&(t0=m.msfix),m.msfix=t0;for(var y0=0;y0<f.npart_l;y0++)f.s3ind[y0][1]>f.npart_l-1&&(f.s3ind[y0][1]=f.npart_l-1)}var X0=576*f.mode_gr/S0;if(f.ATH.decay=Math.pow(10,-12/10*X0),f.ATH.adjust=.01,f.ATH.adjustLimit=1,m0(f.bo_l[z.SBMAX_l-1]<=f.npart_l),m0(f.bo_s[z.SBMAX_s-1]<=f.npart_s),m.ATHtype!=-1){var s0,h0=m.out_samplerate/z.BLKSIZE,R0=0;for(s0=0,p=0;p<z.BLKSIZE/2;++p)s0+=h0,f.ATH.eql_w[p]=1/Math.pow(10,this.ATHformula(s0,m)/10),R0+=f.ATH.eql_w[p];for(R0=1/R0,p=z.BLKSIZE/2;--p>=0;)f.ATH.eql_w[p]*=R0}{for(var y0=W=0;y0<f.npart_s;++y0)for(p=0;p<f.numlines_s[y0];++p)++W;m0(W==129);for(var y0=W=0;y0<f.npart_l;++y0)for(p=0;p<f.numlines_l[y0];++p)++W;m0(W==513)}for(W=0,p=0;p<f.npart_l;p++){var s0=S0*(W+f.numlines_l[p]/2)/(1*z.BLKSIZE);f.mld_cb_l[p]=j0(s0),W+=f.numlines_l[p]}for(;p<z.CBANDS;++p)f.mld_cb_l[p]=1;for(W=0,p=0;p<f.npart_s;p++){var s0=S0*(W+f.numlines_s[p]/2)/(1*z.BLKSIZE_s);f.mld_cb_s[p]=j0(s0),W+=f.numlines_s[p]}for(;p<z.CBANDS;++p)f.mld_cb_s[p]=1;return 0};function V0(m,f){m<-.3&&(m=3410),m/=1e3,m=Math.max(.1,m);var p=3.64*Math.pow(m,-.8)-6.8*Math.exp(-.6*Math.pow(m-3.4,2))+6*Math.exp(-.15*Math.pow(m-8.7,2))+(.6+.04*f)*.001*Math.pow(m,4);return p}this.ATHformula=function(m,f){var p;switch(f.ATHtype){case 0:p=V0(m,9);break;case 1:p=V0(m,-1);break;case 2:p=V0(m,0);break;case 3:p=V0(m,1)+6;break;case 4:p=V0(m,f.ATHcurve);break;default:p=V0(m,0);break}return p}}var rr=tr;function Qe(y){var O=y;this.ordinal=function(){return O}}Qe.STEREO=new Qe(0);Qe.JOINT_STEREO=new Qe(1);Qe.DUAL_CHANNEL=new Qe(2);Qe.MONO=new Qe(3);Qe.NOT_SET=new Qe(4);var bt=Qe,sr=bt;function nr(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=sr.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var ir=nr,lr=ie(),xt={};xt.SFBMAX=lr.SBMAX_s*3;var z1=xt,be=P0;be.System;be.VbrMode;be.Float;be.ShortBlock;be.Util;be.Arrays;be.new_array_n;be.new_byte;be.new_double;var _r=be.new_float;be.new_float_n;var u1=be.new_int;be.new_int_n;be.assert;var ha=z1;function or(){this.xr=_r(576),this.l3_enc=u1(576),this.scalefac=u1(ha.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=u1(3),this.subblock_gain=u1(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=u1(ha.SFBMAX),this.window=u1(ha.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=u1(4),this.max_nonzero_coeff=0;var y=this;function O(P){return new Int32Array(P)}function G(P){return new Float32Array(P)}this.assign=function(P){y.xr=G(P.xr),y.l3_enc=O(P.l3_enc),y.scalefac=O(P.scalefac),y.xrpow_max=P.xrpow_max,y.part2_3_length=P.part2_3_length,y.big_values=P.big_values,y.count1=P.count1,y.global_gain=P.global_gain,y.scalefac_compress=P.scalefac_compress,y.block_type=P.block_type,y.mixed_block_flag=P.mixed_block_flag,y.table_select=O(P.table_select),y.subblock_gain=O(P.subblock_gain),y.region0_count=P.region0_count,y.region1_count=P.region1_count,y.preflag=P.preflag,y.scalefac_scale=P.scalefac_scale,y.count1table_select=P.count1table_select,y.part2_length=P.part2_length,y.sfb_lmax=P.sfb_lmax,y.sfb_smin=P.sfb_smin,y.psy_lmax=P.psy_lmax,y.sfbmax=P.sfbmax,y.psymax=P.psymax,y.sfbdivide=P.sfbdivide,y.width=O(P.width),y.window=O(P.window),y.count1bits=P.count1bits,y.sfb_partition_table=P.sfb_partition_table.slice(0),y.slen=O(P.slen),y.max_nonzero_coeff=P.max_nonzero_coeff}}var wa=or,xe=P0;xe.System;xe.VbrMode;xe.Float;xe.ShortBlock;xe.Util;xe.Arrays;xe.new_array_n;xe.new_byte;xe.new_double;xe.new_float;xe.new_float_n;var qa=xe.new_int;xe.new_int_n;xe.assert;var vr=wa;function cr(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[qa(4),qa(4)];for(var y=0;y<2;y++)for(var O=0;O<2;O++)this.tt[y][O]=new vr}var ur=cr,Se=P0,D1=Se.System;Se.VbrMode;Se.Float;Se.ShortBlock;Se.Util;Se.Arrays;Se.new_array_n;Se.new_byte;Se.new_double;Se.new_float;Se.new_float_n;var G1=Se.new_int;Se.new_int_n;Se.assert;var q1=ie();function hr(y,O,G,P){this.l=G1(1+q1.SBMAX_l),this.s=G1(1+q1.SBMAX_s),this.psfb21=G1(1+q1.PSFB21),this.psfb12=G1(1+q1.PSFB12);var a0=this.l,Z=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],D1.arraycopy(this.arrL,0,a0,0,Math.min(this.arrL.length,this.l.length)),D1.arraycopy(this.arrS,0,Z,0,Math.min(this.arrS.length,this.s.length)),D1.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),D1.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var St=hr,Ae=P0;Ae.System;Ae.VbrMode;Ae.Float;Ae.ShortBlock;Ae.Util;Ae.Arrays;Ae.new_array_n;Ae.new_byte;Ae.new_double;var da=Ae.new_float,dr=Ae.new_float_n,mr=Ae.new_int;Ae.new_int_n;Ae.assert;var $a=ie();function fr(){this.last_en_subshort=dr([4,9]),this.lastAttacks=mr(4),this.pefirbuf=da(19),this.longfact=da($a.SBMAX_l),this.shortfact=da($a.SBMAX_s),this.attackthre=0,this.attackthre_s=0}var br=fr;function xr(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var Sr=xr,ye=P0;ye.System;ye.VbrMode;ye.Float;ye.ShortBlock;ye.Util;ye.Arrays;ye.new_array_n;var Ar=ye.new_byte,yr=ye.new_double,qe=ye.new_float,h1=ye.new_float_n,Ke=ye.new_int,$1=ye.new_int_n;ye.assert;var Mr=ur,pr=St,Rr=br,wr=Sr,Ya=ft(),Q0=ie(),Er=z1;n1.MFSIZE=3*1152+Q0.ENCDELAY-Q0.MDCTDELAY;n1.MAX_HEADER_BUF=256;n1.MAX_BITS_PER_CHANNEL=4095;n1.MAX_BITS_PER_GRANULE=7680;n1.BPC=320;function n1(){var y=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=h1([2,n1.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new Mr,this.ms_ratio=qe(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=Ke(2),this.CurrentStep=Ke(2),this.masking_lower=0,this.bv_scf=Ke(576),this.pseudohalf=Ke(Er.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*n1.BPC+1),this.itime=yr(2),this.sideinfo_len=0,this.sb_sample=h1([2,2,18,Q0.SBLIMIT]),this.amp_filter=qe(32);function O(){this.write_timing=0,this.ptr=0,this.buf=Ar(y)}this.header=new Array(n1.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new pr,this.minval_l=qe(Q0.CBANDS),this.minval_s=qe(Q0.CBANDS),this.nb_1=h1([4,Q0.CBANDS]),this.nb_2=h1([4,Q0.CBANDS]),this.nb_s1=h1([4,Q0.CBANDS]),this.nb_s2=h1([4,Q0.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=qe(4),this.loudness_sq=h1([2,2]),this.loudness_sq_save=qe(2),this.mld_l=qe(Q0.SBMAX_l),this.mld_s=qe(Q0.SBMAX_s),this.bm_l=Ke(Q0.SBMAX_l),this.bo_l=Ke(Q0.SBMAX_l),this.bm_s=Ke(Q0.SBMAX_s),this.bo_s=Ke(Q0.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=$1([Q0.CBANDS,2]),this.s3ind_s=$1([Q0.CBANDS,2]),this.numlines_s=Ke(Q0.CBANDS),this.numlines_l=Ke(Q0.CBANDS),this.rnumlines_l=qe(Q0.CBANDS),this.mld_cb_l=qe(Q0.CBANDS),this.mld_cb_s=qe(Q0.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=qe(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=Ke(2),this.nsPsy=new Rr,this.VBR_seek_table=new wr,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=$1([16,4+1]),this.bitrate_blockType_Hist=$1([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var G=0;G<this.en.length;G++)this.en[G]=new Ya;for(var G=0;G<this.thm.length;G++)this.thm[G]=new Ya;for(var G=0;G<this.header.length;G++)this.header[G]=new O}var J1=n1,Me=P0;Me.System;Me.VbrMode;Me.Float;Me.ShortBlock;Me.Util;Me.Arrays;Me.new_array_n;Me.new_byte;Me.new_double;var d1=Me.new_float;Me.new_float_n;Me.new_int;Me.new_int_n;Me.assert;var m1=ie();function Br(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=d1(m1.SBMAX_l),this.s=d1(m1.SBMAX_s),this.psfb21=d1(m1.PSFB21),this.psfb12=d1(m1.PSFB12),this.cb_l=d1(m1.CBANDS),this.cb_s=d1(m1.CBANDS),this.eql_w=d1(m1.BLKSIZE/2)}var Tr=Br,pe=P0,he=pe.System;pe.VbrMode;pe.Float;pe.ShortBlock;pe.Util;var Pa=pe.Arrays;pe.new_array_n;pe.new_byte;pe.new_double;pe.new_float;pe.new_float_n;pe.new_int;pe.new_int_n;pe.assert;q0.STEPS_per_dB=100;q0.MAX_dB=120;q0.GAIN_NOT_ENOUGH_SAMPLES=-24601;q0.GAIN_ANALYSIS_ERROR=0;q0.GAIN_ANALYSIS_OK=1;q0.INIT_GAIN_ANALYSIS_ERROR=0;q0.INIT_GAIN_ANALYSIS_OK=1;q0.YULE_ORDER=10;q0.MAX_ORDER=q0.YULE_ORDER;q0.MAX_SAMP_FREQ=48e3;q0.RMS_WINDOW_TIME_NUMERATOR=1;q0.RMS_WINDOW_TIME_DENOMINATOR=20;q0.MAX_SAMPLES_PER_WINDOW=q0.MAX_SAMP_FREQ*q0.RMS_WINDOW_TIME_NUMERATOR/q0.RMS_WINDOW_TIME_DENOMINATOR+1;function q0(){var y=64.82;q0.YULE_ORDER;var O=.95;q0.MAX_SAMP_FREQ;var G=q0.RMS_WINDOW_TIME_NUMERATOR,P=q0.RMS_WINDOW_TIME_DENOMINATOR;q0.MAX_SAMPLES_PER_WINDOW;var a0=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],Z=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function Q(S,H,X,Y,D,q){for(;D--!=0;)X[Y]=1e-10+S[H+0]*q[0]-X[Y-1]*q[1]+S[H-1]*q[2]-X[Y-2]*q[3]+S[H-2]*q[4]-X[Y-3]*q[5]+S[H-3]*q[6]-X[Y-4]*q[7]+S[H-4]*q[8]-X[Y-5]*q[9]+S[H-5]*q[10]-X[Y-6]*q[11]+S[H-6]*q[12]-X[Y-7]*q[13]+S[H-7]*q[14]-X[Y-8]*q[15]+S[H-8]*q[16]-X[Y-9]*q[17]+S[H-9]*q[18]-X[Y-10]*q[19]+S[H-10]*q[20],++Y,++H}function U(S,H,X,Y,D,q){for(;D--!=0;)X[Y]=S[H+0]*q[0]-X[Y-1]*q[1]+S[H-1]*q[2]-X[Y-2]*q[3]+S[H-2]*q[4],++Y,++H}function K(S,H){for(var X=0;X<MAX_ORDER;X++)S.linprebuf[X]=S.lstepbuf[X]=S.loutbuf[X]=S.rinprebuf[X]=S.rstepbuf[X]=S.routbuf[X]=0;switch(0|H){case 48e3:S.reqindex=0;break;case 44100:S.reqindex=1;break;case 32e3:S.reqindex=2;break;case 24e3:S.reqindex=3;break;case 22050:S.reqindex=4;break;case 16e3:S.reqindex=5;break;case 12e3:S.reqindex=6;break;case 11025:S.reqindex=7;break;case 8e3:S.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return S.sampleWindow=0|(H*G+P-1)/P,S.lsum=0,S.rsum=0,S.totsamp=0,Pa.ill(S.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(S,H){return K(S,H)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(S.linpre=MAX_ORDER,S.rinpre=MAX_ORDER,S.lstep=MAX_ORDER,S.rstep=MAX_ORDER,S.lout=MAX_ORDER,S.rout=MAX_ORDER,Pa.fill(S.B,0),INIT_GAIN_ANALYSIS_OK)};function R(S){return S*S}this.AnalyzeSamples=function(S,H,X,Y,D,q,T){var _,h,b,e,d,u,x;if(q==0)return GAIN_ANALYSIS_OK;switch(x=0,d=q,T){case 1:Y=H,D=X;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(q<MAX_ORDER?(he.arraycopy(H,X,S.linprebuf,MAX_ORDER,q),he.arraycopy(Y,D,S.rinprebuf,MAX_ORDER,q)):(he.arraycopy(H,X,S.linprebuf,MAX_ORDER,MAX_ORDER),he.arraycopy(Y,D,S.rinprebuf,MAX_ORDER,MAX_ORDER));d>0;){u=d>S.sampleWindow-S.totsamp?S.sampleWindow-S.totsamp:d,x<MAX_ORDER?(_=S.linpre+x,h=S.linprebuf,b=S.rinpre+x,e=S.rinprebuf,u>MAX_ORDER-x&&(u=MAX_ORDER-x)):(_=X+x,h=H,b=D+x,e=Y),Q(h,_,S.lstepbuf,S.lstep+S.totsamp,u,a0[S.reqindex]),Q(e,b,S.rstepbuf,S.rstep+S.totsamp,u,a0[S.reqindex]),U(S.lstepbuf,S.lstep+S.totsamp,S.loutbuf,S.lout+S.totsamp,u,Z[S.reqindex]),U(S.rstepbuf,S.rstep+S.totsamp,S.routbuf,S.rout+S.totsamp,u,Z[S.reqindex]),_=S.lout+S.totsamp,h=S.loutbuf,b=S.rout+S.totsamp,e=S.routbuf;for(var v=u%8;v--!=0;)S.lsum+=R(h[_++]),S.rsum+=R(e[b++]);for(v=u/8;v--!=0;)S.lsum+=R(h[_+0])+R(h[_+1])+R(h[_+2])+R(h[_+3])+R(h[_+4])+R(h[_+5])+R(h[_+6])+R(h[_+7]),_+=8,S.rsum+=R(e[b+0])+R(e[b+1])+R(e[b+2])+R(e[b+3])+R(e[b+4])+R(e[b+5])+R(e[b+6])+R(e[b+7]),b+=8;if(d-=u,x+=u,S.totsamp+=u,S.totsamp==S.sampleWindow){var r=q0.STEPS_per_dB*10*Math.log10((S.lsum+S.rsum)/S.totsamp*.5+1e-37),s=r<=0?0:0|r;s>=S.A.length&&(s=S.A.length-1),S.A[s]++,S.lsum=S.rsum=0,he.arraycopy(S.loutbuf,S.totsamp,S.loutbuf,0,MAX_ORDER),he.arraycopy(S.routbuf,S.totsamp,S.routbuf,0,MAX_ORDER),he.arraycopy(S.lstepbuf,S.totsamp,S.lstepbuf,0,MAX_ORDER),he.arraycopy(S.rstepbuf,S.totsamp,S.rstepbuf,0,MAX_ORDER),S.totsamp=0}if(S.totsamp>S.sampleWindow)return GAIN_ANALYSIS_ERROR}return q<MAX_ORDER?(he.arraycopy(S.linprebuf,q,S.linprebuf,0,MAX_ORDER-q),he.arraycopy(S.rinprebuf,q,S.rinprebuf,0,MAX_ORDER-q),he.arraycopy(H,X,S.linprebuf,MAX_ORDER-q,q),he.arraycopy(Y,D,S.rinprebuf,MAX_ORDER-q,q)):(he.arraycopy(H,X+q-MAX_ORDER,S.linprebuf,0,MAX_ORDER),he.arraycopy(Y,D+q-MAX_ORDER,S.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function j(S,H){var X,Y=0;for(X=0;X<H;X++)Y+=S[X];if(Y==0)return GAIN_NOT_ENOUGH_SAMPLES;var D=0|Math.ceil(Y*(1-O));for(X=H;X-- >0&&!((D-=S[X])<=0););return y-X/q0.STEPS_per_dB}this.GetTitleGain=function(S){for(var H=j(S.A,S.A.length),X=0;X<S.A.length;X++)S.B[X]+=S.A[X],S.A[X]=0;for(var X=0;X<MAX_ORDER;X++)S.linprebuf[X]=S.lstepbuf[X]=S.loutbuf[X]=S.rinprebuf[X]=S.rstepbuf[X]=S.routbuf[X]=0;return S.totsamp=0,S.lsum=S.rsum=0,H}}var At=q0,Re=P0;Re.System;Re.VbrMode;Re.Float;Re.ShortBlock;Re.Util;Re.Arrays;Re.new_array_n;Re.new_byte;Re.new_double;var w1=Re.new_float;Re.new_float_n;var Ua=Re.new_int;Re.new_int_n;Re.assert;var de=At;function Nr(){this.linprebuf=w1(de.MAX_ORDER*2),this.linpre=0,this.lstepbuf=w1(de.MAX_SAMPLES_PER_WINDOW+de.MAX_ORDER),this.lstep=0,this.loutbuf=w1(de.MAX_SAMPLES_PER_WINDOW+de.MAX_ORDER),this.lout=0,this.rinprebuf=w1(de.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=w1(de.MAX_SAMPLES_PER_WINDOW+de.MAX_ORDER),this.rstep=0,this.routbuf=w1(de.MAX_SAMPLES_PER_WINDOW+de.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=Ua(0|de.STEPS_per_dB*de.MAX_dB),this.B=Ua(0|de.STEPS_per_dB*de.MAX_dB)}var Ir=Nr;function Cr(y){this.bits=y}var yt=Cr,we=P0;we.System;we.VbrMode;we.Float;we.ShortBlock;we.Util;we.Arrays;we.new_array_n;we.new_byte;we.new_double;var Ka=we.new_float;we.new_float_n;var Lr=we.new_int;we.new_int_n;var Za=we.assert,kr=yt,Qa=ie(),Vr=z1,Or=J1;function Fr(y){var O=y;this.quantize=O,this.iteration_loop=function(G,P,a0,Z){var Q=G.internal_flags,U=Ka(Vr.SFBMAX),K=Ka(576),R=Lr(2),j=0,S,H=Q.l3_side,X=new kr(j);this.quantize.rv.ResvFrameBegin(G,X),j=X.bits;for(var Y=0;Y<Q.mode_gr;Y++){S=this.quantize.qupvt.on_pe(G,P,R,j,Y,Y),Q.mode_ext==Qa.MPG_MD_MS_LR&&(this.quantize.ms_convert(Q.l3_side,Y),this.quantize.qupvt.reduce_side(R,a0[Y],j,S));for(var D=0;D<Q.channels_out;D++){var q,T,_=H.tt[Y][D];_.block_type!=Qa.SHORT_TYPE?(q=0,T=Q.PSY.mask_adjust-q):(q=0,T=Q.PSY.mask_adjust_short-q),Q.masking_lower=Math.pow(10,T*.1),this.quantize.init_outer_loop(Q,_),this.quantize.init_xrpow(Q,_,K)&&(this.quantize.qupvt.calc_xmin(G,Z[Y][D],_,U),this.quantize.outer_loop(G,_,U,K,D,R[D])),this.quantize.iteration_finish_one(Q,Y,D),Za(_.part2_3_length<=Or.MAX_BITS_PER_CHANNEL),Za(_.part2_3_length<=R[D])}}this.quantize.rv.ResvFrameEnd(Q,j)}}var jr=Fr;function L0(y,O,G,P){this.xlen=y,this.linmax=O,this.table=G,this.hlen=P}var i0={};i0.t1HB=[1,1,1,0];i0.t2HB=[1,2,1,3,1,1,3,2,0];i0.t3HB=[3,2,1,1,1,1,3,2,0];i0.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];i0.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];i0.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];i0.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];i0.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];i0.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];i0.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];i0.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];i0.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];i0.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];i0.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];i0.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];i0.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16];i0.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0];i0.t1l=[1,4,3,5];i0.t2l=[1,4,7,4,5,7,6,7,8];i0.t3l=[2,3,7,4,4,7,6,7,8];i0.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];i0.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];i0.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];i0.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];i0.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];i0.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];i0.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];i0.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];i0.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];i0.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];i0.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];i0.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];i0.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];i0.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4];i0.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4];i0.ht=[new L0(0,0,null,null),new L0(2,0,i0.t1HB,i0.t1l),new L0(3,0,i0.t2HB,i0.t2l),new L0(3,0,i0.t3HB,i0.t3l),new L0(0,0,null,null),new L0(4,0,i0.t5HB,i0.t5l),new L0(4,0,i0.t6HB,i0.t6l),new L0(6,0,i0.t7HB,i0.t7l),new L0(6,0,i0.t8HB,i0.t8l),new L0(6,0,i0.t9HB,i0.t9l),new L0(8,0,i0.t10HB,i0.t10l),new L0(8,0,i0.t11HB,i0.t11l),new L0(8,0,i0.t12HB,i0.t12l),new L0(16,0,i0.t13HB,i0.t13l),new L0(0,0,null,i0.t16_5l),new L0(16,0,i0.t15HB,i0.t15l),new L0(1,1,i0.t16HB,i0.t16l),new L0(2,3,i0.t16HB,i0.t16l),new L0(3,7,i0.t16HB,i0.t16l),new L0(4,15,i0.t16HB,i0.t16l),new L0(6,63,i0.t16HB,i0.t16l),new L0(8,255,i0.t16HB,i0.t16l),new L0(10,1023,i0.t16HB,i0.t16l),new L0(13,8191,i0.t16HB,i0.t16l),new L0(4,15,i0.t24HB,i0.t24l),new L0(5,31,i0.t24HB,i0.t24l),new L0(6,63,i0.t24HB,i0.t24l),new L0(7,127,i0.t24HB,i0.t24l),new L0(8,255,i0.t24HB,i0.t24l),new L0(9,511,i0.t24HB,i0.t24l),new L0(11,2047,i0.t24HB,i0.t24l),new L0(13,8191,i0.t24HB,i0.t24l),new L0(0,0,i0.t32HB,i0.t32l),new L0(0,0,i0.t33HB,i0.t33l)];i0.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];i0.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];i0.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];i0.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];i0.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];i0.scfsi_band=[0,6,11,16,21];var Ea=i0,r1=St,Ee=P0;Ee.System;var f1=Ee.VbrMode,Y1=Ee.Float;Ee.ShortBlock;var ma=Ee.Util;Ee.Arrays;Ee.new_array_n;Ee.new_byte;Ee.new_double;var b1=Ee.new_float;Ee.new_float_n;var Hr=Ee.new_int;Ee.new_int_n;var s1=Ee.assert,te=ie(),Xr=yt,_e=J1;He.Q_MAX=256+1;He.Q_MAX2=116;He.LARGE_BITS=1e5;He.IXMAX_VAL=8206;function He(){var y=null,O=null,G=null;this.setModules=function(_,h,b){y=_,O=h,G=b};function P(_){return s1(0<=_+He.Q_MAX2&&_<He.Q_MAX),S[_+He.Q_MAX2]}this.IPOW20=function(_){return s1(0<=_&&_<He.Q_MAX),H[_]};var a0=2220446049250313e-31,Z=He.IXMAX_VAL,Q=Z+2,U=He.Q_MAX,K=He.Q_MAX2;He.LARGE_BITS;var R=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var j=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=j,this.sfBandIndex=[new r1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new r1([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new r1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new r1([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new r1([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new r1([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new r1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new r1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new r1([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var S=b1(U+K+1),H=b1(U),X=b1(Q),Y=b1(Q);this.adj43=Y;function D(_,h){var b=G.ATHformula(h,_);return b-=R,b=Math.pow(10,b/10+_.ATHlower),b}function q(_){for(var h=_.internal_flags.ATH.l,b=_.internal_flags.ATH.psfb21,e=_.internal_flags.ATH.s,d=_.internal_flags.ATH.psfb12,u=_.internal_flags,x=_.out_samplerate,v=0;v<te.SBMAX_l;v++){var r=u.scalefac_band.l[v],s=u.scalefac_band.l[v+1];h[v]=Y1.MAX_VALUE;for(var o=r;o<s;o++){var n=o*x/1152,a=D(_,n);h[v]=Math.min(h[v],a)}}for(var v=0;v<te.PSFB21;v++){var r=u.scalefac_band.psfb21[v],s=u.scalefac_band.psfb21[v+1];b[v]=Y1.MAX_VALUE;for(var o=r;o<s;o++){var n=o*x/1152,a=D(_,n);b[v]=Math.min(b[v],a)}}for(var v=0;v<te.SBMAX_s;v++){var r=u.scalefac_band.s[v],s=u.scalefac_band.s[v+1];e[v]=Y1.MAX_VALUE;for(var o=r;o<s;o++){var n=o*x/384,a=D(_,n);e[v]=Math.min(e[v],a)}e[v]*=u.scalefac_band.s[v+1]-u.scalefac_band.s[v]}for(var v=0;v<te.PSFB12;v++){var r=u.scalefac_band.psfb12[v],s=u.scalefac_band.psfb12[v+1];d[v]=Y1.MAX_VALUE;for(var o=r;o<s;o++){var n=o*x/384,a=D(_,n);d[v]=Math.min(d[v],a)}d[v]*=u.scalefac_band.s[13]-u.scalefac_band.s[12]}if(_.noATH){for(var v=0;v<te.SBMAX_l;v++)h[v]=1e-20;for(var v=0;v<te.PSFB21;v++)b[v]=1e-20;for(var v=0;v<te.SBMAX_s;v++)e[v]=1e-20;for(var v=0;v<te.PSFB12;v++)d[v]=1e-20}u.ATH.floor=10*Math.log10(D(_,-1))}this.iteration_init=function(_){var h=_.internal_flags,b=h.l3_side,e;if(h.iteration_init_init==0){for(h.iteration_init_init=1,b.main_data_begin=0,q(_),X[0]=0,e=1;e<Q;e++)X[e]=Math.pow(e,4/3);for(e=0;e<Q-1;e++)Y[e]=e+1-Math.pow(.5*(X[e]+X[e+1]),.75);for(Y[e]=.5,e=0;e<U;e++)H[e]=Math.pow(2,(e-210)*-.1875);for(e=0;e<=U+K;e++)S[e]=Math.pow(2,(e-210-K)*.25);y.huffman_init(h);{var d,u,x,v;for(e=_.exp_nspsytune>>2&63,e>=32&&(e-=64),d=Math.pow(10,e/4/10),e=_.exp_nspsytune>>8&63,e>=32&&(e-=64),u=Math.pow(10,e/4/10),e=_.exp_nspsytune>>14&63,e>=32&&(e-=64),x=Math.pow(10,e/4/10),e=_.exp_nspsytune>>20&63,e>=32&&(e-=64),v=x*Math.pow(10,e/4/10),e=0;e<te.SBMAX_l;e++){var r;e<=6?r=d:e<=13?r=u:e<=20?r=x:r=v,h.nsPsy.longfact[e]=r}for(e=0;e<te.SBMAX_s;e++){var r;e<=5?r=d:e<=10?r=u:e<=11?r=x:r=v,h.nsPsy.shortfact[e]=r}}}},this.on_pe=function(_,h,b,e,d,u){var x=_.internal_flags,v=0,r,s=Hr(2),o,n=new Xr(v),a=O.ResvMaxBits(_,e,n,u);v=n.bits;var c=v+a;for(c>_e.MAX_BITS_PER_GRANULE&&(c=_e.MAX_BITS_PER_GRANULE),r=0,o=0;o<x.channels_out;++o)b[o]=Math.min(_e.MAX_BITS_PER_CHANNEL,v/x.channels_out),s[o]=0|b[o]*h[d][o]/700-b[o],s[o]>e*3/4&&(s[o]=e*3/4),s[o]<0&&(s[o]=0),s[o]+b[o]>_e.MAX_BITS_PER_CHANNEL&&(s[o]=Math.max(0,_e.MAX_BITS_PER_CHANNEL-b[o])),r+=s[o];if(r>a)for(o=0;o<x.channels_out;++o)s[o]=a*s[o]/r;for(o=0;o<x.channels_out;++o)b[o]+=s[o],a-=s[o];for(r=0,o=0;o<x.channels_out;++o)r+=b[o];if(r>_e.MAX_BITS_PER_GRANULE){var i=0;for(o=0;o<x.channels_out;++o)b[o]*=_e.MAX_BITS_PER_GRANULE,b[o]/=r,i+=b[o];s1(i<=_e.MAX_BITS_PER_GRANULE)}return c},this.reduce_side=function(_,h,b,e){s1(e<=_e.MAX_BITS_PER_GRANULE),s1(_[0]+_[1]<=_e.MAX_BITS_PER_GRANULE);var d=.33*(.5-h)/.5;d<0&&(d=0),d>.5&&(d=.5);var u=0|d*.5*(_[0]+_[1]);u>_e.MAX_BITS_PER_CHANNEL-_[0]&&(u=_e.MAX_BITS_PER_CHANNEL-_[0]),u<0&&(u=0),_[1]>=125&&(_[1]-u>125?(_[0]<b&&(_[0]+=u),_[1]-=u):(_[0]+=_[1]-125,_[1]=125)),u=_[0]+_[1],u>e&&(_[0]=e*_[0]/u,_[1]=e*_[1]/u),s1(_[0]<=_e.MAX_BITS_PER_CHANNEL),s1(_[1]<=_e.MAX_BITS_PER_CHANNEL),s1(_[0]+_[1]<=_e.MAX_BITS_PER_GRANULE)},this.athAdjust=function(_,h,b){var e=90.30873362,d=94.82444863,u=ma.FAST_LOG10_X(h,10),x=_*_,v=0;return u-=b,x>1e-20&&(v=1+ma.FAST_LOG10_X(x,10/e)),v<0&&(v=0),u*=v,u+=b+e-d,Math.pow(10,.1*u)},this.calc_xmin=function(_,h,b,e){var d=0,u=_.internal_flags,x,v=0,r=0,s=u.ATH,o=b.xr,n=_.VBR==f1.vbr_mtrh?1:0,a=u.masking_lower;for((_.VBR==f1.vbr_mtrh||_.VBR==f1.vbr_mt)&&(a=1),x=0;x<b.psy_lmax;x++){var c,i,C,M,E,t;_.VBR==f1.vbr_rh||_.VBR==f1.vbr_mtrh?i=athAdjust(s.adjust,s.l[x],s.floor):i=s.adjust*s.l[x],E=b.width[x],C=i/E,M=a0,t=E>>1,c=0;do{var l,B;l=o[v]*o[v],c+=l,M+=l<C?l:C,v++,B=o[v]*o[v],c+=B,M+=B<C?B:C,v++}while(--t>0);if(c>i&&r++,x==te.SBPSY_l){var N=i*u.nsPsy.longfact[x];M<N&&(M=N)}if(n!=0&&(i=M),!_.ATHonly){var l0=h.en.l[x];if(l0>0){var N;N=c*h.thm.l[x]*a/l0,n!=0&&(N*=u.nsPsy.longfact[x]),i<N&&(i=N)}}n!=0?e[d++]=i:e[d++]=i*u.nsPsy.longfact[x]}var c0=575;if(b.block_type!=te.SHORT_TYPE)for(var o0=576;o0--!=0&&BitStream.EQ(o[o0],0);)c0=o0;b.max_nonzero_coeff=c0;for(var v0=b.sfb_smin;x<b.psymax;v0++,x+=3){var E,A0,d0;for(_.VBR==f1.vbr_rh||_.VBR==f1.vbr_mtrh?d0=athAdjust(s.adjust,s.s[v0],s.floor):d0=s.adjust*s.s[v0],E=b.width[x],A0=0;A0<3;A0++){var c=0,i,C,M,t=E>>1;C=d0/E,M=a0;do{var l,B;l=o[v]*o[v],c+=l,M+=l<C?l:C,v++,B=o[v]*o[v],c+=B,M+=B<C?B:C,v++}while(--t>0);if(c>d0&&r++,v0==te.SBPSY_s){var N=d0*u.nsPsy.shortfact[v0];M<N&&(M=N)}if(n!=0?i=M:i=d0,!_.ATHonly&&!_.ATHshort){var l0=h.en.s[v0][A0];if(l0>0){var N;N=c*h.thm.s[v0][A0]*a/l0,n!=0&&(N*=u.nsPsy.shortfact[v0]),i<N&&(i=N)}}n!=0?e[d++]=i:e[d++]=i*u.nsPsy.shortfact[v0]}_.useTemporal&&(e[d-3]>e[d-3+1]&&(e[d-3+1]+=(e[d-3]-e[d-3+1])*u.decay),e[d-3+1]>e[d-3+2]&&(e[d-3+2]+=(e[d-3+1]-e[d-3+2])*u.decay))}return r};function T(_){this.s=_}this.calc_noise_core=function(_,h,b,e){var d=0,u=h.s,x=_.l3_enc;if(u>_.count1)for(;b--!=0;){var v;v=_.xr[u],u++,d+=v*v,v=_.xr[u],u++,d+=v*v}else if(u>_.big_values){var r=b1(2);for(r[0]=0,r[1]=e;b--!=0;){var v;v=Math.abs(_.xr[u])-r[x[u]],u++,d+=v*v,v=Math.abs(_.xr[u])-r[x[u]],u++,d+=v*v}}else for(;b--!=0;){var v;v=Math.abs(_.xr[u])-X[x[u]]*e,u++,d+=v*v,v=Math.abs(_.xr[u])-X[x[u]]*e,u++,d+=v*v}return h.s=u,d},this.calc_noise=function(_,h,b,e,d){var u=0,x=0,v,r,s=0,o=0,n=0,a=-20,c=0,i=_.scalefac,C=0;for(e.over_SSD=0,v=0;v<_.psymax;v++){var M=_.global_gain-(i[C++]+(_.preflag!=0?j[v]:0)<<_.scalefac_scale+1)-_.subblock_gain[_.window[v]]*8,E=0;if(d!=null&&d.step[v]==M)E=d.noise[v],c+=_.width[v],b[u++]=E/h[x++],E=d.noise_log[v];else{var t=P(M);if(r=_.width[v]>>1,c+_.width[v]>_.max_nonzero_coeff){var l;l=_.max_nonzero_coeff-c+1,l>0?r=l>>1:r=0}var B=new T(c);E=this.calc_noise_core(_,B,r,t),c=B.s,d!=null&&(d.step[v]=M,d.noise[v]=E),E=b[u++]=E/h[x++],E=ma.FAST_LOG10(Math.max(E,1e-20)),d!=null&&(d.noise_log[v]=E)}if(d!=null&&(d.global_gain=_.global_gain),n+=E,E>0){var N;N=Math.max(0|E*10+.5,1),e.over_SSD+=N*N,s++,o+=E}a=Math.max(a,E)}return e.over_count=s,e.tot_noise=n,e.over_noise=o,e.max_noise=a,s},this.set_pinfo=function(_,h,b,e,d){var u=_.internal_flags,x,v,r,s,o,n=h.scalefac_scale==0?.5:1,a=h.scalefac,c=b1(L3Side.SFBMAX),i=b1(L3Side.SFBMAX),C=new CalcNoiseResult;calc_xmin(_,b,h,c),calc_noise(h,c,i,C,null);var M=0;for(v=h.sfb_lmax,h.block_type!=te.SHORT_TYPE&&h.mixed_block_flag==0&&(v=22),x=0;x<v;x++){var E=u.scalefac_band.l[x],t=u.scalefac_band.l[x+1],l=t-E;for(s=0;M<t;M++)s+=h.xr[M]*h.xr[M];s/=l,o=1e15,u.pinfo.en[e][d][x]=o*s,u.pinfo.xfsf[e][d][x]=o*c[x]*i[x]/l,b.en.l[x]>0&&!_.ATHonly?s=s/b.en.l[x]:s=0,u.pinfo.thr[e][d][x]=o*Math.max(s*b.thm.l[x],u.ATH.l[x]),u.pinfo.LAMEsfb[e][d][x]=0,h.preflag!=0&&x>=11&&(u.pinfo.LAMEsfb[e][d][x]=-n*j[x]),x<te.SBPSY_l&&(s1(a[x]>=0),u.pinfo.LAMEsfb[e][d][x]-=n*a[x])}if(h.block_type==te.SHORT_TYPE)for(v=x,x=h.sfb_smin;x<te.SBMAX_s;x++)for(var E=u.scalefac_band.s[x],t=u.scalefac_band.s[x+1],l=t-E,B=0;B<3;B++){for(s=0,r=E;r<t;r++)s+=h.xr[M]*h.xr[M],M++;s=Math.max(s/l,1e-20),o=1e15,u.pinfo.en_s[e][d][3*x+B]=o*s,u.pinfo.xfsf_s[e][d][3*x+B]=o*c[v]*i[v]/l,b.en.s[x][B]>0?s=s/b.en.s[x][B]:s=0,(_.ATHonly||_.ATHshort)&&(s=0),u.pinfo.thr_s[e][d][3*x+B]=o*Math.max(s*b.thm.s[x][B],u.ATH.s[x]),u.pinfo.LAMEsfb_s[e][d][3*x+B]=-2*h.subblock_gain[B],x<te.SBPSY_s&&(u.pinfo.LAMEsfb_s[e][d][3*x+B]-=n*a[v]),v++}u.pinfo.LAMEqss[e][d]=h.global_gain,u.pinfo.LAMEmainbits[e][d]=h.part2_3_length+h.part2_length,u.pinfo.LAMEsfbits[e][d]=h.part2_length,u.pinfo.over[e][d]=C.over_count,u.pinfo.max_noise[e][d]=C.max_noise*10,u.pinfo.over_noise[e][d]=C.over_noise*10,u.pinfo.tot_noise[e][d]=C.tot_noise*10,u.pinfo.over_SSD[e][d]=C.over_SSD}}var Mt=He,Be=P0,Dr=Be.System;Be.VbrMode;Be.Float;Be.ShortBlock;Be.Util;var Gr=Be.Arrays;Be.new_array_n;Be.new_byte;Be.new_double;Be.new_float;Be.new_float_n;var L1=Be.new_int;Be.new_int_n;var $e=Be.assert,U0=ie(),K0=Ea,qr=wa,x1=Mt;function pa(){var y=null;this.qupvt=null,this.setModules=function(r){this.qupvt=r,y=r};function O(r){this.bits=0|r}var G=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function P(r,s,o,n,a,c){var i=.5946/s;for($e(r>0),r=r>>1;r--!=0;)a[c++]=i>o[n++]?0:1,a[c++]=i>o[n++]?0:1}function a0(r,s,o,n,a,c){$e(r>0),r=r>>1;var i=r%2;for(r=r>>1;r--!=0;){var C,M,E,t,l,B,N,l0;C=o[n++]*s,M=o[n++]*s,l=0|C,E=o[n++]*s,B=0|M,t=o[n++]*s,N=0|E,C+=y.adj43[l],l0=0|t,M+=y.adj43[B],a[c++]=0|C,E+=y.adj43[N],a[c++]=0|M,t+=y.adj43[l0],a[c++]=0|E,a[c++]=0|t}if(i!=0){var C,M,l,B;C=o[n++]*s,M=o[n++]*s,l=0|C,B=0|M,C+=y.adj43[l],M+=y.adj43[B],a[c++]=0|C,a[c++]=0|M}}function Z(r,s,o,n,a){var c,i,C=0,M,E=0,t=0,l=0,B=s,N=0,l0=B,c0=0,o0=r,v0=0;for(M=a!=null&&n.global_gain==a.global_gain,n.block_type==U0.SHORT_TYPE?i=38:i=21,c=0;c<=i;c++){var A0=-1;if((M||n.block_type==U0.NORM_TYPE)&&(A0=n.global_gain-(n.scalefac[c]+(n.preflag!=0?y.pretab[c]:0)<<n.scalefac_scale+1)-n.subblock_gain[n.window[c]]*8),$e(n.width[c]>=0),M&&a.step[c]==A0)E!=0&&(a0(E,o,o0,v0,l0,c0),E=0),t!=0&&(P(t,o,o0,v0,l0,c0),t=0);else{var d0=n.width[c];if(C+n.width[c]>n.max_nonzero_coeff){var _0;_0=n.max_nonzero_coeff-C+1,Gr.fill(s,n.max_nonzero_coeff,576,0),d0=_0,d0<0&&(d0=0),c=i+1}if(E==0&&t==0&&(l0=B,c0=N,o0=r,v0=l),a!=null&&a.sfb_count1>0&&c>=a.sfb_count1&&a.step[c]>0&&A0>=a.step[c]?(E!=0&&(a0(E,o,o0,v0,l0,c0),E=0,l0=B,c0=N,o0=r,v0=l),t+=d0):(t!=0&&(P(t,o,o0,v0,l0,c0),t=0,l0=B,c0=N,o0=r,v0=l),E+=d0),d0<=0){t!=0&&(P(t,o,o0,v0,l0,c0),t=0),E!=0&&(a0(E,o,o0,v0,l0,c0),E=0);break}}c<=i&&(N+=n.width[c],l+=n.width[c],C+=n.width[c])}E!=0&&(a0(E,o,o0,v0,l0,c0),E=0),t!=0&&(P(t,o,o0,v0,l0,c0),t=0)}function Q(r,s,o){var n=0,a=0;do{var c=r[s++],i=r[s++];n<c&&(n=c),a<i&&(a=i)}while(s<o);return n<a&&(n=a),n}function U(r,s,o,n,a,c){var i=K0.ht[n].xlen*65536+K0.ht[a].xlen,C=0,M;do{var E=r[s++],t=r[s++];E!=0&&(E>14&&(E=15,C+=i),E*=16),t!=0&&(t>14&&(t=15,C+=i),E+=t),C+=K0.largetbl[E]}while(s<o);return M=C&65535,C>>=16,C>M&&(C=M,n=a),c.bits+=C,n}function K(r,s,o,n){var a=0,c=K0.ht[1].hlen;do{var i=r[s+0]*2+r[s+1];s+=2,a+=c[i]}while(s<o);return n.bits+=a,1}function R(r,s,o,n,a){var c=0,i,C=K0.ht[n].xlen,M;n==2?M=K0.table23:M=K0.table56;do{var E=r[s+0]*C+r[s+1];s+=2,c+=M[E]}while(s<o);return i=c&65535,c>>=16,c>i&&(c=i,n++),a.bits+=c,n}function j(r,s,o,n,a){var c=0,i=0,C=0,M=K0.ht[n].xlen,E=K0.ht[n].hlen,t=K0.ht[n+1].hlen,l=K0.ht[n+2].hlen;do{var B=r[s+0]*M+r[s+1];s+=2,c+=E[B],i+=t[B],C+=l[B]}while(s<o);var N=n;return c>i&&(c=i,N++),c>C&&(c=C,N=n+2),a.bits+=c,N}var S=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function H(r,s,o,n){var a=Q(r,s,o);switch(a){case 0:return a;case 1:return K(r,s,o,n);case 2:case 3:return R(r,s,o,S[a-1],n);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return j(r,s,o,S[a-1],n);default:if(a>x1.IXMAX_VAL)return n.bits=x1.LARGE_BITS,-1;a-=15;var c;for(c=24;c<32&&!(K0.ht[c].linmax>=a);c++);var i;for(i=c-8;i<24&&!(K0.ht[i].linmax>=a);i++);return U(r,s,o,i,c,n)}}this.noquant_count_bits=function(r,s,o){var n=s.l3_enc,a=Math.min(576,s.max_nonzero_coeff+2>>1<<1);for(o!=null&&(o.sfb_count1=0);a>1&&!(n[a-1]|n[a-2]);a-=2);s.count1=a;for(var c=0,i=0;a>3;a-=4){var C;if(((n[a-1]|n[a-2]|n[a-3]|n[a-4])&2147483647)>1)break;C=((n[a-4]*2+n[a-3])*2+n[a-2])*2+n[a-1],c+=K0.t32l[C],i+=K0.t33l[C]}var M=c;if(s.count1table_select=0,c>i&&(M=i,s.count1table_select=1),s.count1bits=M,s.big_values=a,a==0)return M;if(s.block_type==U0.SHORT_TYPE)c=3*r.scalefac_band.s[3],c>s.big_values&&(c=s.big_values),i=s.big_values;else if(s.block_type==U0.NORM_TYPE){if($e(a<=576),c=s.region0_count=r.bv_scf[a-2],i=s.region1_count=r.bv_scf[a-1],$e(c+i+2<U0.SBPSY_l),i=r.scalefac_band.l[c+i+2],c=r.scalefac_band.l[c+1],i<a){var E=new O(M);s.table_select[2]=H(n,i,a,E),M=E.bits}}else s.region0_count=7,s.region1_count=U0.SBMAX_l-1-7-1,c=r.scalefac_band.l[7+1],i=a,c>i&&(c=i);if(c=Math.min(c,a),i=Math.min(i,a),$e(c>=0),$e(i>=0),0<c){var E=new O(M);s.table_select[0]=H(n,0,c,E),M=E.bits}if(c<i){var E=new O(M);s.table_select[1]=H(n,c,i,E),M=E.bits}if(r.use_best_huffman==2&&(s.part2_3_length=M,best_huffman_divide(r,s),M=s.part2_3_length),o!=null&&s.block_type==U0.NORM_TYPE){for(var t=0;r.scalefac_band.l[t]<s.big_values;)t++;o.sfb_count1=t}return M},this.count_bits=function(r,s,o,n){var a=o.l3_enc,c=x1.IXMAX_VAL/y.IPOW20(o.global_gain);if(o.xrpow_max>c)return x1.LARGE_BITS;if(Z(s,a,y.IPOW20(o.global_gain),o,n),r.substep_shaping&2)for(var i=0,C=o.global_gain+o.scalefac_scale,M=.634521682242439/y.IPOW20(C),E=0;E<o.sfbmax;E++){var t=o.width[E];if($e(t>=0),r.pseudohalf[E]==0)i+=t;else{var l;for(l=i,i+=t;l<i;++l)a[l]=s[l]>=M?a[l]:0}}return this.noquant_count_bits(r,o,n)};function X(r,s,o,n,a,c,i){for(var C=s.big_values,M=0;M<=7+15;M++)n[M]=x1.LARGE_BITS;for(var M=0;M<16;M++){var E=r.scalefac_band.l[M+1];if(E>=C)break;var t=0,l=new O(t),B=H(o,0,E,l);t=l.bits;for(var N=0;N<8;N++){var l0=r.scalefac_band.l[M+N+2];if(l0>=C)break;var c0=t;l=new O(c0);var o0=H(o,E,l0,l);c0=l.bits,n[M+N]>c0&&(n[M+N]=c0,a[M+N]=M,c[M+N]=B,i[M+N]=o0)}}}function Y(r,s,o,n,a,c,i,C){for(var M=s.big_values,E=2;E<U0.SBMAX_l+1;E++){var t=r.scalefac_band.l[E];if(t>=M)break;var l=a[E-2]+s.count1bits;if(o.part2_3_length<=l)break;var B=new O(l),N=H(n,t,M,B);l=B.bits,!(o.part2_3_length<=l)&&(o.assign(s),o.part2_3_length=l,o.region0_count=c[E-2],o.region1_count=E-2-c[E-2],o.table_select[0]=i[E-2],o.table_select[1]=C[E-2],o.table_select[2]=N)}}this.best_huffman_divide=function(r,s){var o=new qr,n=s.l3_enc,a=L1(7+15+1),c=L1(7+15+1),i=L1(7+15+1),C=L1(7+15+1);if(!(s.block_type==U0.SHORT_TYPE&&r.mode_gr==1)){o.assign(s),s.block_type==U0.NORM_TYPE&&(X(r,s,n,a,c,i,C),Y(r,o,s,n,a,c,i,C));var M=o.big_values;if(!(M==0||(n[M-2]|n[M-1])>1)&&(M=s.count1+2,!(M>576))){o.assign(s),o.count1=M;var E=0,t=0;for($e(M<=576);M>o.big_values;M-=4){var l=((n[M-4]*2+n[M-3])*2+n[M-2])*2+n[M-1];E+=K0.t32l[l],t+=K0.t33l[l]}if(o.big_values=M,o.count1table_select=0,E>t&&(E=t,o.count1table_select=1),o.count1bits=E,o.block_type==U0.NORM_TYPE)Y(r,o,s,n,a,c,i,C);else{if(o.part2_3_length=E,E=r.scalefac_band.l[7+1],E>M&&(E=M),E>0){var B=new O(o.part2_3_length);o.table_select[0]=H(n,0,E,B),o.part2_3_length=B.bits}if(M>E){var B=new O(o.part2_3_length);o.table_select[1]=H(n,E,M,B),o.part2_3_length=B.bits}s.part2_3_length>o.part2_3_length&&s.assign(o)}}}};var D=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],q=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],T=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],_=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];pa.slen1_tab=T,pa.slen2_tab=_;function h(r,s){for(var o,n=s.tt[1][r],a=s.tt[0][r],c=0;c<K0.scfsi_band.length-1;c++){for(o=K0.scfsi_band[c];o<K0.scfsi_band[c+1]&&!(a.scalefac[o]!=n.scalefac[o]&&n.scalefac[o]>=0);o++);if(o==K0.scfsi_band[c+1]){for(o=K0.scfsi_band[c];o<K0.scfsi_band[c+1];o++)n.scalefac[o]=-1;s.scfsi[r][c]=1}}var i=0,C=0;for(o=0;o<11;o++)n.scalefac[o]!=-1&&(C++,i<n.scalefac[o]&&(i=n.scalefac[o]));for(var M=0,E=0;o<U0.SBPSY_l;o++)n.scalefac[o]!=-1&&(E++,M<n.scalefac[o]&&(M=n.scalefac[o]));for(var c=0;c<16;c++)if(i<D[c]&&M<q[c]){var t=T[c]*C+_[c]*E;n.part2_length>t&&(n.part2_length=t,n.scalefac_compress=c)}}this.best_scalefac_store=function(r,s,o,n){var a=n.tt[s][o],c,i,C,M,E=0;for(C=0,c=0;c<a.sfbmax;c++){var t=a.width[c];for($e(t>=0),C+=t,M=-t;M<0&&a.l3_enc[M+C]==0;M++);M==0&&(a.scalefac[c]=E=-2)}if(a.scalefac_scale==0&&a.preflag==0){var l=0;for(c=0;c<a.sfbmax;c++)a.scalefac[c]>0&&(l|=a.scalefac[c]);if(!(l&1)&&l!=0){for(c=0;c<a.sfbmax;c++)a.scalefac[c]>0&&(a.scalefac[c]>>=1);a.scalefac_scale=E=1}}if(a.preflag==0&&a.block_type!=U0.SHORT_TYPE&&r.mode_gr==2){for(c=11;c<U0.SBPSY_l&&!(a.scalefac[c]<y.pretab[c]&&a.scalefac[c]!=-2);c++);if(c==U0.SBPSY_l){for(c=11;c<U0.SBPSY_l;c++)a.scalefac[c]>0&&(a.scalefac[c]-=y.pretab[c]);a.preflag=E=1}}for(i=0;i<4;i++)n.scfsi[o][i]=0;for(r.mode_gr==2&&s==1&&n.tt[0][o].block_type!=U0.SHORT_TYPE&&n.tt[1][o].block_type!=U0.SHORT_TYPE&&(h(o,n),E=0),c=0;c<a.sfbmax;c++)a.scalefac[c]==-2&&(a.scalefac[c]=0);E!=0&&(r.mode_gr==2?this.scale_bitcount(a):this.scale_bitcount_lsf(r,a))};function b(r,s){for(var o=0;o<s;++o)if(r[o]<0)return!1;return!0}var e=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],d=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],u=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(r){var s,o,n=0,a=0,c,i=r.scalefac;if($e(b(i,r.sfbmax)),r.block_type==U0.SHORT_TYPE)c=e,r.mixed_block_flag!=0&&(c=d);else if(c=u,r.preflag==0){for(o=11;o<U0.SBPSY_l&&!(i[o]<y.pretab[o]);o++);if(o==U0.SBPSY_l)for(r.preflag=1,o=11;o<U0.SBPSY_l;o++)i[o]-=y.pretab[o]}for(o=0;o<r.sfbdivide;o++)n<i[o]&&(n=i[o]);for(;o<r.sfbmax;o++)a<i[o]&&(a=i[o]);for(r.part2_length=x1.LARGE_BITS,s=0;s<16;s++)n<D[s]&&a<q[s]&&r.part2_length>c[s]&&(r.part2_length=c[s],r.scalefac_compress=s);return r.part2_length==x1.LARGE_BITS};var x=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(r,s){var o,n,a,c,i,C,M,E,t=L1(4),l=s.scalefac;for(s.preflag!=0?o=2:o=0,M=0;M<4;M++)t[M]=0;if(s.block_type==U0.SHORT_TYPE){n=1;var B=y.nr_of_sfb_block[o][n];for(E=0,a=0;a<4;a++)for(c=B[a]/3,M=0;M<c;M++,E++)for(i=0;i<3;i++)l[E*3+i]>t[a]&&(t[a]=l[E*3+i])}else{n=0;var B=y.nr_of_sfb_block[o][n];for(E=0,a=0;a<4;a++)for(c=B[a],M=0;M<c;M++,E++)l[E]>t[a]&&(t[a]=l[E])}for(C=!1,a=0;a<4;a++)t[a]>x[o][a]&&(C=!0);if(!C){var N,l0,c0,o0;for(s.sfb_partition_table=y.nr_of_sfb_block[o][n],a=0;a<4;a++)s.slen[a]=v[t[a]];switch(N=s.slen[0],l0=s.slen[1],c0=s.slen[2],o0=s.slen[3],o){case 0:s.scalefac_compress=(N*5+l0<<4)+(c0<<2)+o0;break;case 1:s.scalefac_compress=400+(N*5+l0<<2)+c0;break;case 2:s.scalefac_compress=500+N*3+l0;break;default:Dr.err.printf(`intensity stereo not implemented yet
`);break}}if(!C)for($e(s.sfb_partition_table!=null),s.part2_length=0,a=0;a<4;a++)s.part2_length+=s.slen[a]*s.sfb_partition_table[a];return C};var v=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(r){for(var s=2;s<=576;s+=2){for(var o=0,n;r.scalefac_band.l[++o]<s;);for(n=G[o][0];r.scalefac_band.l[n+1]>s;)n--;for(n<0&&(n=G[o][0]),r.bv_scf[s-2]=n,n=G[o][1];r.scalefac_band.l[n+r.bv_scf[s-2]+2]>s;)n--;n<0&&(n=G[o][1]),r.bv_scf[s-1]=n}}}var pt=pa,Te=P0,Je=Te.System;Te.VbrMode;Te.Float;Te.ShortBlock;Te.Util;var $r=Te.Arrays;Te.new_array_n;var Yr=Te.new_byte;Te.new_double;Te.new_float;var Pr=Te.new_float_n,Ur=Te.new_int;Te.new_int_n;var w0=Te.assert,Wa=pt,fa=Ea,P1=ie(),S1=J1;Z1.EQ=function(y,O){return Math.abs(y)>Math.abs(O)?Math.abs(y-O)<=Math.abs(y)*1e-6:Math.abs(y-O)<=Math.abs(O)*1e-6};Z1.NEQ=function(y,O){return!Z1.EQ(y,O)};function Z1(){var y=this,O=32773,G=32,P=null,a0=null,Z=null,Q=null;this.setModules=function(v,r,s,o){P=v,a0=r,Z=s,Q=o};var U=null,K=0,R=0,j=0;this.getframebits=function(v){var r=v.internal_flags,s;r.bitrate_index!=0?s=fa.bitrate_table[v.version][r.bitrate_index]:s=v.brate,w0(8<=s&&s<=640);var o=0|(v.version+1)*72e3*s/v.out_samplerate+r.padding;return 8*o};function S(v){Je.arraycopy(v.header[v.w_ptr].buf,0,U,R,v.sideinfo_len),R+=v.sideinfo_len,K+=v.sideinfo_len*8,v.w_ptr=v.w_ptr+1&S1.MAX_HEADER_BUF-1}function H(v,r,s){for(w0(s<G-2);s>0;){var o;j==0&&(j=8,R++,w0(R<Lame.LAME_MAXMP3BUFFER),w0(v.header[v.w_ptr].write_timing>=K),v.header[v.w_ptr].write_timing==K&&S(v),U[R]=0),o=Math.min(s,j),s-=o,j-=o,w0(s<G),w0(j<G),U[R]|=r>>s<<j,K+=o}}function X(v,r,s){for(w0(s<G-2);s>0;){var o;j==0&&(j=8,R++,w0(R<Lame.LAME_MAXMP3BUFFER),U[R]=0),o=Math.min(s,j),s-=o,j-=o,w0(s<G),w0(j<G),U[R]|=r>>s<<j,K+=o}}function Y(v,r){var s=v.internal_flags,o;if(w0(r>=0),r>=8&&(H(s,76,8),r-=8),r>=8&&(H(s,65,8),r-=8),r>=8&&(H(s,77,8),r-=8),r>=8&&(H(s,69,8),r-=8),r>=32){var n=Z.getLameShortVersion();if(r>=32)for(o=0;o<n.length&&r>=8;++o)r-=8,H(s,n.charAt(o),8)}for(;r>=1;r-=1)H(s,s.ancillary_flag,1),s.ancillary_flag^=v.disable_reservoir?0:1;w0(r==0)}function D(v,r,s){for(var o=v.header[v.h_ptr].ptr;s>0;){var n=Math.min(s,8-(o&7));s-=n,w0(s<G),v.header[v.h_ptr].buf[o>>3]|=r>>s<<8-(o&7)-n,o+=n}v.header[v.h_ptr].ptr=o}function q(v,r){v<<=8;for(var s=0;s<8;s++)v<<=1,r<<=1,(r^v)&65536&&(r^=O);return r}this.CRC_writeheader=function(v,r){var s=65535;s=q(r[2]&255,s),s=q(r[3]&255,s);for(var o=6;o<v.sideinfo_len;o++)s=q(r[o]&255,s);r[4]=byte(s>>8),r[5]=byte(s&255)};function T(v,r){var s=v.internal_flags,o,n,a;if(o=s.l3_side,s.header[s.h_ptr].ptr=0,$r.fill(s.header[s.h_ptr].buf,0,s.sideinfo_len,0),v.out_samplerate<16e3?D(s,4094,12):D(s,4095,12),D(s,v.version,1),D(s,4-3,2),D(s,v.error_protection?0:1,1),D(s,s.bitrate_index,4),D(s,s.samplerate_index,2),D(s,s.padding,1),D(s,v.extension,1),D(s,v.mode.ordinal(),2),D(s,s.mode_ext,2),D(s,v.copyright,1),D(s,v.original,1),D(s,v.emphasis,2),v.error_protection&&D(s,0,16),v.version==1){for(w0(o.main_data_begin>=0),D(s,o.main_data_begin,9),s.channels_out==2?D(s,o.private_bits,3):D(s,o.private_bits,5),a=0;a<s.channels_out;a++){var c;for(c=0;c<4;c++)D(s,o.scfsi[a][c],1)}for(n=0;n<2;n++)for(a=0;a<s.channels_out;a++){var i=o.tt[n][a];D(s,i.part2_3_length+i.part2_length,12),D(s,i.big_values/2,9),D(s,i.global_gain,8),D(s,i.scalefac_compress,4),i.block_type!=P1.NORM_TYPE?(D(s,1,1),D(s,i.block_type,2),D(s,i.mixed_block_flag,1),i.table_select[0]==14&&(i.table_select[0]=16),D(s,i.table_select[0],5),i.table_select[1]==14&&(i.table_select[1]=16),D(s,i.table_select[1],5),D(s,i.subblock_gain[0],3),D(s,i.subblock_gain[1],3),D(s,i.subblock_gain[2],3)):(D(s,0,1),i.table_select[0]==14&&(i.table_select[0]=16),D(s,i.table_select[0],5),i.table_select[1]==14&&(i.table_select[1]=16),D(s,i.table_select[1],5),i.table_select[2]==14&&(i.table_select[2]=16),D(s,i.table_select[2],5),w0(0<=i.region0_count&&i.region0_count<16),w0(0<=i.region1_count&&i.region1_count<8),D(s,i.region0_count,4),D(s,i.region1_count,3)),D(s,i.preflag,1),D(s,i.scalefac_scale,1),D(s,i.count1table_select,1)}}else for(w0(o.main_data_begin>=0),D(s,o.main_data_begin,8),D(s,o.private_bits,s.channels_out),n=0,a=0;a<s.channels_out;a++){var i=o.tt[n][a];D(s,i.part2_3_length+i.part2_length,12),D(s,i.big_values/2,9),D(s,i.global_gain,8),D(s,i.scalefac_compress,9),i.block_type!=P1.NORM_TYPE?(D(s,1,1),D(s,i.block_type,2),D(s,i.mixed_block_flag,1),i.table_select[0]==14&&(i.table_select[0]=16),D(s,i.table_select[0],5),i.table_select[1]==14&&(i.table_select[1]=16),D(s,i.table_select[1],5),D(s,i.subblock_gain[0],3),D(s,i.subblock_gain[1],3),D(s,i.subblock_gain[2],3)):(D(s,0,1),i.table_select[0]==14&&(i.table_select[0]=16),D(s,i.table_select[0],5),i.table_select[1]==14&&(i.table_select[1]=16),D(s,i.table_select[1],5),i.table_select[2]==14&&(i.table_select[2]=16),D(s,i.table_select[2],5),w0(0<=i.region0_count&&i.region0_count<16),w0(0<=i.region1_count&&i.region1_count<8),D(s,i.region0_count,4),D(s,i.region1_count,3)),D(s,i.scalefac_scale,1),D(s,i.count1table_select,1)}v.error_protection&&CRC_writeheader(s,s.header[s.h_ptr].buf);{var C=s.h_ptr;w0(s.header[C].ptr==s.sideinfo_len*8),s.h_ptr=C+1&S1.MAX_HEADER_BUF-1,s.header[s.h_ptr].write_timing=s.header[C].write_timing+r,s.h_ptr==s.w_ptr&&Je.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function _(v,r){var s=fa.ht[r.count1table_select+32],o,n=0,a=r.big_values,c=r.big_values;for(w0(r.count1table_select<2),o=(r.count1-r.big_values)/4;o>0;--o){var i=0,C=0,M;M=r.l3_enc[a+0],M!=0&&(C+=8,r.xr[c+0]<0&&i++,w0(M<=1)),M=r.l3_enc[a+1],M!=0&&(C+=4,i*=2,r.xr[c+1]<0&&i++,w0(M<=1)),M=r.l3_enc[a+2],M!=0&&(C+=2,i*=2,r.xr[c+2]<0&&i++,w0(M<=1)),M=r.l3_enc[a+3],M!=0&&(C++,i*=2,r.xr[c+3]<0&&i++,w0(M<=1)),a+=4,c+=4,H(v,i+s.table[C],s.hlen[C]),n+=s.hlen[C]}return n}function h(v,r,s,o,n){var a=fa.ht[r],c=0;if(w0(r<32),r==0)return c;for(var i=s;i<o;i+=2){var C=0,M=0,E=a.xlen,t=a.xlen,l=0,B=n.l3_enc[i],N=n.l3_enc[i+1];if(B!=0&&(n.xr[i]<0&&l++,C--),r>15){if(B>14){var l0=B-15;w0(l0<=a.linmax),l|=l0<<1,M=E,B=15}if(N>14){var c0=N-15;w0(c0<=a.linmax),l<<=E,l|=c0,M+=E,N=15}t=16}N!=0&&(l<<=1,n.xr[i+1]<0&&l++,C--),w0((B|N)<16),B=B*t+N,M-=C,C+=a.hlen[B],w0(C<=G),w0(M<=G),H(v,a.table[B],C),H(v,l,M),c+=C+M}return c}function b(v,r){var s=3*v.scalefac_band.s[3];s>r.big_values&&(s=r.big_values);var o=h(v,r.table_select[0],0,s,r);return o+=h(v,r.table_select[1],s,r.big_values,r),o}function e(v,r){var s,o,n,a;s=r.big_values,w0(0<=s&&s<=576);var c=r.region0_count+1;return w0(0<=c),w0(c<v.scalefac_band.l.length),n=v.scalefac_band.l[c],c+=r.region1_count+1,w0(0<=c),w0(c<v.scalefac_band.l.length),a=v.scalefac_band.l[c],n>s&&(n=s),a>s&&(a=s),o=h(v,r.table_select[0],0,n,r),o+=h(v,r.table_select[1],n,a,r),o+=h(v,r.table_select[2],a,s,r),o}function d(v){var r,s,o,n,a=0,c=v.internal_flags,i=c.l3_side;if(v.version==1)for(r=0;r<2;r++)for(s=0;s<c.channels_out;s++){var C=i.tt[r][s],M=Wa.slen1_tab[C.scalefac_compress],E=Wa.slen2_tab[C.scalefac_compress];for(n=0,o=0;o<C.sfbdivide;o++)C.scalefac[o]!=-1&&(H(c,C.scalefac[o],M),n+=M);for(;o<C.sfbmax;o++)C.scalefac[o]!=-1&&(H(c,C.scalefac[o],E),n+=E);w0(n==C.part2_length),C.block_type==P1.SHORT_TYPE?n+=b(c,C):n+=e(c,C),n+=_(c,C),w0(n==C.part2_3_length+C.part2_length),a+=n}else for(r=0,s=0;s<c.channels_out;s++){var C=i.tt[r][s],t,l,B=0;if(w0(C.sfb_partition_table!=null),n=0,o=0,l=0,C.block_type==P1.SHORT_TYPE){for(;l<4;l++){var N=C.sfb_partition_table[l]/3,l0=C.slen[l];for(t=0;t<N;t++,o++)H(c,Math.max(C.scalefac[o*3+0],0),l0),H(c,Math.max(C.scalefac[o*3+1],0),l0),H(c,Math.max(C.scalefac[o*3+2],0),l0),B+=3*l0}n+=b(c,C)}else{for(;l<4;l++){var N=C.sfb_partition_table[l],l0=C.slen[l];for(t=0;t<N;t++,o++)H(c,Math.max(C.scalefac[o],0),l0),B+=l0}n+=e(c,C)}n+=_(c,C),w0(n==C.part2_3_length),w0(B==C.part2_length),a+=B+n}return a}function u(){this.total=0}function x(v,r){var s=v.internal_flags,o,n,a,c,i;return i=s.w_ptr,c=s.h_ptr-1,c==-1&&(c=S1.MAX_HEADER_BUF-1),o=s.header[c].write_timing-K,r.total=o,o>=0&&(n=1+c-i,c<i&&(n=1+c-i+S1.MAX_HEADER_BUF),o-=n*8*s.sideinfo_len),a=y.getframebits(v),o+=a,r.total+=a,r.total%8!=0?r.total=1+r.total/8:r.total=r.total/8,r.total+=R+1,o<0&&Je.err.println(`strange error flushing buffer ... 
`),o}this.flush_bitstream=function(v){var r=v.internal_flags,s,o,n=r.h_ptr-1;if(n==-1&&(n=S1.MAX_HEADER_BUF-1),s=r.l3_side,!((o=x(v,new u))<0)){if(Y(v,o),w0(r.header[n].write_timing+this.getframebits(v)==K),r.ResvSize=0,s.main_data_begin=0,r.findReplayGain){var a=P.GetTitleGain(r.rgdata);w0(NEQ(a,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),r.RadioGain=Math.floor(a*10+.5)|0}r.findPeakSample&&(r.noclipGainChange=Math.ceil(Math.log10(r.PeakSample/32767)*20*10)|0,r.noclipGainChange>0&&(EQ(v.scale,1)||EQ(v.scale,0))?r.noclipScale=Math.floor(32767/r.PeakSample*100)/100:r.noclipScale=-1)}},this.add_dummy_byte=function(v,r,s){for(var o=v.internal_flags,n;s-- >0;)for(X(o,r,8),n=0;n<S1.MAX_HEADER_BUF;++n)o.header[n].write_timing+=8},this.format_bitstream=function(v){var r=v.internal_flags,s;s=r.l3_side;var o=this.getframebits(v);Y(v,s.resvDrain_pre),T(v,o);var n=8*r.sideinfo_len;if(n+=d(v),Y(v,s.resvDrain_post),n+=s.resvDrain_post,s.main_data_begin+=(o-n)/8,x(v,new u)!=r.ResvSize&&Je.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),s.main_data_begin*8!=r.ResvSize&&(Je.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*s.main_data_begin,r.ResvSize,s.resvDrain_post,s.resvDrain_pre,8*r.sideinfo_len,n-s.resvDrain_post-8*r.sideinfo_len,n,n%8,o),Je.err.println("This is a fatal error.  It has several possible causes:"),Je.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),Je.err.println(" 9%%  Your system is overclocked"),Je.err.println(" 1%%  bug in LAME encoding library"),r.ResvSize=s.main_data_begin*8),w0(K%8==0),K>1e9){var a;for(a=0;a<S1.MAX_HEADER_BUF;++a)r.header[a].write_timing-=K;K=0}return 0},this.copy_buffer=function(v,r,s,o,n){var a=R+1;if(a<=0)return 0;if(o!=0&&a>o)return-1;if(Je.arraycopy(U,0,r,s,a),R=-1,j=0,n!=0){var c=Ur(1);if(c[0]=v.nMusicCRC,Q.updateMusicCRC(c,r,s,a),v.nMusicCRC=c[0],a>0&&(v.VBR_seek_table.nBytesWritten+=a),v.decode_on_the_fly){for(var i=Pr([2,1152]),C=a,M=-1,E;M!=0;)if(M=a0.hip_decode1_unclipped(v.hip,r,s,C,i[0],i[1]),C=0,M==-1&&(M=0),M>0){if(w0(M<=1152),v.findPeakSample){for(E=0;E<M;E++)i[0][E]>v.PeakSample?v.PeakSample=i[0][E]:-i[0][E]>v.PeakSample&&(v.PeakSample=-i[0][E]);if(v.channels_out>1)for(E=0;E<M;E++)i[1][E]>v.PeakSample?v.PeakSample=i[1][E]:-i[1][E]>v.PeakSample&&(v.PeakSample=-i[1][E])}if(v.findReplayGain&&P.AnalyzeSamples(v.rgdata,i[0],0,i[1],0,M,v.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return a},this.init_bit_stream_w=function(v){U=Yr(Lame.LAME_MAXMP3BUFFER),v.h_ptr=v.w_ptr=0,v.header[v.h_ptr].write_timing=0,R=-1,j=0,K=0}}var Rt=Z1,oe=P0,Kr=oe.System,H0=oe.VbrMode;oe.Float;var ba=oe.ShortBlock;oe.Util;oe.Arrays;oe.new_array_n;oe.new_byte;oe.new_double;var A1=oe.new_float;oe.new_float_n;oe.new_int;var za=oe.new_int_n,Zr=oe.new_short_n,je=oe.assert,xa=rr,Qr=ir,k1=J1,Wr=Tr,zr=Ir,Jr=jr,y1=Rt,ge=Ea,Z0=ie();function ee(){var y=this,O=128*1024;ee.V9=410,ee.V8=420,ee.V7=430,ee.V6=440,ee.V5=450,ee.V4=460,ee.V3=470,ee.V2=480,ee.V1=490,ee.V0=500,ee.R3MIX=1e3,ee.STANDARD=1001,ee.EXTREME=1002,ee.INSANE=1003,ee.STANDARD_FAST=1004,ee.EXTREME_FAST=1005,ee.MEDIUM=1006,ee.MEDIUM_FAST=1007;var G=16384+O;ee.LAME_MAXMP3BUFFER=G;var P,a0,Z,Q,U,K=new xa,R,j,S;this.enc=new Z0,this.setModules=function(t,l,B,N,l0,c0,o0,v0,A0){P=t,a0=l,Z=B,Q=N,U=l0,R=c0,j=v0,S=A0,this.enc.setModules(a0,K,Q,R)};function H(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=A1(Z0.SBMAX_l),this.bo_s_weight=A1(Z0.SBMAX_s)}function X(){this.lowerlimit=0}function Y(t,l){this.lowpass=l}var D=4294479419;function q(t){var l;return t.class_id=D,l=t.internal_flags=new k1,t.mode=MPEGMode.NOT_SET,t.original=1,t.in_samplerate=44100,t.num_channels=2,t.num_samples=-1,t.bWriteVbrTag=!0,t.quality=-1,t.short_blocks=null,l.subblock_gain=-1,t.lowpassfreq=0,t.highpassfreq=0,t.lowpasswidth=-1,t.highpasswidth=-1,t.VBR=H0.vbr_off,t.VBR_q=4,t.ATHcurve=-1,t.VBR_mean_bitrate_kbps=128,t.VBR_min_bitrate_kbps=0,t.VBR_max_bitrate_kbps=0,t.VBR_hard_min=0,l.VBR_min_bitrate=1,l.VBR_max_bitrate=13,t.quant_comp=-1,t.quant_comp_short=-1,t.msfix=-1,l.resample_ratio=1,l.OldValue[0]=180,l.OldValue[1]=180,l.CurrentStep[0]=4,l.CurrentStep[1]=4,l.masking_lower=1,l.nsPsy.attackthre=-1,l.nsPsy.attackthre_s=-1,t.scale=-1,t.athaa_type=-1,t.ATHtype=-1,t.athaa_loudapprox=-1,t.athaa_sensitivity=0,t.useTemporal=null,t.interChRatio=-1,l.mf_samples_to_encode=Z0.ENCDELAY+Z0.POSTDELAY,t.encoder_padding=0,l.mf_size=Z0.ENCDELAY-Z0.MDCTDELAY,t.findReplayGain=!1,t.decode_on_the_fly=!1,l.decode_on_the_fly=!1,l.findReplayGain=!1,l.findPeakSample=!1,l.RadioGain=0,l.AudiophileGain=0,l.noclipGainChange=0,l.noclipScale=-1,t.preset=0,t.write_id3tag_automatic=!0,0}this.lame_init=function(){var t=new Qr;return q(t),t.lame_allocated_gfp=1,t};function T(t){return t>1?0:t<=0?1:Math.cos(Math.PI/2*t)}this.nearestBitrateFullIndex=function(t){var l=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],B=0,N=0,l0=0,c0=0;c0=l[16],l0=16,N=l[16],B=16;for(var o0=0;o0<16;o0++)if(Math.max(t,l[o0+1])!=t){c0=l[o0+1],l0=o0+1,N=l[o0],B=o0;break}return c0-t>t-N?B:l0};function _(t,l){var B=44100;return l>=48e3?B=48e3:l>=44100?B=44100:l>=32e3?B=32e3:l>=24e3?B=24e3:l>=22050?B=22050:l>=16e3?B=16e3:l>=12e3?B=12e3:l>=11025?B=11025:l>=8e3&&(B=8e3),t==-1?B:(t<=15960&&(B=44100),t<=15250&&(B=32e3),t<=11220&&(B=24e3),t<=9970&&(B=22050),t<=7230&&(B=16e3),t<=5420&&(B=12e3),t<=4510&&(B=11025),t<=3970&&(B=8e3),l<B?l>44100?48e3:l>32e3?44100:l>24e3?32e3:l>22050?24e3:l>16e3?22050:l>12e3?16e3:l>11025?12e3:l>8e3?11025:8e3:B)}function h(t,l){switch(t){case 44100:return l.version=1,0;case 48e3:return l.version=1,1;case 32e3:return l.version=1,2;case 22050:return l.version=0,0;case 24e3:return l.version=0,1;case 16e3:return l.version=0,2;case 11025:return l.version=0,0;case 12e3:return l.version=0,1;case 8e3:return l.version=0,2;default:return l.version=0,-1}}function b(t,l,B){B<16e3&&(l=2);for(var N=ge.bitrate_table[l][1],l0=2;l0<=14;l0++)ge.bitrate_table[l][l0]>0&&Math.abs(ge.bitrate_table[l][l0]-t)<Math.abs(N-t)&&(N=ge.bitrate_table[l][l0]);return N}function e(t,l,B){B<16e3&&(l=2);for(var N=0;N<=14;N++)if(ge.bitrate_table[l][N]>0&&ge.bitrate_table[l][N]==t)return N;return-1}function d(t,l){var B=[new Y(8,2e3),new Y(16,3700),new Y(24,3900),new Y(32,5500),new Y(40,7e3),new Y(48,7500),new Y(56,1e4),new Y(64,11e3),new Y(80,13500),new Y(96,15100),new Y(112,15600),new Y(128,17e3),new Y(160,17500),new Y(192,18600),new Y(224,19400),new Y(256,19700),new Y(320,20500)],N=y.nearestBitrateFullIndex(l);t.lowerlimit=B[N].lowpass}function u(t){var l=t.internal_flags,B=32,N=-1;if(l.lowpass1>0){for(var l0=999,c0=0;c0<=31;c0++){var o0=c0/31;o0>=l.lowpass2&&(B=Math.min(B,c0)),l.lowpass1<o0&&o0<l.lowpass2&&(l0=Math.min(l0,c0))}l0==999?l.lowpass1=(B-.75)/31:l.lowpass1=(l0-.75)/31,l.lowpass2=B/31}if(l.highpass2>0&&l.highpass2<.9*(.75/31)&&(l.highpass1=0,l.highpass2=0,Kr.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),l.highpass2>0){for(var v0=-1,c0=0;c0<=31;c0++){var o0=c0/31;o0<=l.highpass1&&(N=Math.max(N,c0)),l.highpass1<o0&&o0<l.highpass2&&(v0=Math.max(v0,c0))}l.highpass1=N/31,v0==-1?l.highpass2=(N+.75)/31:l.highpass2=(v0+.75)/31}for(var c0=0;c0<32;c0++){var A0,d0,o0=c0/31;l.highpass2>l.highpass1?A0=T((l.highpass2-o0)/(l.highpass2-l.highpass1+1e-20)):A0=1,l.lowpass2>l.lowpass1?d0=T((o0-l.lowpass1)/(l.lowpass2-l.lowpass1+1e-20)):d0=1,l.amp_filter[c0]=A0*d0}}function x(t){var l=t.internal_flags;switch(t.quality){default:case 9:l.psymodel=0,l.noise_shaping=0,l.noise_shaping_amp=0,l.noise_shaping_stop=0,l.use_best_huffman=0,l.full_outer_loop=0;break;case 8:t.quality=7;case 7:l.psymodel=1,l.noise_shaping=0,l.noise_shaping_amp=0,l.noise_shaping_stop=0,l.use_best_huffman=0,l.full_outer_loop=0;break;case 6:l.psymodel=1,l.noise_shaping==0&&(l.noise_shaping=1),l.noise_shaping_amp=0,l.noise_shaping_stop=0,l.subblock_gain==-1&&(l.subblock_gain=1),l.use_best_huffman=0,l.full_outer_loop=0;break;case 5:l.psymodel=1,l.noise_shaping==0&&(l.noise_shaping=1),l.noise_shaping_amp=0,l.noise_shaping_stop=0,l.subblock_gain==-1&&(l.subblock_gain=1),l.use_best_huffman=0,l.full_outer_loop=0;break;case 4:l.psymodel=1,l.noise_shaping==0&&(l.noise_shaping=1),l.noise_shaping_amp=0,l.noise_shaping_stop=0,l.subblock_gain==-1&&(l.subblock_gain=1),l.use_best_huffman=1,l.full_outer_loop=0;break;case 3:l.psymodel=1,l.noise_shaping==0&&(l.noise_shaping=1),l.noise_shaping_amp=1,l.noise_shaping_stop=1,l.subblock_gain==-1&&(l.subblock_gain=1),l.use_best_huffman=1,l.full_outer_loop=0;break;case 2:l.psymodel=1,l.noise_shaping==0&&(l.noise_shaping=1),l.substep_shaping==0&&(l.substep_shaping=2),l.noise_shaping_amp=1,l.noise_shaping_stop=1,l.subblock_gain==-1&&(l.subblock_gain=1),l.use_best_huffman=1,l.full_outer_loop=0;break;case 1:l.psymodel=1,l.noise_shaping==0&&(l.noise_shaping=1),l.substep_shaping==0&&(l.substep_shaping=2),l.noise_shaping_amp=2,l.noise_shaping_stop=1,l.subblock_gain==-1&&(l.subblock_gain=1),l.use_best_huffman=1,l.full_outer_loop=0;break;case 0:l.psymodel=1,l.noise_shaping==0&&(l.noise_shaping=1),l.substep_shaping==0&&(l.substep_shaping=2),l.noise_shaping_amp=2,l.noise_shaping_stop=1,l.subblock_gain==-1&&(l.subblock_gain=1),l.use_best_huffman=1,l.full_outer_loop=0;break}}function v(t){var l=t.internal_flags;t.frameNum=0,t.write_id3tag_automatic&&j.id3tag_write_v2(t),l.bitrate_stereoMode_Hist=za([16,4+1]),l.bitrate_blockType_Hist=za([16,4+1+1]),l.PeakSample=0,t.bWriteVbrTag&&R.InitVbrTag(t)}this.lame_init_params=function(t){var l=t.internal_flags;if(l.Class_ID=0,l.ATH==null&&(l.ATH=new Wr),l.PSY==null&&(l.PSY=new H),l.rgdata==null&&(l.rgdata=new zr),l.channels_in=t.num_channels,l.channels_in==1&&(t.mode=MPEGMode.MONO),l.channels_out=t.mode==MPEGMode.MONO?1:2,l.mode_ext=Z0.MPG_MD_MS_LR,t.mode==MPEGMode.MONO&&(t.force_ms=!1),t.VBR==H0.vbr_off&&t.VBR_mean_bitrate_kbps!=128&&t.brate==0&&(t.brate=t.VBR_mean_bitrate_kbps),t.VBR==H0.vbr_off||t.VBR==H0.vbr_mtrh||t.VBR==H0.vbr_mt||(t.free_format=!1),t.VBR==H0.vbr_off&&t.brate==0&&y1.EQ(t.compression_ratio,0)&&(t.compression_ratio=11.025),t.VBR==H0.vbr_off&&t.compression_ratio>0&&(t.out_samplerate==0&&(t.out_samplerate=map2MP3Frequency(int(.97*t.in_samplerate))),t.brate=0|t.out_samplerate*16*l.channels_out/(1e3*t.compression_ratio),l.samplerate_index=h(t.out_samplerate,t),t.free_format||(t.brate=b(t.brate,t.version,t.out_samplerate))),t.out_samplerate!=0&&(t.out_samplerate<16e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,64)):t.out_samplerate<32e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,160)):(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,32),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,320))),t.lowpassfreq==0){var B=16e3;switch(t.VBR){case H0.vbr_off:{var N=new X;d(N,t.brate),B=N.lowerlimit;break}case H0.vbr_abr:{var N=new X;d(N,t.VBR_mean_bitrate_kbps),B=N.lowerlimit;break}case H0.vbr_rh:{var l0=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=t.VBR_q&&t.VBR_q<=9){var c0=l0[t.VBR_q],o0=l0[t.VBR_q+1],v0=t.VBR_q_frac;B=linear_int(c0,o0,v0)}else B=19500;break}default:{var l0=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=t.VBR_q&&t.VBR_q<=9){var c0=l0[t.VBR_q],o0=l0[t.VBR_q+1],v0=t.VBR_q_frac;B=linear_int(c0,o0,v0)}else B=19500}}t.mode==MPEGMode.MONO&&(t.VBR==H0.vbr_off||t.VBR==H0.vbr_abr)&&(B*=1.5),t.lowpassfreq=B|0}if(t.out_samplerate==0&&(2*t.lowpassfreq>t.in_samplerate&&(t.lowpassfreq=t.in_samplerate/2),t.out_samplerate=_(t.lowpassfreq|0,t.in_samplerate)),t.lowpassfreq=Math.min(20500,t.lowpassfreq),t.lowpassfreq=Math.min(t.out_samplerate/2,t.lowpassfreq),t.VBR==H0.vbr_off&&(t.compression_ratio=t.out_samplerate*16*l.channels_out/(1e3*t.brate)),t.VBR==H0.vbr_abr&&(t.compression_ratio=t.out_samplerate*16*l.channels_out/(1e3*t.VBR_mean_bitrate_kbps)),t.bWriteVbrTag||(t.findReplayGain=!1,t.decode_on_the_fly=!1,l.findPeakSample=!1),l.findReplayGain=t.findReplayGain,l.decode_on_the_fly=t.decode_on_the_fly,l.decode_on_the_fly&&(l.findPeakSample=!0),l.findReplayGain&&P.InitGainAnalysis(l.rgdata,t.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return t.internal_flags=null,-6;switch(l.decode_on_the_fly&&!t.decode_only&&(l.hip!=null&&S.hip_decode_exit(l.hip),l.hip=S.hip_decode_init()),l.mode_gr=t.out_samplerate<=24e3?1:2,t.framesize=576*l.mode_gr,t.encoder_delay=Z0.ENCDELAY,l.resample_ratio=t.in_samplerate/t.out_samplerate,t.VBR){case H0.vbr_mt:case H0.vbr_rh:case H0.vbr_mtrh:{var A0=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];t.compression_ratio=A0[t.VBR_q]}break;case H0.vbr_abr:t.compression_ratio=t.out_samplerate*16*l.channels_out/(1e3*t.VBR_mean_bitrate_kbps);break;default:t.compression_ratio=t.out_samplerate*16*l.channels_out/(1e3*t.brate);break}if(t.mode==MPEGMode.NOT_SET&&(t.mode=MPEGMode.JOINT_STEREO),t.highpassfreq>0?(l.highpass1=2*t.highpassfreq,t.highpasswidth>=0?l.highpass2=2*(t.highpassfreq+t.highpasswidth):l.highpass2=(1+0)*2*t.highpassfreq,l.highpass1/=t.out_samplerate,l.highpass2/=t.out_samplerate):(l.highpass1=0,l.highpass2=0),t.lowpassfreq>0?(l.lowpass2=2*t.lowpassfreq,t.lowpasswidth>=0?(l.lowpass1=2*(t.lowpassfreq-t.lowpasswidth),l.lowpass1<0&&(l.lowpass1=0)):l.lowpass1=(1-0)*2*t.lowpassfreq,l.lowpass1/=t.out_samplerate,l.lowpass2/=t.out_samplerate):(l.lowpass1=0,l.lowpass2=0),u(t),l.samplerate_index=h(t.out_samplerate,t),l.samplerate_index<0)return t.internal_flags=null,-1;if(t.VBR==H0.vbr_off){if(t.free_format)l.bitrate_index=0;else if(t.brate=b(t.brate,t.version,t.out_samplerate),l.bitrate_index=e(t.brate,t.version,t.out_samplerate),l.bitrate_index<=0)return t.internal_flags=null,-1}else l.bitrate_index=1;t.analysis&&(t.bWriteVbrTag=!1),l.pinfo!=null&&(t.bWriteVbrTag=!1),a0.init_bit_stream_w(l);for(var d0=l.samplerate_index+3*t.version+6*(t.out_samplerate<16e3?1:0),_0=0;_0<Z0.SBMAX_l+1;_0++)l.scalefac_band.l[_0]=Q.sfBandIndex[d0].l[_0];for(var _0=0;_0<Z0.PSFB21+1;_0++){var T0=(l.scalefac_band.l[22]-l.scalefac_band.l[21])/Z0.PSFB21,F0=l.scalefac_band.l[21]+_0*T0;l.scalefac_band.psfb21[_0]=F0}l.scalefac_band.psfb21[Z0.PSFB21]=576;for(var _0=0;_0<Z0.SBMAX_s+1;_0++)l.scalefac_band.s[_0]=Q.sfBandIndex[d0].s[_0];for(var _0=0;_0<Z0.PSFB12+1;_0++){var T0=(l.scalefac_band.s[13]-l.scalefac_band.s[12])/Z0.PSFB12,F0=l.scalefac_band.s[12]+_0*T0;l.scalefac_band.psfb12[_0]=F0}l.scalefac_band.psfb12[Z0.PSFB12]=192,t.version==1?l.sideinfo_len=l.channels_out==1?4+17:4+32:l.sideinfo_len=l.channels_out==1?4+9:4+17,t.error_protection&&(l.sideinfo_len+=2),v(t),l.Class_ID=D;{var p0;for(p0=0;p0<19;p0++)l.nsPsy.pefirbuf[p0]=700*l.mode_gr*l.channels_out;t.ATHtype==-1&&(t.ATHtype=4)}switch(je(t.VBR_q<=9),je(t.VBR_q>=0),t.VBR){case H0.vbr_mt:t.VBR=H0.vbr_mtrh;case H0.vbr_mtrh:{t.useTemporal==null&&(t.useTemporal=!1),Z.apply_preset(t,500-t.VBR_q*10,0),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),t.quality<5&&(t.quality=0),t.quality>5&&(t.quality=5),l.PSY.mask_adjust=t.maskingadjust,l.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?l.sfb21_extra=!1:l.sfb21_extra=t.out_samplerate>44e3,l.iteration_loop=new VBRNewIterationLoop(U);break}case H0.vbr_rh:{Z.apply_preset(t,500-t.VBR_q*10,0),l.PSY.mask_adjust=t.maskingadjust,l.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?l.sfb21_extra=!1:l.sfb21_extra=t.out_samplerate>44e3,t.quality>6&&(t.quality=6),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),l.iteration_loop=new VBROldIterationLoop(U);break}default:{var I0;l.sfb21_extra=!1,t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),I0=t.VBR,I0==H0.vbr_off&&(t.VBR_mean_bitrate_kbps=t.brate),Z.apply_preset(t,t.VBR_mean_bitrate_kbps,0),t.VBR=I0,l.PSY.mask_adjust=t.maskingadjust,l.PSY.mask_adjust_short=t.maskingadjust_short,I0==H0.vbr_off?l.iteration_loop=new Jr(U):l.iteration_loop=new ABRIterationLoop(U);break}}if(je(t.scale>=0),t.VBR!=H0.vbr_off){if(l.VBR_min_bitrate=1,l.VBR_max_bitrate=14,t.out_samplerate<16e3&&(l.VBR_max_bitrate=8),t.VBR_min_bitrate_kbps!=0&&(t.VBR_min_bitrate_kbps=b(t.VBR_min_bitrate_kbps,t.version,t.out_samplerate),l.VBR_min_bitrate=e(t.VBR_min_bitrate_kbps,t.version,t.out_samplerate),l.VBR_min_bitrate<0)||t.VBR_max_bitrate_kbps!=0&&(t.VBR_max_bitrate_kbps=b(t.VBR_max_bitrate_kbps,t.version,t.out_samplerate),l.VBR_max_bitrate=e(t.VBR_max_bitrate_kbps,t.version,t.out_samplerate),l.VBR_max_bitrate<0))return-1;t.VBR_min_bitrate_kbps=ge.bitrate_table[t.version][l.VBR_min_bitrate],t.VBR_max_bitrate_kbps=ge.bitrate_table[t.version][l.VBR_max_bitrate],t.VBR_mean_bitrate_kbps=Math.min(ge.bitrate_table[t.version][l.VBR_max_bitrate],t.VBR_mean_bitrate_kbps),t.VBR_mean_bitrate_kbps=Math.max(ge.bitrate_table[t.version][l.VBR_min_bitrate],t.VBR_mean_bitrate_kbps)}return t.tune&&(l.PSY.mask_adjust+=t.tune_value_a,l.PSY.mask_adjust_short+=t.tune_value_a),x(t),je(t.scale>=0),t.athaa_type<0?l.ATH.useAdjust=3:l.ATH.useAdjust=t.athaa_type,l.ATH.aaSensitivityP=Math.pow(10,t.athaa_sensitivity/-10),t.short_blocks==null&&(t.short_blocks=ba.short_block_allowed),t.short_blocks==ba.short_block_allowed&&(t.mode==MPEGMode.JOINT_STEREO||t.mode==MPEGMode.STEREO)&&(t.short_blocks=ba.short_block_coupled),t.quant_comp<0&&(t.quant_comp=1),t.quant_comp_short<0&&(t.quant_comp_short=0),t.msfix<0&&(t.msfix=0),t.exp_nspsytune=t.exp_nspsytune|1,t.internal_flags.nsPsy.attackthre<0&&(t.internal_flags.nsPsy.attackthre=xa.NSATTACKTHRE),t.internal_flags.nsPsy.attackthre_s<0&&(t.internal_flags.nsPsy.attackthre_s=xa.NSATTACKTHRE_S),je(t.scale>=0),t.scale<0&&(t.scale=1),t.ATHtype<0&&(t.ATHtype=4),t.ATHcurve<0&&(t.ATHcurve=4),t.athaa_loudapprox<0&&(t.athaa_loudapprox=2),t.interChRatio<0&&(t.interChRatio=0),t.useTemporal==null&&(t.useTemporal=!0),l.slot_lag=l.frac_SpF=0,t.VBR==H0.vbr_off&&(l.slot_lag=l.frac_SpF=(t.version+1)*72e3*t.brate%t.out_samplerate|0),Q.iteration_init(t),K.psymodel_init(t),je(t.scale>=0),0};function r(t,l){(t.in_buffer_0==null||t.in_buffer_nsamples<l)&&(t.in_buffer_0=A1(l),t.in_buffer_1=A1(l),t.in_buffer_nsamples=l)}this.lame_encode_flush=function(t,l,B,N){var l0=t.internal_flags,c0=Zr([2,1152]),o0=0,v0,A0,d0,_0,T0=l0.mf_samples_to_encode-Z0.POSTDELAY,F0=s(t);if(l0.mf_samples_to_encode<1)return 0;for(v0=0,t.in_samplerate!=t.out_samplerate&&(T0+=16*t.out_samplerate/t.in_samplerate),d0=t.framesize-T0%t.framesize,d0<576&&(d0+=t.framesize),t.encoder_padding=d0,_0=(T0+d0)/t.framesize;_0>0&&o0>=0;){var p0=F0-l0.mf_size,I0=t.frameNum;p0*=t.in_samplerate,p0/=t.out_samplerate,p0>1152&&(p0=1152),p0<1&&(p0=1),A0=N-v0,N==0&&(A0=0),o0=this.lame_encode_buffer(t,c0[0],c0[1],p0,l,B,A0),B+=o0,v0+=o0,_0-=I0!=t.frameNum?1:0}if(l0.mf_samples_to_encode=0,o0<0||(A0=N-v0,N==0&&(A0=0),a0.flush_bitstream(t),o0=a0.copy_buffer(l0,l,B,A0,1),o0<0))return o0;if(B+=o0,v0+=o0,A0=N-v0,N==0&&(A0=0),t.write_id3tag_automatic){if(j.id3tag_write_v1(t),o0=a0.copy_buffer(l0,l,B,A0,0),o0<0)return o0;v0+=o0}return v0},this.lame_encode_buffer=function(t,l,B,N,l0,c0,o0){var v0=t.internal_flags,A0=[null,null];if(v0.Class_ID!=D)return-3;if(N==0)return 0;r(v0,N),A0[0]=v0.in_buffer_0,A0[1]=v0.in_buffer_1;for(var d0=0;d0<N;d0++)A0[0][d0]=l[d0],v0.channels_in>1&&(A0[1][d0]=B[d0]);return o(t,A0[0],A0[1],N,l0,c0,o0)};function s(t){var l=Z0.BLKSIZE+t.framesize-Z0.FFTOFFSET;return l=Math.max(l,512+t.framesize-32),je(k1.MFSIZE>=l),l}function o(t,l,B,N,l0,c0,o0){var v0=t.internal_flags,A0=0,d0,_0,T0,F0,p0,I0=[null,null],N0=[null,null];if(v0.Class_ID!=D)return-3;if(N==0)return 0;if(p0=a0.copy_buffer(v0,l0,c0,o0,0),p0<0)return p0;if(c0+=p0,A0+=p0,N0[0]=l,N0[1]=B,y1.NEQ(t.scale,0)&&y1.NEQ(t.scale,1))for(_0=0;_0<N;++_0)N0[0][_0]*=t.scale,v0.channels_out==2&&(N0[1][_0]*=t.scale);if(y1.NEQ(t.scale_left,0)&&y1.NEQ(t.scale_left,1))for(_0=0;_0<N;++_0)N0[0][_0]*=t.scale_left;if(y1.NEQ(t.scale_right,0)&&y1.NEQ(t.scale_right,1))for(_0=0;_0<N;++_0)N0[1][_0]*=t.scale_right;if(t.num_channels==2&&v0.channels_out==1)for(_0=0;_0<N;++_0)N0[0][_0]=.5*(N0[0][_0]+N0[1][_0]),N0[1][_0]=0;F0=s(t),I0[0]=v0.mfbuf[0],I0[1]=v0.mfbuf[1];for(var D0=0;N>0;){var W0=[null,null],De=0,le=0;W0[0]=N0[0],W0[1]=N0[1];var se=new a;if(E(t,I0,W0,D0,N,se),De=se.n_in,le=se.n_out,v0.findReplayGain&&!v0.decode_on_the_fly&&P.AnalyzeSamples(v0.rgdata,I0[0],v0.mf_size,I0[1],v0.mf_size,le,v0.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(N-=De,D0+=De,v0.channels_out==2,v0.mf_size+=le,je(v0.mf_size<=k1.MFSIZE),v0.mf_samples_to_encode<1&&(v0.mf_samples_to_encode=Z0.ENCDELAY+Z0.POSTDELAY),v0.mf_samples_to_encode+=le,v0.mf_size>=F0){var ke=o0-A0;if(o0==0&&(ke=0),d0=n(t,I0[0],I0[1],l0,c0,ke),d0<0)return d0;for(c0+=d0,A0+=d0,v0.mf_size-=t.framesize,v0.mf_samples_to_encode-=t.framesize,T0=0;T0<v0.channels_out;T0++)for(_0=0;_0<v0.mf_size;_0++)I0[T0][_0]=I0[T0][_0+t.framesize]}}return je(N==0),A0}function n(t,l,B,N,l0,c0){var o0=y.enc.lame_encode_mp3_frame(t,l,B,N,l0,c0);return t.frameNum++,o0}function a(){this.n_in=0,this.n_out=0}function c(){this.num_used=0}function i(t,l){return l!=0?i(l,t%l):t}function C(t,l,B){var N=Math.PI*l;t/=B,t<0&&(t=0),t>1&&(t=1);var l0=t-.5,c0=.42-.5*Math.cos(2*t*Math.PI)+.08*Math.cos(4*t*Math.PI);return Math.abs(l0)<1e-9?N/Math.PI:c0*Math.sin(B*N*l0)/(Math.PI*B*l0)}function M(t,l,B,N,l0,c0,o0,v0,A0){var d0=t.internal_flags,_0,T0=0,F0,p0=t.out_samplerate/i(t.out_samplerate,t.in_samplerate);p0>k1.BPC&&(p0=k1.BPC);var I0=Math.abs(d0.resample_ratio-Math.floor(.5+d0.resample_ratio))<1e-4?1:0,N0=1/d0.resample_ratio;N0>1&&(N0=1);var D0=31;D0%2==0&&--D0,D0+=I0;var W0=D0+1;if(d0.fill_buffer_resample_init==0){for(d0.inbuf_old[0]=A1(W0),d0.inbuf_old[1]=A1(W0),_0=0;_0<=2*p0;++_0)d0.blackfilt[_0]=A1(W0);for(d0.itime[0]=0,d0.itime[1]=0,T0=0;T0<=2*p0;T0++){var De=0,le=(T0-p0)/(2*p0);for(_0=0;_0<=D0;_0++)De+=d0.blackfilt[T0][_0]=C(_0-le,N0,D0);for(_0=0;_0<=D0;_0++)d0.blackfilt[T0][_0]/=De}d0.fill_buffer_resample_init=1}var se=d0.inbuf_old[A0];for(F0=0;F0<N;F0++){var ke,a1;if(ke=F0*d0.resample_ratio,T0=0|Math.floor(ke-d0.itime[A0]),D0+T0-D0/2>=o0)break;var le=ke-d0.itime[A0]-(T0+.5*(D0%2));je(Math.abs(le)<=.501),a1=0|Math.floor(le*2*p0+p0+.5);var We=0;for(_0=0;_0<=D0;++_0){var re=0|_0+T0-D0/2,t1;je(re<o0),je(re+W0>=0),t1=re<0?se[W0+re]:l0[c0+re],We+=t1*d0.blackfilt[a1][_0]}l[B+F0]=We}if(v0.num_used=Math.min(o0,D0+T0-D0/2),d0.itime[A0]+=v0.num_used-F0*d0.resample_ratio,v0.num_used>=W0)for(_0=0;_0<W0;_0++)se[_0]=l0[c0+v0.num_used+_0-W0];else{var J=W0-v0.num_used;for(_0=0;_0<J;++_0)se[_0]=se[_0+v0.num_used];for(T0=0;_0<W0;++_0,++T0)se[_0]=l0[c0+T0];je(T0==v0.num_used)}return F0}function E(t,l,B,N,l0,c0){var o0=t.internal_flags;if(o0.resample_ratio<.9999||o0.resample_ratio>1.0001)for(var v0=0;v0<o0.channels_out;v0++){var A0=new c;c0.n_out=M(t,l[v0],o0.mf_size,t.framesize,B[v0],N,l0,A0,v0),c0.n_in=A0.num_used}else{c0.n_out=Math.min(t.framesize,l0),c0.n_in=c0.n_out;for(var d0=0;d0<c0.n_out;++d0)l[0][o0.mf_size+d0]=B[0][N+d0],o0.channels_out==2&&(l[1][o0.mf_size+d0]=B[1][N+d0])}}}var gr=ee,Ne=P0;Ne.System;var e1=Ne.VbrMode;Ne.Float;Ne.ShortBlock;Ne.Util;Ne.Arrays;Ne.new_array_n;Ne.new_byte;Ne.new_double;Ne.new_float;Ne.new_float_n;Ne.new_int;Ne.new_int_n;Ne.assert;function es(){function y(R,j,S,H,X,Y,D,q,T,_,h,b,e,d,u){this.vbr_q=R,this.quant_comp=j,this.quant_comp_s=S,this.expY=H,this.st_lrm=X,this.st_s=Y,this.masking_adj=D,this.masking_adj_short=q,this.ath_lower=T,this.ath_curve=_,this.ath_sensitivity=h,this.interch=b,this.safejoint=e,this.sfb21mod=d,this.msfix=u}function O(R,j,S,H,X,Y,D,q,T,_,h,b,e,d){this.quant_comp=j,this.quant_comp_s=S,this.safejoint=H,this.nsmsfix=X,this.st_lrm=Y,this.st_s=D,this.nsbass=q,this.scale=T,this.masking_adj=_,this.ath_lower=h,this.ath_curve=b,this.interch=e,this.sfscale=d}var G;this.setModules=function(R){G=R};var P=[new y(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new y(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new y(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new y(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new y(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new y(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new y(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new y(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new y(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new y(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new y(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],a0=[new y(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new y(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new y(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new y(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new y(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new y(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new y(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new y(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new y(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new y(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new y(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function Z(R,j,S){var H=R.VBR==e1.vbr_rh?P:a0,X=R.VBR_q_frac,Y=H[j],D=H[j+1],q=Y;Y.st_lrm=Y.st_lrm+X*(D.st_lrm-Y.st_lrm),Y.st_s=Y.st_s+X*(D.st_s-Y.st_s),Y.masking_adj=Y.masking_adj+X*(D.masking_adj-Y.masking_adj),Y.masking_adj_short=Y.masking_adj_short+X*(D.masking_adj_short-Y.masking_adj_short),Y.ath_lower=Y.ath_lower+X*(D.ath_lower-Y.ath_lower),Y.ath_curve=Y.ath_curve+X*(D.ath_curve-Y.ath_curve),Y.ath_sensitivity=Y.ath_sensitivity+X*(D.ath_sensitivity-Y.ath_sensitivity),Y.interch=Y.interch+X*(D.interch-Y.interch),Y.msfix=Y.msfix+X*(D.msfix-Y.msfix),K(R,q.vbr_q),S!=0?R.quant_comp=q.quant_comp:Math.abs(R.quant_comp- -1)>0||(R.quant_comp=q.quant_comp),S!=0?R.quant_comp_short=q.quant_comp_s:Math.abs(R.quant_comp_short- -1)>0||(R.quant_comp_short=q.quant_comp_s),q.expY!=0&&(R.experimentalY=q.expY!=0),S!=0?R.internal_flags.nsPsy.attackthre=q.st_lrm:Math.abs(R.internal_flags.nsPsy.attackthre- -1)>0||(R.internal_flags.nsPsy.attackthre=q.st_lrm),S!=0?R.internal_flags.nsPsy.attackthre_s=q.st_s:Math.abs(R.internal_flags.nsPsy.attackthre_s- -1)>0||(R.internal_flags.nsPsy.attackthre_s=q.st_s),S!=0?R.maskingadjust=q.masking_adj:Math.abs(R.maskingadjust-0)>0||(R.maskingadjust=q.masking_adj),S!=0?R.maskingadjust_short=q.masking_adj_short:Math.abs(R.maskingadjust_short-0)>0||(R.maskingadjust_short=q.masking_adj_short),S!=0?R.ATHlower=-q.ath_lower/10:Math.abs(-R.ATHlower*10-0)>0||(R.ATHlower=-q.ath_lower/10),S!=0?R.ATHcurve=q.ath_curve:Math.abs(R.ATHcurve- -1)>0||(R.ATHcurve=q.ath_curve),S!=0?R.athaa_sensitivity=q.ath_sensitivity:Math.abs(R.athaa_sensitivity- -1)>0||(R.athaa_sensitivity=q.ath_sensitivity),q.interch>0&&(S!=0?R.interChRatio=q.interch:Math.abs(R.interChRatio- -1)>0||(R.interChRatio=q.interch)),q.safejoint>0&&(R.exp_nspsytune=R.exp_nspsytune|q.safejoint),q.sfb21mod>0&&(R.exp_nspsytune=R.exp_nspsytune|q.sfb21mod<<20),S!=0?R.msfix=q.msfix:Math.abs(R.msfix- -1)>0||(R.msfix=q.msfix),S==0&&(R.VBR_q=j,R.VBR_q_frac=X)}var Q=[new O(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new O(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new O(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new O(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new O(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new O(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new O(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new O(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new O(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new O(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new O(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new O(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new O(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new O(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new O(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new O(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new O(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function U(R,j,S){var H=j,X=G.nearestBitrateFullIndex(j);if(R.VBR=e1.vbr_abr,R.VBR_mean_bitrate_kbps=H,R.VBR_mean_bitrate_kbps=Math.min(R.VBR_mean_bitrate_kbps,320),R.VBR_mean_bitrate_kbps=Math.max(R.VBR_mean_bitrate_kbps,8),R.brate=R.VBR_mean_bitrate_kbps,R.VBR_mean_bitrate_kbps>320&&(R.disable_reservoir=!0),Q[X].safejoint>0&&(R.exp_nspsytune=R.exp_nspsytune|2),Q[X].sfscale>0&&(R.internal_flags.noise_shaping=2),Math.abs(Q[X].nsbass)>0){var Y=int(Q[X].nsbass*4);Y<0&&(Y+=64),R.exp_nspsytune=R.exp_nspsytune|Y<<2}return S!=0?R.quant_comp=Q[X].quant_comp:Math.abs(R.quant_comp- -1)>0||(R.quant_comp=Q[X].quant_comp),S!=0?R.quant_comp_short=Q[X].quant_comp_s:Math.abs(R.quant_comp_short- -1)>0||(R.quant_comp_short=Q[X].quant_comp_s),S!=0?R.msfix=Q[X].nsmsfix:Math.abs(R.msfix- -1)>0||(R.msfix=Q[X].nsmsfix),S!=0?R.internal_flags.nsPsy.attackthre=Q[X].st_lrm:Math.abs(R.internal_flags.nsPsy.attackthre- -1)>0||(R.internal_flags.nsPsy.attackthre=Q[X].st_lrm),S!=0?R.internal_flags.nsPsy.attackthre_s=Q[X].st_s:Math.abs(R.internal_flags.nsPsy.attackthre_s- -1)>0||(R.internal_flags.nsPsy.attackthre_s=Q[X].st_s),S!=0?R.scale=Q[X].scale:Math.abs(R.scale- -1)>0||(R.scale=Q[X].scale),S!=0?R.maskingadjust=Q[X].masking_adj:Math.abs(R.maskingadjust-0)>0||(R.maskingadjust=Q[X].masking_adj),Q[X].masking_adj>0?S!=0?R.maskingadjust_short=Q[X].masking_adj*.9:Math.abs(R.maskingadjust_short-0)>0||(R.maskingadjust_short=Q[X].masking_adj*.9):S!=0?R.maskingadjust_short=Q[X].masking_adj*1.1:Math.abs(R.maskingadjust_short-0)>0||(R.maskingadjust_short=Q[X].masking_adj*1.1),S!=0?R.ATHlower=-Q[X].ath_lower/10:Math.abs(-R.ATHlower*10-0)>0||(R.ATHlower=-Q[X].ath_lower/10),S!=0?R.ATHcurve=Q[X].ath_curve:Math.abs(R.ATHcurve- -1)>0||(R.ATHcurve=Q[X].ath_curve),S!=0?R.interChRatio=Q[X].interch:Math.abs(R.interChRatio- -1)>0||(R.interChRatio=Q[X].interch),j}this.apply_preset=function(R,j,S){switch(j){case Lame.R3MIX:{j=Lame.V3,R.VBR=e1.vbr_mtrh;break}case Lame.MEDIUM:{j=Lame.V4,R.VBR=e1.vbr_rh;break}case Lame.MEDIUM_FAST:{j=Lame.V4,R.VBR=e1.vbr_mtrh;break}case Lame.STANDARD:{j=Lame.V2,R.VBR=e1.vbr_rh;break}case Lame.STANDARD_FAST:{j=Lame.V2,R.VBR=e1.vbr_mtrh;break}case Lame.EXTREME:{j=Lame.V0,R.VBR=e1.vbr_rh;break}case Lame.EXTREME_FAST:{j=Lame.V0,R.VBR=e1.vbr_mtrh;break}case Lame.INSANE:return j=320,R.preset=j,U(R,j,S),R.VBR=e1.vbr_off,j}switch(R.preset=j,j){case Lame.V9:return Z(R,9,S),j;case Lame.V8:return Z(R,8,S),j;case Lame.V7:return Z(R,7,S),j;case Lame.V6:return Z(R,6,S),j;case Lame.V5:return Z(R,5,S),j;case Lame.V4:return Z(R,4,S),j;case Lame.V3:return Z(R,3,S),j;case Lame.V2:return Z(R,2,S),j;case Lame.V1:return Z(R,1,S),j;case Lame.V0:return Z(R,0,S),j}return 8<=j&&j<=320?U(R,j,S):(R.preset=0,j)};function K(R,j){var S=0;return 0>j&&(S=-1,j=0),9<j&&(S=-1,j=9),R.VBR_q=j,R.VBR_q_frac=0,S}}var as=es;function ts(){this.setModules=function(y,O){}}var rs=ts;function ss(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var ns=ss,Ba=P0,Ja=Ba.new_float,is=Ba.new_int;Ba.assert;function ls(){this.global_gain=0,this.sfb_count1=0,this.step=is(39),this.noise=Ja(39),this.noise_log=Ja(39)}var _s=ls,Ie=P0,l1=Ie.System,ga=Ie.VbrMode;Ie.Float;Ie.ShortBlock;var Sa=Ie.Util,E1=Ie.Arrays;Ie.new_array_n;Ie.new_byte;Ie.new_double;var V1=Ie.new_float;Ie.new_float_n;Ie.new_int;Ie.new_int_n;var Ye=Ie.assert,os=rs,Aa=ns,vs=_s,k0=ie(),et=wa,at=z1;function cs(){var y;this.rv=null;var O;this.qupvt=null;var G,P=new os,a0;this.setModules=function(T,_,h,b){y=T,O=_,this.rv=_,G=h,this.qupvt=h,a0=b,P.setModules(G,a0)},this.ms_convert=function(T,_){for(var h=0;h<576;++h){var b=T.tt[_][0].xr[h],e=T.tt[_][1].xr[h];T.tt[_][0].xr[h]=(b+e)*(Sa.SQRT2*.5),T.tt[_][1].xr[h]=(b-e)*(Sa.SQRT2*.5)}};function Z(T,_,h,b){b=0;for(var e=0;e<=h;++e){var d=Math.abs(T.xr[e]);b+=d,_[e]=Math.sqrt(d*Math.sqrt(d)),_[e]>T.xrpow_max&&(T.xrpow_max=_[e])}return b}this.init_xrpow=function(T,_,h){var b=0,e=0|_.max_nonzero_coeff;if(Ye(h!=null),_.xrpow_max=0,Ye(0<=e&&e<=575),E1.fill(h,e,576,0),b=Z(_,h,e,b),b>1e-20){var d=0;T.substep_shaping&2&&(d=1);for(var u=0;u<_.psymax;u++)T.pseudohalf[u]=d;return!0}return E1.fill(_.l3_enc,0,576,0),!1};function Q(T,_){var h=T.ATH,b=_.xr;if(_.block_type!=k0.SHORT_TYPE)for(var e=!1,d=k0.PSFB21-1;d>=0&&!e;d--){var u=T.scalefac_band.psfb21[d],x=T.scalefac_band.psfb21[d+1],v=G.athAdjust(h.adjust,h.psfb21[d],h.floor);T.nsPsy.longfact[21]>1e-12&&(v*=T.nsPsy.longfact[21]);for(var r=x-1;r>=u;r--)if(Math.abs(b[r])<v)b[r]=0;else{e=!0;break}}else for(var s=0;s<3;s++)for(var e=!1,d=k0.PSFB12-1;d>=0&&!e;d--){var u=T.scalefac_band.s[12]*3+(T.scalefac_band.s[13]-T.scalefac_band.s[12])*s+(T.scalefac_band.psfb12[d]-T.scalefac_band.psfb12[0]),x=u+(T.scalefac_band.psfb12[d+1]-T.scalefac_band.psfb12[d]),o=G.athAdjust(h.adjust,h.psfb12[d],h.floor);T.nsPsy.shortfact[12]>1e-12&&(o*=T.nsPsy.shortfact[12]);for(var r=x-1;r>=u;r--)if(Math.abs(b[r])<o)b[r]=0;else{e=!0;break}}}this.init_outer_loop=function(T,_){_.part2_3_length=0,_.big_values=0,_.count1=0,_.global_gain=210,_.scalefac_compress=0,_.table_select[0]=0,_.table_select[1]=0,_.table_select[2]=0,_.subblock_gain[0]=0,_.subblock_gain[1]=0,_.subblock_gain[2]=0,_.subblock_gain[3]=0,_.region0_count=0,_.region1_count=0,_.preflag=0,_.scalefac_scale=0,_.count1table_select=0,_.part2_length=0,_.sfb_lmax=k0.SBPSY_l,_.sfb_smin=k0.SBPSY_s,_.psy_lmax=T.sfb21_extra?k0.SBMAX_l:k0.SBPSY_l,_.psymax=_.psy_lmax,_.sfbmax=_.sfb_lmax,_.sfbdivide=11;for(var h=0;h<k0.SBMAX_l;h++)_.width[h]=T.scalefac_band.l[h+1]-T.scalefac_band.l[h],_.window[h]=3;if(_.block_type==k0.SHORT_TYPE){var b=V1(576);_.sfb_smin=0,_.sfb_lmax=0,_.mixed_block_flag!=0&&(_.sfb_smin=3,_.sfb_lmax=T.mode_gr*2+4),_.psymax=_.sfb_lmax+3*((T.sfb21_extra?k0.SBMAX_s:k0.SBPSY_s)-_.sfb_smin),_.sfbmax=_.sfb_lmax+3*(k0.SBPSY_s-_.sfb_smin),_.sfbdivide=_.sfbmax-18,_.psy_lmax=_.sfb_lmax;var e=T.scalefac_band.l[_.sfb_lmax];l1.arraycopy(_.xr,0,b,0,576);for(var h=_.sfb_smin;h<k0.SBMAX_s;h++)for(var d=T.scalefac_band.s[h],u=T.scalefac_band.s[h+1],x=0;x<3;x++)for(var v=d;v<u;v++)_.xr[e++]=b[3*v+x];for(var r=_.sfb_lmax,h=_.sfb_smin;h<k0.SBMAX_s;h++)_.width[r]=_.width[r+1]=_.width[r+2]=T.scalefac_band.s[h+1]-T.scalefac_band.s[h],_.window[r]=0,_.window[r+1]=1,_.window[r+2]=2,r+=3}_.count1bits=0,_.sfb_partition_table=G.nr_of_sfb_block[0][0],_.slen[0]=0,_.slen[1]=0,_.slen[2]=0,_.slen[3]=0,_.max_nonzero_coeff=575,E1.fill(_.scalefac,0),Q(T,_)};function U(T){this.ordinal=T}U.BINSEARCH_NONE=new U(0),U.BINSEARCH_UP=new U(1),U.BINSEARCH_DOWN=new U(2);function K(T,_,h,b,e){var d,u=T.CurrentStep[b],x=!1,v=T.OldValue[b],r=U.BINSEARCH_NONE;for(_.global_gain=v,h-=_.part2_length,Ye(u!=0);;){var s;if(d=a0.count_bits(T,e,_,null),u==1||d==h)break;d>h?(r==U.BINSEARCH_DOWN&&(x=!0),x&&(u/=2),r=U.BINSEARCH_UP,s=u):(r==U.BINSEARCH_UP&&(x=!0),x&&(u/=2),r=U.BINSEARCH_DOWN,s=-u),_.global_gain+=s,_.global_gain<0&&(_.global_gain=0,x=!0),_.global_gain>255&&(_.global_gain=255,x=!0)}for(Ye(_.global_gain>=0),Ye(_.global_gain<256);d>h&&_.global_gain<255;)_.global_gain++,d=a0.count_bits(T,e,_,null);return T.CurrentStep[b]=v-_.global_gain>=4?4:2,T.OldValue[b]=_.global_gain,_.part2_3_length=d,d}this.trancate_smallspectrums=function(T,_,h,b){var e=V1(at.SFBMAX);if(!(!(T.substep_shaping&4)&&_.block_type==k0.SHORT_TYPE||T.substep_shaping&128)){G.calc_noise(_,h,e,new Aa,null);for(var u=0;u<576;u++){var d=0;_.l3_enc[u]!=0&&(d=Math.abs(_.xr[u])),b[u]=d}var u=0,x=8;_.block_type==k0.SHORT_TYPE&&(x=6);do{var v,r,s,o,n=_.width[x];if(u+=n,!(e[x]>=1)&&(E1.sort(b,u-n,n),!BitStream.EQ(b[u-1],0))){v=(1-e[x])*h[x],r=0,o=0;do{var a;for(s=1;o+s<n&&!BitStream.NEQ(b[o+u-n],b[o+u+s-n]);s++);if(a=b[o+u-n]*b[o+u-n]*s,v<a){o!=0&&(r=b[o+u-n-1]);break}v-=a,o+=s}while(o<n);if(!BitStream.EQ(r,0))do Math.abs(_.xr[u-n])<=r&&(_.l3_enc[u-n]=0);while(--n>0)}}while(++x<_.psymax);_.part2_3_length=a0.noquant_count_bits(T,_,null)}};function R(T){for(var _=0;_<T.sfbmax;_++)if(T.scalefac[_]+T.subblock_gain[T.window[_]]==0)return!1;return!0}function j(T){return Sa.FAST_LOG10(.368+.632*T*T*T)}function S(T,_){for(var h=1e-37,b=0;b<_.psymax;b++)h+=j(T[b]);return Math.max(1e-20,h)}function H(T,_,h,b,e){var d;switch(T){default:case 9:{_.over_count>0?(d=h.over_SSD<=_.over_SSD,h.over_SSD==_.over_SSD&&(d=h.bits<_.bits)):d=h.max_noise<0&&h.max_noise*10+h.bits<=_.max_noise*10+_.bits;break}case 0:d=h.over_count<_.over_count||h.over_count==_.over_count&&h.over_noise<_.over_noise||h.over_count==_.over_count&&BitStream.EQ(h.over_noise,_.over_noise)&&h.tot_noise<_.tot_noise;break;case 8:h.max_noise=S(e,b);case 1:d=h.max_noise<_.max_noise;break;case 2:d=h.tot_noise<_.tot_noise;break;case 3:d=h.tot_noise<_.tot_noise&&h.max_noise<_.max_noise;break;case 4:d=h.max_noise<=0&&_.max_noise>.2||h.max_noise<=0&&_.max_noise<0&&_.max_noise>h.max_noise-.2&&h.tot_noise<_.tot_noise||h.max_noise<=0&&_.max_noise>0&&_.max_noise>h.max_noise-.2&&h.tot_noise<_.tot_noise+_.over_noise||h.max_noise>0&&_.max_noise>-.05&&_.max_noise>h.max_noise-.1&&h.tot_noise+h.over_noise<_.tot_noise+_.over_noise||h.max_noise>0&&_.max_noise>-.1&&_.max_noise>h.max_noise-.15&&h.tot_noise+h.over_noise+h.over_noise<_.tot_noise+_.over_noise+_.over_noise;break;case 5:d=h.over_noise<_.over_noise||BitStream.EQ(h.over_noise,_.over_noise)&&h.tot_noise<_.tot_noise;break;case 6:d=h.over_noise<_.over_noise||BitStream.EQ(h.over_noise,_.over_noise)&&(h.max_noise<_.max_noise||BitStream.EQ(h.max_noise,_.max_noise)&&h.tot_noise<=_.tot_noise);break;case 7:d=h.over_count<_.over_count||h.over_noise<_.over_noise;break}return _.over_count==0&&(d=d&&h.bits<_.bits),d}function X(T,_,h,b,e){var d=T.internal_flags,u;_.scalefac_scale==0?u=1.2968395546510096:u=1.6817928305074292;for(var x=0,v=0;v<_.sfbmax;v++)x<h[v]&&(x=h[v]);var r=d.noise_shaping_amp;switch(r==3&&(e?r=2:r=1),r){case 2:break;case 1:x>1?x=Math.pow(x,.5):x*=.95;break;case 0:default:x>1?x=1:x*=.95;break}for(var s=0,v=0;v<_.sfbmax;v++){var o=_.width[v],n;if(s+=o,!(h[v]<x)){if(d.substep_shaping&2&&(d.pseudohalf[v]=d.pseudohalf[v]==0?1:0,d.pseudohalf[v]==0&&d.noise_shaping_amp==2))return;for(_.scalefac[v]++,n=-o;n<0;n++)b[s+n]*=u,b[s+n]>_.xrpow_max&&(_.xrpow_max=b[s+n]);if(d.noise_shaping_amp==2)return}}}function Y(T,_){for(var h=1.2968395546510096,b=0,e=0;e<T.sfbmax;e++){var d=T.width[e],u=T.scalefac[e];if(T.preflag!=0&&(u+=G.pretab[e]),b+=d,u&1){u++;for(var x=-d;x<0;x++)_[b+x]*=h,_[b+x]>T.xrpow_max&&(T.xrpow_max=_[b+x])}T.scalefac[e]=u>>1}T.preflag=0,T.scalefac_scale=1}function D(T,_,h){var b,e=_.scalefac;for(b=0;b<_.sfb_lmax;b++)if(e[b]>=16)return!0;for(var d=0;d<3;d++){var u=0,x=0;for(b=_.sfb_lmax+d;b<_.sfbdivide;b+=3)u<e[b]&&(u=e[b]);for(;b<_.sfbmax;b+=3)x<e[b]&&(x=e[b]);if(!(u<16&&x<8)){if(_.subblock_gain[d]>=7)return!0;_.subblock_gain[d]++;var v=T.scalefac_band.l[_.sfb_lmax];for(b=_.sfb_lmax+d;b<_.sfbmax;b+=3){var r,s=_.width[b],o=e[b];if(Ye(o>=0),o=o-(4>>_.scalefac_scale),o>=0){e[b]=o,v+=s*3;continue}e[b]=0;{var n=210+(o<<_.scalefac_scale+1);r=G.IPOW20(n)}v+=s*(d+1);for(var a=-s;a<0;a++)h[v+a]*=r,h[v+a]>_.xrpow_max&&(_.xrpow_max=h[v+a]);v+=s*(3-d-1)}{var r=G.IPOW20(202);v+=_.width[b]*(d+1);for(var a=-_.width[b];a<0;a++)h[v+a]*=r,h[v+a]>_.xrpow_max&&(_.xrpow_max=h[v+a])}}}return!1}function q(T,_,h,b,e){var d=T.internal_flags;X(T,_,h,b,e);var u=R(_);return u?!1:(d.mode_gr==2?u=a0.scale_bitcount(_):u=a0.scale_bitcount_lsf(d,_),u?(d.noise_shaping>1&&(E1.fill(d.pseudohalf,0),_.scalefac_scale==0?(Y(_,b),u=!1):_.block_type==k0.SHORT_TYPE&&d.subblock_gain>0&&(u=D(d,_,b)||R(_))),u||(d.mode_gr==2?u=a0.scale_bitcount(_):u=a0.scale_bitcount_lsf(d,_)),!u):!0)}this.outer_loop=function(T,_,h,b,e,d){var u=T.internal_flags,x=new et,v=V1(576),r=V1(at.SFBMAX),s=new Aa,o,n=new vs,a=9999999,c=!1,i=!1,C=0;if(K(u,_,d,e,b),u.noise_shaping==0)return 100;G.calc_noise(_,h,r,s,n),s.bits=_.part2_3_length,x.assign(_);var M=0;for(l1.arraycopy(b,0,v,0,576);!c;){do{var E=new Aa,t,l=255;if(u.substep_shaping&2?t=20:t=3,u.sfb21_extra&&(r[x.sfbmax]>1||x.block_type==k0.SHORT_TYPE&&(r[x.sfbmax+1]>1||r[x.sfbmax+2]>1))||!q(T,x,r,b,i))break;x.scalefac_scale!=0&&(l=254);var B=d-x.part2_length;if(B<=0)break;for(;(x.part2_3_length=a0.count_bits(u,b,x,n))>B&&x.global_gain<=l;)x.global_gain++;if(x.global_gain>l)break;if(s.over_count==0){for(;(x.part2_3_length=a0.count_bits(u,b,x,n))>a&&x.global_gain<=l;)x.global_gain++;if(x.global_gain>l)break}if(G.calc_noise(x,h,r,E,n),E.bits=x.part2_3_length,_.block_type!=k0.SHORT_TYPE?o=T.quant_comp:o=T.quant_comp_short,o=H(o,s,E,x,r)?1:0,o!=0)a=_.part2_3_length,s=E,_.assign(x),M=0,l1.arraycopy(b,0,v,0,576);else if(u.full_outer_loop==0&&(++M>t&&s.over_count==0||u.noise_shaping_amp==3&&i&&M>30||u.noise_shaping_amp==3&&i&&x.global_gain-C>15))break}while(x.global_gain+x.scalefac_scale<255);u.noise_shaping_amp==3?i?c=!0:(x.assign(_),l1.arraycopy(v,0,b,0,576),M=0,C=x.global_gain,i=!0):c=!0}return Ye(_.global_gain+_.scalefac_scale<=255),T.VBR==ga.vbr_rh||T.VBR==ga.vbr_mtrh?l1.arraycopy(v,0,b,0,576):u.substep_shaping&1&&trancate_smallspectrums(u,_,h,b),s.over_count},this.iteration_finish_one=function(T,_,h){var b=T.l3_side,e=b.tt[_][h];a0.best_scalefac_store(T,_,h,b),T.use_best_huffman==1&&a0.best_huffman_divide(T,e),O.ResvAdjust(T,e)},this.VBR_encode_granule=function(T,_,h,b,e,d,u){var x=T.internal_flags,v=new et,r=V1(576),s=u,o=u+1,n=(u+d)/2,a,c,i=0,C=x.sfb21_extra;Ye(s<=LameInternalFlags.MAX_BITS_PER_CHANNEL),E1.fill(v.l3_enc,0);do Ye(n>=d),Ye(n<=u),Ye(d<=u),n>s-42?x.sfb21_extra=!1:x.sfb21_extra=C,c=outer_loop(T,_,h,b,e,n),c<=0?(i=1,o=_.part2_3_length,v.assign(_),l1.arraycopy(b,0,r,0,576),u=o-32,a=u-d,n=(u+d)/2):(d=n+32,a=u-d,n=(u+d)/2,i!=0&&(i=2,_.assign(v),l1.arraycopy(r,0,b,0,576)));while(a>12);x.sfb21_extra=C,i==2&&l1.arraycopy(v.l3_enc,0,_.l3_enc,0,576),Ye(_.part2_3_length<=s)},this.get_framebits=function(T,_){var h=T.internal_flags;h.bitrate_index=h.VBR_min_bitrate;var b=y.getframebits(T);h.bitrate_index=1,b=y.getframebits(T);for(var e=1;e<=h.VBR_max_bitrate;e++){h.bitrate_index=e;var d=new MeanBits(b);_[e]=O.ResvFrameBegin(T,d),b=d.bits}},this.VBR_old_prepare=function(T,_,h,b,e,d,u,x,v){var r=T.internal_flags,s,o=0,n=1,a=0;r.bitrate_index=r.VBR_max_bitrate;var c=O.ResvFrameBegin(T,new MeanBits(0))/r.mode_gr;get_framebits(T,d);for(var i=0;i<r.mode_gr;i++){var C=G.on_pe(T,_,x[i],c,i,0);r.mode_ext==k0.MPG_MD_MS_LR&&(ms_convert(r.l3_side,i),G.reduce_side(x[i],h[i],c,C));for(var M=0;M<r.channels_out;++M){var E=r.l3_side.tt[i][M];E.block_type!=k0.SHORT_TYPE?(o=1.28/(1+Math.exp(3.5-_[i][M]/300))-.05,s=r.PSY.mask_adjust-o):(o=2.56/(1+Math.exp(3.5-_[i][M]/300))-.14,s=r.PSY.mask_adjust_short-o),r.masking_lower=Math.pow(10,s*.1),init_outer_loop(r,E),v[i][M]=G.calc_xmin(T,b[i][M],E,e[i][M]),v[i][M]!=0&&(n=0),u[i][M]=126,a+=x[i][M]}}for(var i=0;i<r.mode_gr;i++)for(var M=0;M<r.channels_out;M++)a>d[r.VBR_max_bitrate]&&(x[i][M]*=d[r.VBR_max_bitrate],x[i][M]/=a),u[i][M]>x[i][M]&&(u[i][M]=x[i][M]);return n},this.bitpressure_strategy=function(T,_,h,b){for(var e=0;e<T.mode_gr;e++)for(var d=0;d<T.channels_out;d++){for(var u=T.l3_side.tt[e][d],x=_[e][d],v=0,r=0;r<u.psy_lmax;r++)x[v++]*=1+.029*r*r/k0.SBMAX_l/k0.SBMAX_l;if(u.block_type==k0.SHORT_TYPE)for(var r=u.sfb_smin;r<k0.SBMAX_s;r++)x[v++]*=1+.029*r*r/k0.SBMAX_s/k0.SBMAX_s,x[v++]*=1+.029*r*r/k0.SBMAX_s/k0.SBMAX_s,x[v++]*=1+.029*r*r/k0.SBMAX_s/k0.SBMAX_s;b[e][d]=0|Math.max(h[e][d],.9*b[e][d])}},this.VBR_new_prepare=function(T,_,h,b,e,d){var u=T.internal_flags,x=1,v=0,r=0,s;if(T.free_format){u.bitrate_index=0;var o=new MeanBits(v);s=O.ResvFrameBegin(T,o),v=o.bits,e[0]=s}else{u.bitrate_index=u.VBR_max_bitrate;var o=new MeanBits(v);O.ResvFrameBegin(T,o),v=o.bits,get_framebits(T,e),s=e[u.VBR_max_bitrate]}for(var n=0;n<u.mode_gr;n++){G.on_pe(T,_,d[n],v,n,0),u.mode_ext==k0.MPG_MD_MS_LR&&ms_convert(u.l3_side,n);for(var a=0;a<u.channels_out;++a){var c=u.l3_side.tt[n][a];u.masking_lower=Math.pow(10,u.PSY.mask_adjust*.1),init_outer_loop(u,c),G.calc_xmin(T,h[n][a],c,b[n][a])!=0&&(x=0),r+=d[n][a]}}for(var n=0;n<u.mode_gr;n++)for(var a=0;a<u.channels_out;a++)r>s&&(d[n][a]*=s,d[n][a]/=r);return x},this.calc_target_bits=function(T,_,h,b,e,d){var u=T.internal_flags,x=u.l3_side,v,r,s,o,n=0;u.bitrate_index=u.VBR_max_bitrate;var a=new MeanBits(n);for(d[0]=O.ResvFrameBegin(T,a),n=a.bits,u.bitrate_index=1,n=y.getframebits(T)-u.sideinfo_len*8,e[0]=n/(u.mode_gr*u.channels_out),n=T.VBR_mean_bitrate_kbps*T.framesize*1e3,u.substep_shaping&1&&(n*=1.09),n/=T.out_samplerate,n-=u.sideinfo_len*8,n/=u.mode_gr*u.channels_out,v=.93+.07*(11-T.compression_ratio)/(11-5.5),v<.9&&(v=.9),v>1&&(v=1),r=0;r<u.mode_gr;r++){var c=0;for(s=0;s<u.channels_out;s++){if(b[r][s]=int(v*n),_[r][s]>700){var i=int((_[r][s]-700)/1.4),C=x.tt[r][s];b[r][s]=int(v*n),C.block_type==k0.SHORT_TYPE&&i<n/2&&(i=n/2),i>n*3/2?i=n*3/2:i<0&&(i=0),b[r][s]+=i}b[r][s]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(b[r][s]=LameInternalFlags.MAX_BITS_PER_CHANNEL),c+=b[r][s]}if(c>LameInternalFlags.MAX_BITS_PER_GRANULE)for(s=0;s<u.channels_out;++s)b[r][s]*=LameInternalFlags.MAX_BITS_PER_GRANULE,b[r][s]/=c}if(u.mode_ext==k0.MPG_MD_MS_LR)for(r=0;r<u.mode_gr;r++)G.reduce_side(b[r],h[r],n*u.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(o=0,r=0;r<u.mode_gr;r++)for(s=0;s<u.channels_out;s++)b[r][s]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(b[r][s]=LameInternalFlags.MAX_BITS_PER_CHANNEL),o+=b[r][s];if(o>d[0])for(r=0;r<u.mode_gr;r++)for(s=0;s<u.channels_out;s++)b[r][s]*=d[0],b[r][s]/=o}}var us=cs,hs=P0,U1=hs.assert;function ds(){var y;this.setModules=function(O){y=O},this.ResvFrameBegin=function(O,G){var P=O.internal_flags,a0,Z=P.l3_side,Q=y.getframebits(O);G.bits=(Q-P.sideinfo_len*8)/P.mode_gr;var U=8*256*P.mode_gr-8;O.brate>320?a0=8*int(O.brate*1e3/(O.out_samplerate/1152)/8+.5):(a0=8*1440,O.strict_ISO&&(a0=8*int(32e4/(O.out_samplerate/1152)/8+.5))),P.ResvMax=a0-Q,P.ResvMax>U&&(P.ResvMax=U),(P.ResvMax<0||O.disable_reservoir)&&(P.ResvMax=0);var K=G.bits*P.mode_gr+Math.min(P.ResvSize,P.ResvMax);return K>a0&&(K=a0),U1(P.ResvMax%8==0),U1(P.ResvMax>=0),Z.resvDrain_pre=0,P.pinfo!=null&&(P.pinfo.mean_bits=G.bits/2,P.pinfo.resvsize=P.ResvSize),K},this.ResvMaxBits=function(O,G,P,a0){var Z=O.internal_flags,Q,U=Z.ResvSize,K=Z.ResvMax;a0!=0&&(U+=G),Z.substep_shaping&1&&(K*=.9),P.bits=G,U*10>K*9?(Q=U-K*9/10,P.bits+=Q,Z.substep_shaping|=128):(Q=0,Z.substep_shaping&=127,!O.disable_reservoir&&!(Z.substep_shaping&1)&&(P.bits-=.1*G));var R=U<Z.ResvMax*6/10?U:Z.ResvMax*6/10;return R-=Q,R<0&&(R=0),R},this.ResvAdjust=function(O,G){O.ResvSize-=G.part2_3_length+G.part2_length},this.ResvFrameEnd=function(O,G){var P,a0=O.l3_side;O.ResvSize+=G*O.mode_gr;var Z=0;a0.resvDrain_post=0,a0.resvDrain_pre=0,(P=O.ResvSize%8)!=0&&(Z+=P),P=O.ResvSize-Z-O.ResvMax,P>0&&(U1(P%8==0),U1(P>=0),Z+=P);{var Q=Math.min(a0.main_data_begin*8,Z)/8;a0.resvDrain_pre+=8*Q,Z-=8*Q,O.ResvSize-=8*Q,a0.main_data_begin-=Q}a0.resvDrain_post+=Z,O.ResvSize-=Z}}var ms=ds;function fs(){var y="http://www.mp3dev.org/",O=3,G=98,P=4,a0=0,Z=93;this.getLameVersion=function(){return O+"."+G+"."+P},this.getLameShortVersion=function(){return O+"."+G+"."+P},this.getLameVeryShortVersion=function(){return"LAME"+O+"."+G+"r"},this.getPsyVersion=function(){return a0+"."+Z},this.getLameUrl=function(){return y},this.getLameOsBitness=function(){return"32bits"}}var bs=fs,Ce=P0,xs=Ce.System,ya=Ce.VbrMode;Ce.Float;var tt=Ce.ShortBlock;Ce.Util;var Ss=Ce.Arrays;Ce.new_array_n;var K1=Ce.new_byte;Ce.new_double;Ce.new_float;Ce.new_float_n;Ce.new_int;Ce.new_int_n;var As=Ce.assert;O1.NUMTOCENTRIES=100;O1.MAXFRAMESIZE=2880;function O1(){var y,O,G;this.setModules=function(n,a,c){y=n,O=a,G=c};var P=1,a0=2,Z=4,Q=8,U=O1.NUMTOCENTRIES,K=O1.MAXFRAMESIZE,R=U+4+4+4+4+4,j=R+9+1+1+8+1+1+3+1+1+2+4+2+2,S=128,H=64,X=32,Y=null,D="Xing",q="Info",T=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function _(n,a){if(n.nVbrNumFrames++,n.sum+=a,n.seen++,!(n.seen<n.want)&&(n.pos<n.size&&(n.bag[n.pos]=n.sum,n.pos++,n.seen=0),n.pos==n.size)){for(var c=1;c<n.size;c+=2)n.bag[c/2]=n.bag[c];n.want*=2,n.pos/=2}}function h(n,a){if(!(n.pos<=0))for(var c=1;c<U;++c){var i=c/U,C,M,E=0|Math.floor(i*n.pos);E>n.pos-1&&(E=n.pos-1),C=n.bag[E],M=n.sum;var t=0|256*C/M;t>255&&(t=255),a[c]=255&t}}this.addVbrFrame=function(n){var a=n.internal_flags,c=Tables.bitrate_table[n.version][a.bitrate_index];As(a.VBR_seek_table.bag!=null),_(a.VBR_seek_table,c)};function b(n,a){var c=n[a+0]&255;return c<<=8,c|=n[a+1]&255,c<<=8,c|=n[a+2]&255,c<<=8,c|=n[a+3]&255,c}function e(n,a,c){n[a+0]=255&(c>>24&255),n[a+1]=255&(c>>16&255),n[a+2]=255&(c>>8&255),n[a+3]=255&(c&255)}function d(n,a,c){n[a+0]=255&(c>>8&255),n[a+1]=255&(c&255)}function u(n,a){return new String(n,a,D.length(),Y).equals(D)||new String(n,a,q.length(),Y).equals(q)}function x(n,a,c){return 255&(n<<a|c&~(-1<<a))}function v(n,a){var c=n.internal_flags;a[0]=x(a[0],8,255),a[1]=x(a[1],3,7),a[1]=x(a[1],1,n.out_samplerate<16e3?0:1),a[1]=x(a[1],1,n.version),a[1]=x(a[1],2,4-3),a[1]=x(a[1],1,n.error_protection?0:1),a[2]=x(a[2],4,c.bitrate_index),a[2]=x(a[2],2,c.samplerate_index),a[2]=x(a[2],1,0),a[2]=x(a[2],1,n.extension),a[3]=x(a[3],2,n.mode.ordinal()),a[3]=x(a[3],2,c.mode_ext),a[3]=x(a[3],1,n.copyright),a[3]=x(a[3],1,n.original),a[3]=x(a[3],2,n.emphasis),a[0]=255;var i=255&(a[1]&241),C;n.version==1?C=S:n.out_samplerate<16e3?C=X:C=H,n.VBR==ya.vbr_off&&(C=n.brate);var M;n.free_format?M=0:M=255&16*y.BitrateIndex(C,n.version,n.out_samplerate),n.version==1?(a[1]=255&(i|10),i=255&(a[2]&13),a[2]=255&(M|i)):(a[1]=255&(i|2),i=255&(a[2]&13),a[2]=255&(M|i))}this.getVbrTag=function(n){var a=new VBRTagData,c=0;a.flags=0;var i=n[c+1]>>3&1,C=n[c+2]>>2&3,M=n[c+3]>>6&3,E=n[c+2]>>4&15;if(E=Tables.bitrate_table[i][E],n[c+1]>>4==14?a.samprate=Tables.samplerate_table[2][C]:a.samprate=Tables.samplerate_table[i][C],i!=0?M!=3?c+=32+4:c+=17+4:M!=3?c+=17+4:c+=9+4,!u(n,c))return null;c+=4,a.hId=i;var t=a.flags=b(n,c);if(c+=4,t&P&&(a.frames=b(n,c),c+=4),t&a0&&(a.bytes=b(n,c),c+=4),t&Z){if(a.toc!=null)for(var l=0;l<U;l++)a.toc[l]=n[c+l];c+=U}a.vbrScale=-1,t&Q&&(a.vbrScale=b(n,c),c+=4),a.headersize=(i+1)*72e3*E/a.samprate,c+=21;var B=n[c+0]<<4;B+=n[c+1]>>4;var N=(n[c+1]&15)<<8;return N+=n[c+2]&255,(B<0||B>3e3)&&(B=-1),(N<0||N>3e3)&&(N=-1),a.encDelay=B,a.encPadding=N,a},this.InitVbrTag=function(n){var a=n.internal_flags,c;n.version==1?c=S:n.out_samplerate<16e3?c=X:c=H,n.VBR==ya.vbr_off&&(c=n.brate);var i=(n.version+1)*72e3*c/n.out_samplerate,C=a.sideinfo_len+j;if(a.VBR_seek_table.TotalFrameSize=i,i<C||i>K){n.bWriteVbrTag=!1;return}a.VBR_seek_table.nVbrNumFrames=0,a.VBR_seek_table.nBytesWritten=0,a.VBR_seek_table.sum=0,a.VBR_seek_table.seen=0,a.VBR_seek_table.want=1,a.VBR_seek_table.pos=0,a.VBR_seek_table.bag==null&&(a.VBR_seek_table.bag=new int[400],a.VBR_seek_table.size=400);var M=K1(K);v(n,M);for(var E=a.VBR_seek_table.TotalFrameSize,t=0;t<E;++t)O.add_dummy_byte(n,M[t]&255,1)};function r(n,a){var c=a^n;return a=a>>8^T[c&255],a}this.updateMusicCRC=function(n,a,c,i){for(var C=0;C<i;++C)n[0]=r(a[c+C],n[0])};function s(n,a,c,i,C){var M=n.internal_flags,E=0,t=n.encoder_delay,l=n.encoder_padding,B=100-10*n.VBR_q-n.quality,N=G.getLameVeryShortVersion(),l0,c0=0,o0,v0=[1,5,3,2,4,0,3],A0=0|(n.lowpassfreq/100+.5>255?255:n.lowpassfreq/100+.5),d0=0,_0=0,T0=0,F0=n.internal_flags.noise_shaping,p0=0,I0=0,N0=0,D0=0,W0=0,De=(n.exp_nspsytune&1)!=0,le=(n.exp_nspsytune&2)!=0,se=!1,ke=!1,a1=n.internal_flags.nogap_total,We=n.internal_flags.nogap_current,re=n.ATHtype,t1=0,J;switch(n.VBR){case vbr_abr:J=n.VBR_mean_bitrate_kbps;break;case vbr_off:J=n.brate;break;default:J=n.VBR_min_bitrate_kbps}switch(n.VBR.ordinal()<v0.length?l0=v0[n.VBR.ordinal()]:l0=0,o0=16*c0+l0,M.findReplayGain&&(M.RadioGain>510&&(M.RadioGain=510),M.RadioGain<-510&&(M.RadioGain=-510),_0=8192,_0|=3072,M.RadioGain>=0?_0|=M.RadioGain:(_0|=512,_0|=-M.RadioGain)),M.findPeakSample&&(d0=Math.abs(0|M.PeakSample/32767*Math.pow(2,23)+.5)),a1!=-1&&(We>0&&(ke=!0),We<a1-1&&(se=!0)),t1=re+((De?1:0)<<4)+((le?1:0)<<5)+((se?1:0)<<6)+((ke?1:0)<<7),B<0&&(B=0),n.mode){case MONO:p0=0;break;case STEREO:p0=1;break;case DUAL_CHANNEL:p0=2;break;case JOINT_STEREO:n.force_ms?p0=4:p0=3;break;case NOT_SET:default:p0=7;break}n.in_samplerate<=32e3?N0=0:n.in_samplerate==48e3?N0=2:n.in_samplerate>48e3?N0=3:N0=1,(n.short_blocks==tt.short_block_forced||n.short_blocks==tt.short_block_dispensed||n.lowpassfreq==-1&&n.highpassfreq==-1||n.scale_left<n.scale_right||n.scale_left>n.scale_right||n.disable_reservoir&&n.brate<320||n.noATH||n.ATHonly||re==0||n.in_samplerate<=32e3)&&(I0=1),D0=F0+(p0<<2)+(I0<<5)+(N0<<6),W0=M.nMusicCRC,e(c,i+E,B),E+=4;for(var n0=0;n0<9;n0++)c[i+E+n0]=255&N.charAt(n0);E+=9,c[i+E]=255&o0,E++,c[i+E]=255&A0,E++,e(c,i+E,d0),E+=4,d(c,i+E,_0),E+=2,d(c,i+E,T0),E+=2,c[i+E]=255&t1,E++,J>=255?c[i+E]=255:c[i+E]=255&J,E++,c[i+E]=255&t>>4,c[i+E+1]=255&(t<<4)+(l>>8),c[i+E+2]=255&l,E+=3,c[i+E]=255&D0,E++,c[i+E++]=0,d(c,i+E,n.preset),E+=2,e(c,i+E,a),E+=4,d(c,i+E,W0),E+=2;for(var M0=0;M0<E;M0++)C=r(c[i+M0],C);return d(c,i+E,C),E+=2,E}function o(n){n.seek(0);var a=K1(10);n.readFully(a);var c;return new String(a,"ISO-8859-1").startsWith("ID3")?c=0:c=((a[6]&127)<<21|(a[7]&127)<<14|(a[8]&127)<<7|a[9]&127)+a.length,c}this.getLameTagFrame=function(n,a){var c=n.internal_flags;if(!n.bWriteVbrTag||c.Class_ID!=Lame.LAME_ID||c.VBR_seek_table.pos<=0)return 0;if(a.length<c.VBR_seek_table.TotalFrameSize)return c.VBR_seek_table.TotalFrameSize;Ss.fill(a,0,c.VBR_seek_table.TotalFrameSize,0),v(n,a);var i=K1(U);if(n.free_format)for(var C=1;C<U;++C)i[C]=255&255*C/100;else h(c.VBR_seek_table,i);var M=c.sideinfo_len;n.error_protection&&(M-=2),n.VBR==ya.vbr_off?(a[M++]=255&q.charAt(0),a[M++]=255&q.charAt(1),a[M++]=255&q.charAt(2),a[M++]=255&q.charAt(3)):(a[M++]=255&D.charAt(0),a[M++]=255&D.charAt(1),a[M++]=255&D.charAt(2),a[M++]=255&D.charAt(3)),e(a,M,P+a0+Z+Q),M+=4,e(a,M,c.VBR_seek_table.nVbrNumFrames),M+=4;var E=c.VBR_seek_table.nBytesWritten+c.VBR_seek_table.TotalFrameSize;e(a,M,0|E),M+=4,xs.arraycopy(i,0,a,M,i.length),M+=i.length,n.error_protection&&O.CRC_writeheader(c,a);for(var t=0,C=0;C<M;C++)t=r(a[C],t);return M+=s(n,E,a,M,t),c.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(n,a){var c=n.internal_flags;if(c.VBR_seek_table.pos<=0||(a.seek(a.length()),a.length()==0))return-1;var i=o(a);a.seek(i);var C=K1(K),M=getLameTagFrame(n,C);return M>C.length?-1:(M<1||a.write(C,0,M),0)}}var ys=O1,Le=P0;Le.System;Le.VbrMode;Le.Float;Le.ShortBlock;Le.Util;Le.Arrays;Le.new_array_n;var rt=Le.new_byte;Le.new_double;Le.new_float;Le.new_float_n;Le.new_int;Le.new_int_n;var st=Le.assert,Ms=gr,ps=as,Rs=At,ws=Mt,Es=us,Bs=pt,Ts=ms,Ns=bt,Is=Rt;ie();var Cs=bs,Ls=ys;function ks(){this.setModules=function(y,O){}}function Vs(){this.setModules=function(y,O,G){}}function Os(){}function Fs(){this.setModules=function(y,O){}}function js(y,O,G){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),y=1,O=44100,G=128);var P=new Ms,a0=new ks,Z=new Rs,Q=new Is,U=new ps,K=new ws,R=new Es,j=new Ls,S=new Cs,H=new Fs,X=new Ts,Y=new Bs,D=new Vs,q=new Os;P.setModules(Z,Q,U,K,R,j,S,H,q),Q.setModules(Z,q,S,j),H.setModules(Q,S),U.setModules(P),R.setModules(Q,X,K,Y),K.setModules(Y,X,P.enc.psy),X.setModules(Q),Y.setModules(K),j.setModules(P,Q,S),a0.setModules(D,q),D.setModules(S,H,U);var T=P.lame_init();T.num_channels=y,T.in_samplerate=O,T.brate=G,T.mode=Ns.STEREO,T.quality=3,T.bWriteVbrTag=!1,T.disable_reservoir=!0,T.write_id3tag_automatic=!1;var _=P.lame_init_params(T);st(_==0);var h=1152,b=0|1.25*h+7200,e=rt(b);this.encodeBuffer=function(d,u){y==1&&(u=d),st(d.length==u.length),d.length>h&&(h=d.length,b=0|1.25*h+7200,e=rt(b));var x=P.lame_encode_buffer(T,d,u,d.length,e,0,b);return new Int8Array(e.subarray(0,x))},this.flush=function(){var d=P.lame_encode_flush(T,e,0,b);return new Int8Array(e.subarray(0,d))}}function Ze(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function g1(y){return y.charCodeAt(0)<<24|y.charCodeAt(1)<<16|y.charCodeAt(2)<<8|y.charCodeAt(3)}Ze.RIFF=g1("RIFF");Ze.WAVE=g1("WAVE");Ze.fmt_=g1("fmt ");Ze.data=g1("data");Ze.readHeader=function(y){var O=new Ze,G=y.getUint32(0,!1);if(Ze.RIFF==G&&(y.getUint32(4,!0),Ze.WAVE==y.getUint32(8,!1)&&Ze.fmt_==y.getUint32(12,!1))){var P=y.getUint32(16,!0),a0=16+4;switch(P){case 16:case 18:O.channels=y.getUint16(a0+2,!0),O.sampleRate=y.getUint32(a0+4,!0);break;default:throw"extended fmt chunk not implemented"}a0+=P;for(var Z=Ze.data,Q=0;Z!=G&&(G=y.getUint32(a0,!1),Q=y.getUint32(a0+4,!0),Z!=G);)a0+=Q+8;return O.dataLen=Q,O.dataOffset=a0+8,O}};Ra.Mp3Encoder=js;Ra.WavHeader=Ze;const Hs=()=>{const[y,O]=C0.useState(!1),[G,P]=C0.useState("C"),[a0,Z]=C0.useState("piano"),[Q,U]=C0.useState(new Set);C0.useState("major");const[K,R]=C0.useState({attack:.02,decay:.3,sustain:.4,release:1.2,volume:-6,detune:0,filterCutoff:3e3,filterResonance:.5,oscillatorType:"triangle"}),[j,S]=C0.useState(!1),[H,X]=C0.useState(120),[Y,D]=C0.useState("4/4"),[q,T]=C0.useState(!0),[_,h]=C0.useState(0),[b,e]=C0.useState({reverb:!1,delay:!1,tremolo:!1,flanger:!1,sidechain:!1,eq:!1}),[d,u]=C0.useState({low:0,lowMid:0,mid:0,highMid:0,high:0}),[x,v]=C0.useState({threshold:-20,ratio:4,attack:.01,release:.1,speed:"quarter"});C0.useState("chord");const[r,s]=C0.useState(null),[o,n]=C0.useState(null),[a,c]=C0.useState(new Set),[i,C]=C0.useState(!1),[M,E]=C0.useState(null),[t,l]=C0.useState(null),[B,N]=C0.useState(0);C0.useState(null),C0.useState([]);const[l0,c0]=C0.useState(null),o0={piano:{name:"Piano",icon:"🎹",waveform:"triangle",adsr:{attack:.01,decay:.3,sustain:.3,release:1.5},filterCutoff:3e3,effects:{reverb:!0,delay:!1},detune:0,volume:-6},synth:{name:"Synth",icon:"🎛️",waveform:"sawtooth",adsr:{attack:.1,decay:.3,sustain:.7,release:.8},filterCutoff:1200,effects:{reverb:!1,delay:!0},detune:0,volume:-3},bass:{name:"Bass",icon:"🎸",waveform:"square",adsr:{attack:.05,decay:.2,sustain:.8,release:.4},filterCutoff:300,effects:{reverb:!1,delay:!1},detune:0,volume:-2},pad:{name:"Pad",icon:"☁️",waveform:"sine",adsr:{attack:2,decay:1.5,sustain:.9,release:3},filterCutoff:600,effects:{reverb:!0,delay:!0},detune:0,volume:-8},lead:{name:"Lead",icon:"🎷",waveform:"sawtooth",adsr:{attack:.02,decay:.1,sustain:.9,release:.3},filterCutoff:2e3,effects:{reverb:!0,delay:!1},detune:0,volume:-4},organ:{name:"Organ",icon:"🎹",waveform:"square",adsr:{attack:0,decay:0,sustain:1,release:.05},filterCutoff:1500,effects:{reverb:!0,delay:!1},detune:0,volume:-5},strings:{name:"Strings",icon:"🎻",waveform:"triangle",adsr:{attack:.5,decay:1,sustain:.8,release:2.5},filterCutoff:2500,effects:{reverb:!0,delay:!1},detune:0,volume:-7},brass:{name:"Brass",icon:"🎺",waveform:"sawtooth",adsr:{attack:.1,decay:.4,sustain:.7,release:.8},filterCutoff:1800,effects:{reverb:!0,delay:!1},detune:0,volume:-4},choir:{name:"Choir",icon:"👥",waveform:"sine",adsr:{attack:.3,decay:.8,sustain:.9,release:2},filterCutoff:1200,effects:{reverb:!0,delay:!0},detune:0,volume:-6},bell:{name:"Bell",icon:"🔔",waveform:"triangle",adsr:{attack:0,decay:.1,sustain:.1,release:3},filterCutoff:4e3,effects:{reverb:!0,delay:!1},detune:0,volume:-8},pluck:{name:"Pluck",icon:"🪕",waveform:"triangle",adsr:{attack:0,decay:.05,sustain:0,release:.3},filterCutoff:2e3,effects:{reverb:!1,delay:!0},detune:0,volume:-3},ambient:{name:"Ambient",icon:"🌌",waveform:"sine",adsr:{attack:3,decay:2,sustain:.9,release:5},filterCutoff:800,effects:{reverb:!0,delay:!0},detune:0,volume:-10}},v0={C:{I:{name:"C",notes:["C4","E4","G4"],type:"major"},ii:{name:"Dm",notes:["D4","F4","A4"],type:"minor"},iii:{name:"Em",notes:["E4","G4","B4"],type:"minor"},IV:{name:"F",notes:["F4","A4","C5"],type:"major"},V:{name:"G",notes:["G4","B4","D5"],type:"major"},vi:{name:"Am",notes:["A4","C5","E5"],type:"minor"},"vii°":{name:"B°",notes:["B4","D5","F5"],type:"diminished"}},G:{I:{name:"G",notes:["G3","B3","D4"],type:"major"},ii:{name:"Am",notes:["A3","C4","E4"],type:"minor"},iii:{name:"Bm",notes:["B3","D4","F#4"],type:"minor"},IV:{name:"C",notes:["C4","E4","G4"],type:"major"},V:{name:"D",notes:["D4","F#4","A4"],type:"major"},vi:{name:"Em",notes:["E4","G4","B4"],type:"minor"},"vii°":{name:"F#°",notes:["F#4","A4","C5"],type:"diminished"}},D:{I:{name:"D",notes:["D3","F#3","A3"],type:"major"},ii:{name:"Em",notes:["E3","G3","B3"],type:"minor"},iii:{name:"F#m",notes:["F#3","A3","C#4"],type:"minor"},IV:{name:"G",notes:["G3","B3","D4"],type:"major"},V:{name:"A",notes:["A3","C#4","E4"],type:"major"},vi:{name:"Bm",notes:["B3","D4","F#4"],type:"minor"},"vii°":{name:"C#°",notes:["C#4","E4","G4"],type:"diminished"}},A:{I:{name:"A",notes:["A3","C#4","E4"],type:"major"},ii:{name:"Bm",notes:["B3","D4","F#4"],type:"minor"},iii:{name:"C#m",notes:["C#4","E4","G#4"],type:"minor"},IV:{name:"D",notes:["D4","F#4","A4"],type:"major"},V:{name:"E",notes:["E4","G#4","B4"],type:"major"},vi:{name:"F#m",notes:["F#4","A4","C#5"],type:"minor"},"vii°":{name:"G#°",notes:["G#4","B4","D5"],type:"diminished"}},E:{I:{name:"E",notes:["E3","G#3","B3"],type:"major"},ii:{name:"F#m",notes:["F#3","A3","C#4"],type:"minor"},iii:{name:"G#m",notes:["G#3","B3","D#4"],type:"minor"},IV:{name:"A",notes:["A3","C#4","E4"],type:"major"},V:{name:"B",notes:["B3","D#4","F#4"],type:"major"},vi:{name:"C#m",notes:["C#4","E4","G#4"],type:"minor"},"vii°":{name:"D#°",notes:["D#4","F#4","A4"],type:"diminished"}},F:{I:{name:"F",notes:["F3","A3","C4"],type:"major"},ii:{name:"Gm",notes:["G3","Bb3","D4"],type:"minor"},iii:{name:"Am",notes:["A3","C4","E4"],type:"minor"},IV:{name:"Bb",notes:["Bb3","D4","F4"],type:"major"},V:{name:"C",notes:["C4","E4","G4"],type:"major"},vi:{name:"Dm",notes:["D4","F4","A4"],type:"minor"},"vii°":{name:"E°",notes:["E4","G4","Bb4"],type:"diminished"}}};C0.useEffect(()=>{(async()=>{try{await C1(),console.log("Tone.js initialized");const n0=new Nt(It,{oscillator:{type:"triangle",detune:0},envelope:{attack:.01,decay:.3,sustain:.3,release:1.5},volume:-6}),M0=new Ct(3e3,"lowpass"),O0=new Lt({decay:2,wet:.3}),j0=new kt({delayTime:"8n",feedback:.2,wet:.2}),V0=new Vt({frequency:4,depth:.5,wet:.3}),m=new Ot({delayTime:"8n",feedback:.3,wet:.2}),f=new Ft({low:0,mid:0,high:0}),p=new jt({threshold:-20,ratio:4,attack:.01,release:.1}),w=new Ht(1),V=new Xt({frequency:1,type:"sine",min:.3,max:1});V.connect(w.gain);const A={filter:M0,reverb:O0,delay:j0,tremolo:V0,flanger:m,eq:f,sidechain:p,sidechainDuck:w,sidechainLFO:V};n0.connect(M0),M0.connect(f),f.connect(p),p.connect(w),w.connect(V0),V0.connect(m),m.connect(O0),O0.connect(j0),j0.toDestination(),n0.effectsChain=A,s(n0),O(!0);const L=new Dt;E(L)}catch(n0){console.error("Failed to initialize synthesizer:",n0)}})()},[]),C0.useEffect(()=>{if(y){const J=parseInt(Y.split("/")[0]),n0=new Tt(M0=>{const O0=Math.floor(X1.position.split(":")[1])%J;h(O0),O0===0&&q?new _a(1e3,"sine").toDestination().start(M0).stop(M0+.15):new _a(800,"sine").toDestination().start(M0).stop(M0+.1)},"4n");n(n0)}},[y,Y,q]);const A0=async J=>{if(!r||!y)return;v1.state!=="running"&&await C1();const n0=v0[G][J];n0&&(Q.has(J)||(console.log("Triggering chord:",J,n0.notes),console.log("Synth state:",r),console.log("Audio context state:",v1.state),U(M0=>new Set([...M0,J])),n0.notes.forEach(M0=>{console.log("Playing note:",M0),r.triggerAttack(M0),c(O0=>new Set([...O0,M0]))})))},d0=J=>{if(!r||!y)return;const n0=v0[G][J];n0&&Q.has(J)&&(console.log("Releasing chord:",J,n0.notes),U(M0=>{const O0=new Set(M0);return O0.delete(J),O0}),n0.notes.forEach(M0=>{r.triggerRelease(M0),c(O0=>{const j0=new Set(O0);return j0.delete(M0),j0})}))},[_0,T0]=C0.useState(new Set);C0.useEffect(()=>{const J={1:"I",2:"ii",3:"iii",4:"IV",5:"V",6:"vi",7:"vii°"},n0=j0=>{const V0=j0.key;if(V0==="Escape"){j0.preventDefault(),F0();return}if(J[V0]&&!_0.has(V0)){j0.preventDefault();const m=J[V0];T0(f=>new Set([...f,V0])),A0(m)}},M0=j0=>{const V0=j0.key;if(J[V0]&&_0.has(V0)){j0.preventDefault();const m=J[V0];console.log("Key up:",V0,"chord:",m,"active chords:",Array.from(Q)),T0(f=>{const p=new Set(f);return p.delete(V0),p}),d0(m)}},O0=()=>{console.log("Window lost focus - stopping all notes"),F0()};return window.addEventListener("keydown",n0),window.addEventListener("keyup",M0),window.addEventListener("blur",O0),()=>{window.removeEventListener("keydown",n0),window.removeEventListener("keyup",M0),window.removeEventListener("blur",O0)}},[r,y,G,Q,_0]);const F0=()=>{if(r&&y)try{console.log("Emergency stop - releasing all notes"),r.releaseAll(),U(new Set),c(new Set),T0(new Set),console.log("All notes stopped")}catch(J){console.error("Error stopping notes:",J)}},p0=()=>{o&&(j?(o.stop(),X1.stop()):(X1.bpm.value=H,o.start(),X1.start()),S(!j))},I0=async()=>{try{v1.state!=="running"&&await C1();const J=v1,n0=4096,M0=J.createScriptProcessor(n0,2,2),O0=[],j0=[];M0.onaudioprocess=V0=>{const m=V0.inputBuffer.getChannelData(0),f=V0.inputBuffer.getChannelData(1);O0.push(new Float32Array(m)),j0.push(new Float32Array(f))},r.connect(M0),M0.connect(J.destination),c0({recorder:M0,leftChannel:O0,rightChannel:j0}),C(!0),N(0),l(null),console.log("Recording started - Professional MP3 unlimited length")}catch(J){console.error("Failed to start recording:",J)}},N0=async()=>{if(!(!l0||!i))try{console.log("Stopping recording...");const{recorder:J,leftChannel:n0,rightChannel:M0}=l0;r.disconnect(J),J.disconnect();const O0=n0[0].length*n0.length,j0=v1.sampleRate,V0=De(n0,M0,j0);l(V0),C(!1),console.log("Recording stopped - Professional MP3 created:",V0.size,"bytes")}catch(J){console.error("Failed to stop recording:",J),C(!1)}},D0=()=>{if(!t)return;console.log("Exporting WAV file...");const J=URL.createObjectURL(t),n0=document.createElement("a");n0.href=J,n0.download=`chordmaster-masterpiece-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.wav`,document.body.appendChild(n0),n0.click(),document.body.removeChild(n0),URL.revokeObjectURL(J),console.log("WAV export complete")},W0=async()=>{if(t)try{console.log("Exporting MP3 file...");const J=URL.createObjectURL(t),n0=document.createElement("a");n0.href=J,n0.download=`chordmaster-masterpiece-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.mp3`,document.body.appendChild(n0),n0.click(),document.body.removeChild(n0),URL.revokeObjectURL(J),console.log("MP3 export complete")}catch(J){console.error("Failed to export MP3:",J),D0()}},De=(J,n0,M0)=>{J[0].length*J.length;const O0=new Ra.Mp3Encoder(2,M0,128),j0=[];for(let f=0;f<J.length;f++){const p=J[f],w=n0[f],V=new Int16Array(p.length),A=new Int16Array(w.length);for(let F=0;F<p.length;F++)V[F]=Math.max(-32768,Math.min(32767,p[F]*32768)),A[F]=Math.max(-32768,Math.min(32767,w[F]*32768));const L=O0.encodeBuffer(V,A);L.length>0&&j0.push(L)}const V0=O0.flush();return V0.length>0&&j0.push(V0),new Blob(j0,{type:"audio/mp3"})};C0.useEffect(()=>{let J=null;return i?J=setInterval(()=>{N(n0=>n0+1)},1e3):clearInterval(J),()=>clearInterval(J)},[i]);const le=J=>{const n0=o0[J];!n0||!r||(r.set({oscillator:{type:n0.waveform,detune:n0.detune||0},envelope:n0.adsr,volume:n0.volume||0}),R({attack:n0.adsr.attack,decay:n0.adsr.decay,sustain:n0.adsr.sustain,release:n0.adsr.release,volume:n0.volume||0,detune:n0.detune||0,filterCutoff:n0.filterCutoff||3e3,filterResonance:.5,oscillatorType:n0.waveform}),Z(J),console.log(`Switched to ${n0.name} instrument`))},se=()=>{!r||!y||(r.set({oscillator:{type:K.oscillatorType,detune:K.detune},envelope:{attack:K.attack,decay:K.decay,sustain:K.sustain,release:K.release},volume:K.volume}),r.effectsChain&&r.effectsChain.filter&&r.effectsChain.filter.set({frequency:K.filterCutoff,Q:K.filterResonance,type:"lowpass"}))},ke=()=>{if(!r||!r.effectsChain)return;const{sidechain:J,sidechainLFO:n0}=r.effectsChain;J.set({threshold:x.threshold,ratio:x.ratio,attack:x.attack,release:x.release});let M0;switch(x.speed){case"whole":M0=H/60/1;break;case"half":M0=H/60/2;break;case"quarter":M0=H/60/4;break;case"eighth":M0=H/60/8;break;case"sixteenth":M0=H/60/16;break;default:M0=H/60/4}n0.set({frequency:M0,min:.2,max:1})},a1=()=>{if(!r||!r.effectsChain)return;const{eq:J}=r.effectsChain;J.set({low:d.low,mid:d.mid,high:d.high})};C0.useEffect(()=>{b.sidechain?(ke(),r&&r.effectsChain&&r.effectsChain.sidechainLFO.start()):r&&r.effectsChain&&r.effectsChain.sidechainLFO.stop()},[x,b.sidechain,H]),C0.useEffect(()=>{b.eq&&a1()},[d,b.eq]),C0.useEffect(()=>{r&&y&&se()},[K,r,y]);const We=J=>{r&&y&&Q.size>0&&r.releaseAll(),P(J),U(new Set),c(new Set),T0(new Set)};C0.useEffect(()=>()=>{r&&y&&r.releaseAll()},[r,y]);const re=async()=>{v1.state!=="running"&&(await C1(),console.log("Audio context started by user interaction"))},t1=async()=>{v1.state!=="running"&&await C1(),new _a(440,"sine").toDestination().start().stop("+0.5"),console.log("Test audio played")};return I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white",onClick:re,children:[I.jsx("header",{className:"bg-gradient-to-r from-purple-800 to-blue-800 border-b border-purple-600 p-6",children:I.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsx("div",{className:"text-4xl",children:"🎵"}),I.jsxs("div",{children:[I.jsx("h1",{className:"text-3xl font-bold text-white",children:"ChordMaster"}),I.jsx("div",{className:"text-sm text-purple-200",children:"Smart Chord Synthesizer"})]})]}),I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"flex items-center space-x-3 bg-white/10 rounded-full px-4 py-2",children:[I.jsx("div",{className:`w-3 h-3 rounded-full ${y?"bg-green-400 animate-pulse":"bg-red-400"}`}),I.jsx("span",{className:"text-sm font-medium",children:y?"System Ready":"Initializing..."})]}),y&&I.jsxs("div",{className:"flex gap-2",children:[I.jsx("button",{onClick:F0,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg",children:"🛑 Stop All"}),I.jsx("button",{onClick:t1,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg",children:"🔊 Test Audio"})]})]})]})}),I.jsx("div",{className:"max-w-7xl mx-auto p-8",children:I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[I.jsxs("div",{className:"space-y-8",children:[I.jsxs("div",{className:"bg-gradient-to-br from-purple-800/30 to-blue-800/30 backdrop-blur-sm rounded-2xl p-6 border border-purple-500/30 shadow-2xl",children:[I.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[I.jsx("span",{className:"text-2xl mr-3",children:"🎹"}),"Sound Palette"]}),I.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(o0).map(([J,n0])=>I.jsx("button",{onClick:()=>le(J),className:`p-4 rounded-xl border-2 transition-all duration-300 transform hover:scale-105 ${a0===J?"border-purple-400 bg-purple-400/20 text-purple-300 shadow-lg shadow-purple-500/25":"border-purple-600/50 bg-purple-900/20 hover:border-purple-500 hover:bg-purple-800/30"}`,children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-2xl mb-2",children:n0.icon}),I.jsx("div",{className:"text-sm font-semibold",children:n0.name})]})},J))})]}),I.jsxs("div",{className:"bg-gradient-to-br from-indigo-800/30 to-purple-800/30 backdrop-blur-sm rounded-2xl p-6 border border-indigo-500/30 shadow-2xl",children:[I.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[I.jsx("span",{className:"text-2xl mr-3",children:"🎛️"}),"Instrument Controls"]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"space-y-4",children:[I.jsx("h3",{className:"text-indigo-200 font-semibold",children:"ADSR Envelope"}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-xs text-indigo-300",children:[I.jsx("span",{children:"Attack"}),I.jsxs("span",{children:[K.attack.toFixed(2),"s"]})]}),I.jsx("input",{type:"range",min:"0.001",max:"2",step:"0.01",value:K.attack,onChange:J=>R(n0=>({...n0,attack:parseFloat(J.target.value)})),className:"w-full h-1 bg-indigo-900/50 rounded-lg appearance-none cursor-pointer"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-xs text-indigo-300",children:[I.jsx("span",{children:"Decay"}),I.jsxs("span",{children:[K.decay.toFixed(2),"s"]})]}),I.jsx("input",{type:"range",min:"0.01",max:"2",step:"0.01",value:K.decay,onChange:J=>R(n0=>({...n0,decay:parseFloat(J.target.value)})),className:"w-full h-1 bg-indigo-900/50 rounded-lg appearance-none cursor-pointer"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-xs text-indigo-300",children:[I.jsx("span",{children:"Sustain"}),I.jsx("span",{children:K.sustain.toFixed(2)})]}),I.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:K.sustain,onChange:J=>R(n0=>({...n0,sustain:parseFloat(J.target.value)})),className:"w-full h-1 bg-indigo-900/50 rounded-lg appearance-none cursor-pointer"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-xs text-indigo-300",children:[I.jsx("span",{children:"Release"}),I.jsxs("span",{children:[K.release.toFixed(2),"s"]})]}),I.jsx("input",{type:"range",min:"0.01",max:"5",step:"0.01",value:K.release,onChange:J=>R(n0=>({...n0,release:parseFloat(J.target.value)})),className:"w-full h-1 bg-indigo-900/50 rounded-lg appearance-none cursor-pointer"})]})]})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsx("h3",{className:"text-indigo-200 font-semibold",children:"Oscillator"}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{className:"space-y-2",children:[I.jsx("div",{className:"text-xs text-indigo-300",children:"Waveform"}),I.jsxs("select",{value:K.oscillatorType,onChange:J=>R(n0=>({...n0,oscillatorType:J.target.value})),className:"w-full p-2 rounded-lg bg-indigo-900/30 text-indigo-300 border border-indigo-600/50",children:[I.jsx("option",{value:"sine",children:"Sine"}),I.jsx("option",{value:"triangle",children:"Triangle"}),I.jsx("option",{value:"sawtooth",children:"Sawtooth"}),I.jsx("option",{value:"square",children:"Square"}),I.jsx("option",{value:"fatsawtooth",children:"Fat Sawtooth"})]})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-xs text-indigo-300",children:[I.jsx("span",{children:"Detune"}),I.jsxs("span",{children:[K.detune,"¢"]})]}),I.jsx("input",{type:"range",min:"-100",max:"100",value:K.detune,onChange:J=>R(n0=>({...n0,detune:parseInt(J.target.value)})),className:"w-full h-1 bg-indigo-900/50 rounded-lg appearance-none cursor-pointer"})]})]})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsx("h3",{className:"text-indigo-200 font-semibold",children:"Filter"}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-xs text-indigo-300",children:[I.jsx("span",{children:"Cutoff"}),I.jsxs("span",{children:[K.filterCutoff,"Hz"]})]}),I.jsx("input",{type:"range",min:"100",max:"8000",value:K.filterCutoff,onChange:J=>R(n0=>({...n0,filterCutoff:parseInt(J.target.value)})),className:"w-full h-1 bg-indigo-900/50 rounded-lg appearance-none cursor-pointer"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-xs text-indigo-300",children:[I.jsx("span",{children:"Resonance"}),I.jsx("span",{children:K.filterResonance.toFixed(1)})]}),I.jsx("input",{type:"range",min:"0",max:"10",step:"0.1",value:K.filterResonance,onChange:J=>R(n0=>({...n0,filterResonance:parseFloat(J.target.value)})),className:"w-full h-1 bg-indigo-900/50 rounded-lg appearance-none cursor-pointer"})]})]})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-xs text-indigo-300",children:[I.jsx("span",{children:"Volume"}),I.jsxs("span",{children:[K.volume,"dB"]})]}),I.jsx("input",{type:"range",min:"-30",max:"0",value:K.volume,onChange:J=>R(n0=>({...n0,volume:parseInt(J.target.value)})),className:"w-full h-1 bg-indigo-900/50 rounded-lg appearance-none cursor-pointer"})]})]})]}),I.jsxs("div",{className:"bg-gradient-to-br from-blue-800/30 to-indigo-800/30 backdrop-blur-sm rounded-2xl p-6 border border-blue-500/30 shadow-2xl",children:[I.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[I.jsx("span",{className:"text-2xl mr-3",children:"🎼"}),"Musical Key"]}),I.jsx("div",{className:"grid grid-cols-3 gap-3",children:["C","G","D","A","E","F"].map(J=>I.jsx("button",{onClick:()=>We(J),className:`p-4 rounded-xl border-2 font-mono text-xl font-bold transition-all duration-300 transform hover:scale-105 ${G===J?"border-blue-400 bg-blue-400/20 text-blue-300 shadow-lg shadow-blue-500/25":"border-blue-600/50 bg-blue-900/20 hover:border-blue-500 hover:bg-blue-800/30"}`,children:J},J))})]}),I.jsxs("div",{className:"bg-gradient-to-br from-green-800/30 to-emerald-800/30 backdrop-blur-sm rounded-2xl p-6 border border-green-500/30 shadow-2xl",children:[I.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[I.jsx("span",{className:"text-2xl mr-3",children:"⏱️"}),"Rhythm Engine"]}),I.jsxs("div",{className:"mb-6",children:[I.jsx("div",{className:"flex justify-center space-x-2 mb-4",children:[1,2,3,4].map(J=>I.jsx("div",{className:`w-8 h-8 rounded-full border-2 transition-all duration-200 ${j&&_===J-1?"bg-green-400 border-green-300 scale-125":J===1?"border-green-400 bg-green-400/20":"border-green-600 bg-green-900/20"}`,children:I.jsx("div",{className:"flex items-center justify-center h-full text-xs font-bold",children:J===1?"●":"○"})},J))}),j&&I.jsxs("div",{className:"text-center text-green-300 font-mono text-lg",children:["Beat ",_+1," of ",Y]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsx("button",{onClick:p0,className:`w-full p-4 rounded-xl border-2 font-semibold text-lg transition-all duration-300 transform hover:scale-105 ${j?"border-green-400 bg-green-400/20 text-green-300 shadow-lg shadow-green-500/25":"border-green-600/50 bg-green-900/20 hover:border-green-500 hover:bg-green-800/30"}`,children:j?"⏸️ Stop Beat":"▶️ Start Beat"}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"space-y-3",children:[I.jsxs("label",{className:"text-sm text-green-200 font-medium",children:["Tempo: ",H," BPM"]}),I.jsx("input",{type:"range",min:"60",max:"200",value:H,onChange:J=>X(parseInt(J.target.value)),className:"w-full h-2 bg-green-900/50 rounded-lg appearance-none cursor-pointer slider"}),I.jsxs("div",{className:"flex justify-between text-xs text-green-300",children:[I.jsx("span",{children:"60"}),I.jsx("span",{children:"200"})]})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("label",{className:"text-sm text-green-200 font-medium",children:"Time Signature"}),I.jsx("div",{className:"grid grid-cols-2 gap-2",children:["4/4","3/4","2/4","6/8"].map(J=>I.jsx("button",{onClick:()=>D(J),className:`p-2 rounded-lg border text-sm transition-all ${Y===J?"border-green-400 bg-green-400/20 text-green-300":"border-green-600/50 bg-green-900/20 hover:border-green-500"}`,children:J},J))})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-green-200",children:"Accent Beat 1"}),I.jsx("button",{onClick:()=>T(!q),className:`w-12 h-6 rounded-full transition-all ${q?"bg-green-400":"bg-gray-600"}`,children:I.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${q?"translate-x-6":"translate-x-1"}`})})]})]})]})]})]}),I.jsx("div",{className:"lg:col-span-2",children:I.jsxs("div",{className:"bg-gradient-to-br from-indigo-800/30 to-purple-800/30 backdrop-blur-sm rounded-2xl p-8 border border-indigo-500/30 shadow-2xl",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsxs("h2",{className:"text-3xl font-bold text-white mb-3 flex items-center justify-center",children:[I.jsx("span",{className:"text-4xl mr-4",children:"🎵"}),"Chord Matrix"]}),I.jsxs("p",{className:"text-indigo-200 text-lg",children:["Key of ",I.jsx("span",{className:"font-mono text-indigo-300 text-xl font-bold",children:G})]}),I.jsx("p",{className:"text-indigo-300/70 text-sm mt-2",children:"Press number keys 1-7 or click buttons • Hold multiple keys for polyphonic chords • ESC to stop all"})]}),I.jsx("div",{className:"grid grid-cols-4 gap-6",children:[{number:"I",label:"1",description:"Tonic",color:"from-red-500 to-pink-500"},{number:"ii",label:"2",description:"Supertonic",color:"from-orange-500 to-red-500"},{number:"iii",label:"3",description:"Mediant",color:"from-yellow-500 to-orange-500"},{number:"IV",label:"4",description:"Subdominant",color:"from-green-500 to-yellow-500"},{number:"V",label:"5",description:"Dominant",color:"from-blue-500 to-green-500"},{number:"vi",label:"6",description:"Submediant",color:"from-indigo-500 to-blue-500"},{number:"vii°",label:"7",description:"Leading Tone",color:"from-purple-500 to-indigo-500"}].map(J=>{const n0=v0[G][J.number],M0=Q.has(J.number);return I.jsx("button",{onMouseDown:()=>A0(J.number),onMouseUp:()=>d0(J.number),onMouseLeave:()=>d0(J.number),className:`p-6 rounded-2xl border-2 transition-all duration-300 transform hover:scale-105 ${M0?`border-white bg-gradient-to-br ${J.color} text-white shadow-2xl shadow-white/25`:"border-indigo-600/50 bg-indigo-900/20 hover:border-indigo-500 hover:bg-indigo-800/30"}`,children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-4xl font-bold mb-3",children:J.label}),I.jsx("div",{className:"text-lg font-mono font-semibold",children:n0.name}),I.jsx("div",{className:"text-sm text-indigo-200 mt-1",children:J.description})]})},J.number)})})]})}),I.jsxs("div",{className:"space-y-8",children:[I.jsxs("div",{className:"bg-gradient-to-br from-gray-900/50 to-black/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-600/30 shadow-2xl",children:[I.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[I.jsx("span",{className:"text-2xl mr-3",children:"📺"}),"Smart Display"]}),I.jsxs("div",{className:"bg-black rounded-xl p-6 font-mono text-sm border border-gray-700",children:[I.jsx("div",{className:"text-green-400 mb-3 text-lg font-bold",children:"ChordMaster v2.0"}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"text-blue-400",children:["Key: ",I.jsx("span",{className:"text-white",children:G})]}),I.jsxs("div",{className:"text-purple-400",children:["Sound: ",I.jsx("span",{className:"text-white",children:o0[a0].name})]}),Q.size>0&&I.jsxs("div",{className:"text-yellow-400",children:["Chords: ",I.jsx("span",{className:"text-white",children:Array.from(Q).map(J=>v0[G][J].name).join(", ")})]}),j&&I.jsxs("div",{className:"text-red-400",children:["Beat: ",I.jsxs("span",{className:"text-white",children:[H," BPM"]})]}),i&&I.jsxs("div",{className:"text-orange-400",children:["Recording: ",I.jsxs("span",{className:"text-white",children:[Math.floor(B/60),":",(B%60).toString().padStart(2,"0")]})]}),I.jsxs("div",{className:"text-gray-400 mt-3 text-xs",children:["Active Notes: ",a.size]})]})]})]}),I.jsxs("div",{className:"bg-gradient-to-br from-pink-800/30 to-rose-800/30 backdrop-blur-sm rounded-2xl p-6 border border-pink-500/30 shadow-2xl",children:[I.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[I.jsx("span",{className:"text-2xl mr-3",children:"✨"}),"Sound Effects"]}),I.jsx("div",{className:"space-y-4 mb-6",children:Object.entries(b).map(([J,n0])=>I.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-xl",children:[I.jsx("span",{className:"text-sm capitalize text-pink-200 font-medium",children:J}),I.jsx("button",{onClick:()=>e(M0=>({...M0,[J]:!n0})),className:`w-14 h-7 rounded-full transition-all duration-300 ${n0?"bg-pink-400":"bg-gray-600"}`,children:I.jsx("div",{className:`w-6 h-6 bg-white rounded-full transition-transform duration-300 ${n0?"translate-x-7":"translate-x-1"}`})})]},J))}),b.eq&&I.jsxs("div",{className:"mb-6 p-4 bg-white/5 rounded-xl",children:[I.jsx("h3",{className:"text-pink-200 font-semibold mb-3",children:"EQ"}),I.jsx("div",{className:"space-y-3",children:Object.entries(d).map(([J,n0])=>I.jsxs("div",{className:"space-y-1",children:[I.jsxs("div",{className:"flex justify-between text-xs text-pink-300",children:[I.jsx("span",{children:J}),I.jsxs("span",{children:[n0,"dB"]})]}),I.jsx("input",{type:"range",min:"-12",max:"12",value:n0,onChange:M0=>u(O0=>({...O0,[J]:parseInt(M0.target.value)})),className:"w-full h-1 bg-pink-900/50 rounded-lg appearance-none cursor-pointer"})]},J))})]}),b.sidechain&&I.jsxs("div",{className:"p-4 bg-white/5 rounded-xl",children:[I.jsx("h3",{className:"text-pink-200 font-semibold mb-3",children:"Sidechain"}),I.jsxs("div",{className:"space-y-3",children:[I.jsxs("div",{className:"space-y-1",children:[I.jsxs("div",{className:"flex justify-between text-xs text-pink-300",children:[I.jsx("span",{children:"Threshold"}),I.jsxs("span",{children:[x.threshold,"dB"]})]}),I.jsx("input",{type:"range",min:"-40",max:"0",value:x.threshold,onChange:J=>v(n0=>({...n0,threshold:parseInt(J.target.value)})),className:"w-full h-1 bg-pink-900/50 rounded-lg appearance-none cursor-pointer"})]}),I.jsxs("div",{className:"space-y-1",children:[I.jsxs("div",{className:"flex justify-between text-xs text-pink-300",children:[I.jsx("span",{children:"Ratio"}),I.jsxs("span",{children:[x.ratio,":1"]})]}),I.jsx("input",{type:"range",min:"1",max:"20",value:x.ratio,onChange:J=>v(n0=>({...n0,ratio:parseInt(J.target.value)})),className:"w-full h-1 bg-pink-900/50 rounded-lg appearance-none cursor-pointer"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("div",{className:"text-xs text-pink-300",children:"Speed"}),I.jsx("div",{className:"grid grid-cols-5 gap-1",children:[{value:"whole",label:"♩",name:"Whole"},{value:"half",label:"♪",name:"Half"},{value:"quarter",label:"♫",name:"Quarter"},{value:"eighth",label:"♬",name:"Eighth"},{value:"sixteenth",label:"♭",name:"16th"}].map(J=>I.jsxs("button",{onClick:()=>v(n0=>({...n0,speed:J.value})),className:`p-2 rounded-lg text-xs transition-all duration-300 ${x.speed===J.value?"bg-pink-500 text-white shadow-lg":"bg-pink-900/30 text-pink-300 hover:bg-pink-800/50"}`,title:J.name,children:[I.jsx("div",{className:"text-lg",children:J.label}),I.jsx("div",{className:"text-xs",children:J.name})]},J.value))})]})]})]})]}),I.jsxs("div",{className:"bg-gradient-to-br from-orange-800/30 to-red-800/30 backdrop-blur-sm rounded-2xl p-6 border border-orange-500/30 shadow-2xl",children:[I.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center",children:[I.jsx("span",{className:"text-2xl mr-3",children:"🎙️"}),"Recording Studio"]}),I.jsxs("div",{className:"space-y-4",children:[I.jsx("div",{className:"text-center",children:i?I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[I.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),I.jsx("span",{className:"text-red-400 font-semibold",children:"RECORDING"})]}),I.jsxs("div",{className:"text-orange-200 font-mono text-lg",children:[Math.floor(B/60),":",(B%60).toString().padStart(2,"0")]})]}):I.jsx("div",{className:"text-orange-200",children:"Ready to Record"})}),I.jsx("div",{className:"space-y-3",children:i?I.jsx("button",{onClick:N0,className:"w-full p-3 rounded-xl border-2 border-orange-500 bg-orange-500/20 text-orange-300 hover:bg-orange-500/30 transition-all duration-300 transform hover:scale-105",children:"⏹️ Stop Recording"}):I.jsx("button",{onClick:I0,className:"w-full p-3 rounded-xl border-2 border-red-500 bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-all duration-300 transform hover:scale-105",children:"🔴 Start Recording"})}),t&&I.jsxs("div",{className:"space-y-2",children:[I.jsx("div",{className:"text-orange-200 text-sm text-center mb-3",children:"🎵 Masterpiece Complete! 🎵"}),I.jsxs("div",{className:"text-orange-300 text-xs text-center mb-3",children:["File size: ",(t.size/1024/1024).toFixed(2)," MB"]}),I.jsx("div",{className:"text-orange-200 text-sm text-center mb-3",children:"Export your masterpiece as:"}),I.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[I.jsx("button",{onClick:D0,className:"p-2 rounded-lg border border-orange-600/50 bg-orange-900/20 hover:bg-orange-800/30 text-orange-200 text-sm transition-all duration-300",children:"📁 MP3 (Professional)"}),I.jsx("button",{onClick:W0,className:"p-2 rounded-lg border border-orange-600/50 bg-orange-900/20 hover:bg-orange-800/30 text-orange-200 text-sm transition-all duration-300",children:"🎵 MP3 (Compressed)"})]})]})]})]})]})]})})]})};function Xs(){return I.jsx(Hs,{})}Ma.createRoot(document.getElementById("root")).render(I.jsx(Bt.StrictMode,{children:I.jsx(Xs,{})}));
